import{b as se,c as ae}from"./chunk-GS7Z4KHG.js";import{a as ue,b as pe}from"./chunk-CPOYLKXI.js";import{j as oe,m as le,n as re}from"./chunk-2OAYZYPU.js";import{$a as z,Aa as a,Ab as q,C as k,Cb as Q,Fa as y,Ga as _,Ha as r,J as j,Jc as Z,Kc as $,Lc as ee,M as D,Mc as te,N as w,Na as F,O as W,Oa as A,Pa as H,Ra as u,U as N,V as d,Va as g,W as c,Wa as h,Xa as f,Za as B,_ as M,_a as v,bd as ie,cd as ne,ec as R,g as ce,ha as m,hc as S,i as I,ic as E,kc as U,l as P,oa as V,oc as G,ra as b,sc as J,ta as p,ub as L,va as O,wa as T,wb as Y,wc as K,yc as X,za as s}from"./chunk-TB3GCOGJ.js";var me=(()=>{let l=class l{constructor(n,e,o){this.http=n,this.api=e,this.notification=o,this.host=this.api.host,this.expensesAccounts=V([]),this.loading_table=V(!1),this.status_action$=new P({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(this.host+"/expense/accounts").subscribe({next:n=>{this.expensesAccounts.set(n)},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(n){this.loading_table.set(!0),this.http.post(this.host+"/expense",n).subscribe({next:e=>{this.notification.showSuccess("Payment added successfully","home"),this.status_action$.next({action:"ADD"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(n){this.loading_table.set(!0),this.http.put(this.host+"/expense",n).subscribe({next:e=>{this.notification.showSuccess(),this.status_action$.next({action:"UPDATE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(n){this.loading_table.set(!0),this.http.delete(this.host+"/expense/"+n).subscribe({next:e=>{this.notification.showSuccess("Payment deleted successfully","home"),this.status_action$.next({action:"DELETE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}};l.\u0275fac=function(e){return new(e||l)(D(Q),D(E),D(S))},l.\u0275prov=j({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var de=ce(ue());var ge=["amountInput"],he=()=>({width:"75vw"}),fe=()=>({"1199px":"85vw","575px":"95vw"}),xe=()=>({width:"35vw"}),be=i=>({"ng-invalid ng-dirty":i});function ye(i,l){i&1&&(s(0,"small",17),u(1,"Date is required."),a())}function Ce(i,l){i&1&&(s(0,"small",17),u(1,"Ammount is required."),a())}function we(i,l){if(i&1){let t=y();s(0,"div",6)(1,"div",7)(2,"label",8),u(3,"Update Reason"),s(4,"span",9),u(5," *"),a()(),s(6,"input",10),f("ngModelChange",function(e){d(t);let o=r(2);return h(o.update_reason,e)||(o.update_reason=e),c(e)}),a()()()}if(i&2){let t=r(2);m(6),O("invalid",!t.update_reason),g("ngModel",t.update_reason)}}function De(i,l){if(i&1){let t=y();s(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),u(4,"Description"),s(5,"span",9),u(6," *"),a()(),s(7,"input",10),f("ngModelChange",function(e){d(t);let o=r();return h(o.journal_description,e)||(o.journal_description=e),c(e)}),a()()(),s(8,"div",6)(9,"label",11),u(10,"Payment Date"),s(11,"span",9),u(12," *"),a()(),s(13,"p-calendar",12),f("ngModelChange",function(e){d(t);let o=r();return h(o.payment_date,e)||(o.payment_date=e),c(e)}),a(),b(14,ye,2,0,"small",13),a(),s(15,"div",6)(16,"div",7)(17,"label",14),u(18,"Amount"),s(19,"span",9),u(20," *"),a()(),s(21,"p-inputNumber",15,0),f("ngModelChange",function(e){d(t);let o=r();return h(o.amount,e)||(o.amount=e),c(e)}),_("onFocus",function(e){d(t);let o=r();return c(o.selectInput(e))}),a(),b(23,Ce,2,0,"small",13),a()(),b(24,we,7,3,"div",16),a()}if(i&2){let t=r();m(7),g("ngModel",t.journal_description),m(6),g("ngModel",t.payment_date),p("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),m(),p("ngIf",t.submitted&&!t.payment_date),m(7),g("ngModel",t.amount),p("required",!0)("ngClass",z(12,be,t.submitted&&!t.amount)),m(2),p("ngIf",t.submitted&&!t.amount),m(),p("ngIf",t.dialog_mode==="edit")}}function ve(i,l){if(i&1){let t=y();s(0,"p-button",21),_("onClick",function(){d(t);let e=r(2);return c(e.deleteDialogVisible=!0)}),a()}if(i&2){let t=r(2);p("disabled",t.loading())}}function Se(i,l){if(i&1){let t=y();b(0,ve,1,1,"p-button",18),s(1,"p-button",19),_("onClick",function(){d(t);let e=r();return c(e.closeDialog())}),a(),s(2,"p-button",20),_("onClick",function(){d(t);let e=r();return c(e.submitPayment())}),a()}if(i&2){let t=r();p("ngIf",t.dialog_mode==="edit"),m(),p("disabled",t.loading()),m(),p("loading",t.loading())("disabled",t.dialog_mode==="edit"&&!t.update_reason)}}function Ee(i,l){if(i&1){let t=y();s(0,"div",5)(1,"div",22)(2,"label",23),u(3,"Delete Reason"),a(),s(4,"input",24),f("ngModelChange",function(e){d(t);let o=r();return h(o.deleteNote,e)||(o.deleteNote=e),c(e)}),a()()()}if(i&2){let t=r();m(4),g("ngModel",t.deleteNote)}}function Me(i,l){if(i&1){let t=y();s(0,"p-button",25),_("onClick",function(){d(t);let e=r();return c(e.deleteDialogVisible=!1)}),a(),s(1,"p-button",26),_("onClick",function(){d(t);let e=r();return c(e.confirmDelete())}),a()}if(i&2){let t=r();m(),p("disabled",!t.deleteNote)("loading",t.loadingSubmitDelete)}}var lt=(()=>{let l=class l{constructor(){this.visible=!1,this.dialog_mode="add",this.OnClose=new M,this.OnSubmit=new M,this.api=w(E),this.notification=w(S),this.expensesService=w(me),this.dateService=w(pe),this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.submitted=!1,this.update_reason=null,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null,this.subscriptions=new I,this.deleteDialogVisible=!1,this.loadingSubmitDelete=!1,this.deleteNote=null}initDialog(){this.submitted=!1,this.amount=null,this.journal_description=null,this.update_reason=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(n=>{n.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"YYYY-MM-DD HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=(0,de.default)(this.payment_date).format("YYYY-MM-DD HH:mm:ss"),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id,update_reason:this.update_reason}))}selectInput(n){n.target.select()}hideDeleteDialog(){this.deleteNote=null,this.deleteDialogVisible=!1}confirmDelete(){this.deleteNote&&(this.loadingSubmitDelete=!0,this.api.delete(`expense/${this.selected_payment.journal_id}?message=${this.deleteNote}`).pipe(k(()=>{this.loadingSubmitDelete=!1})).subscribe({next:n=>{this.deleteDialogVisible=!1,this.visible=!1,this.notification.showSuccess(),this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({})}}))}deletePayment(){}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=W({type:l,selectors:[["expenses-dialog"]],viewQuery:function(e,o){if(e&1&&F(ge,5),e&2){let C;A(C=H())&&(o.amountInput=C.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[N,B],decls:6,vars:16,consts:[["amountInput",""],["position","top","header","Submit Expense","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm","position","center",3,"visibleChange","onHide","visible","modal","closable"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],[1,"flex","flex-column","gap-2"],["for","Type"],[1,"text-red-500"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModelChange","ngModel"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["class","p-error",4,"ngIf"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","ngClass"],["class","field col-12 md:col-4",4,"ngIf"],[1,"p-error"],["size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","disabled"],["size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading","disabled"],["size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","disabled"],[1,"field","col-12"],["for","note"],["type","text","id","note","name","note","required","","pInputText","","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngModelChange","ngModel"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Proceed","icon","pi pi-check","severity","danger","size","small",3,"onClick","disabled","loading"]],template:function(e,o){e&1&&(s(0,"p-dialog",1),f("visibleChange",function(x){return h(o.visible,x)||(o.visible=x),x}),_("onHide",function(){return o.closeDialog()}),b(1,De,25,14,"ng-template",2)(2,Se,3,4,"ng-template",3),a(),s(3,"p-dialog",4),f("visibleChange",function(x){return h(o.deleteDialogVisible,x)||(o.deleteDialogVisible=x),x}),_("onHide",function(){return o.hideDeleteDialog()}),b(4,Ee,5,1,"ng-template",2)(5,Me,2,2,"ng-template",3),a()),e&2&&(T(v(13,he)),p("modal",!0),g("visible",o.visible),p("breakpoints",v(14,fe))("closeOnEscape",!1)("closable",!0)("maximizable",!0),m(3),T(v(15,xe)),g("visible",o.deleteDialogVisible),p("modal",!0)("closable",!0))},dependencies:[ne,ie,R,$,Z,oe,re,le,ae,se,X,U,G,K,J,q,L,Y,te,ee],styles:[".invalid[_ngcontent-%COMP%]{border-color:var(--red-500)!important}"]});let i=l;return i})();export{lt as a};
