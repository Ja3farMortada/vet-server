import{a as at}from"./chunk-24ZDMTLO.js";import{b as _t}from"./chunk-QOW6RSZU.js";import{a as it,b as wt,c as Et,d as pe}from"./chunk-VNAT6VYV.js";import{a as rt,c as It}from"./chunk-5V7CXYWC.js";import{a as Ee}from"./chunk-U2ZI52BY.js";import{a as nt,b as Tt,d as we}from"./chunk-MJWYV7CD.js";import{b as Dt,d as Pt}from"./chunk-3QQ3RE45.js";import{a as Te}from"./chunk-JW7BJOOA.js";import{a as ot}from"./chunk-E6DUUYUZ.js";import{a as Xe}from"./chunk-C34M2Y2L.js";import{a as ce}from"./chunk-HBV3JCH5.js";import{a as Ze}from"./chunk-MOWOAXAE.js";import{a as ne,b as tt}from"./chunk-JLRN67G7.js";import{c as ie}from"./chunk-XUPVQC5T.js";import"./chunk-MZ2S7L7H.js";import{a as xt,b as et}from"./chunk-LQ62Q6FC.js";import{b as Ge,c as Ct,f as W,j as bt,k as Qe,l as Ue,q as Je}from"./chunk-GS7Z4KHG.js";import{b as St}from"./chunk-WXPCUA65.js";import"./chunk-GS2HDMHU.js";import{a as Pe,b as se}from"./chunk-CPOYLKXI.js";import"./chunk-BWBVWMZW.js";import{a as N,b as Ae}from"./chunk-ASN6MEGG.js";import{i as z,j as je,m as R,n as Ke}from"./chunk-2OAYZYPU.js";import{$a as ae,Aa as o,Ab as Re,Ba as C,C as Me,Cb as le,Fa as w,Ga as d,Ha as c,Ic as j,J as re,Jc as O,K as Fe,Ka as Ne,Kc as $e,Lc as G,Mc as Ye,N as g,O as H,P as ke,Ra as p,Rb as dt,Sa as f,Ta as S,U as Be,V as u,Va as E,W as h,Wa as T,Xa as I,Xb as We,Za as ht,_ as Ce,_a as D,a as ct,ab as be,b as mt,bb as gt,bd as te,cd as yt,ec as k,g as De,ha as s,hb as b,hc as A,i as K,ib as x,ic as $,kc as Y,l as ye,oa as P,oc as B,pc as U,qc as J,ra as y,rc as V,sb as ft,sc as Se,ta as m,tc as X,ub as xe,uc as Z,va as ut,vb as Oe,vc as ee,wa as L,wb as Q,wc as Le,xc as ze,yc as qe,za as n,zb as F,zc as vt}from"./chunk-TB3GCOGJ.js";var oe=(()=>{let l=class l{constructor(){this.http=g(le),this.apiService=g($),this.notificationService=g(A),this.salesHistory=P([]),this.deletedHistory=P([]),this.paymentsHistory=P([]),this.signal_loading=P(!1),this.moneyTransfersHistory=P([]),this.returnHistory=P([]),this.receiptsHistory=P([]),this.purchasesHistory=P([])}fetchSalesHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/sales/search`,r).subscribe({next:e=>{this.salesHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchDeletedHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/deleted/search`,r).subscribe({next:e=>{this.deletedHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchPaymentHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/payment/search`,r).subscribe({next:e=>{this.paymentsHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchMoneyTransferHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/money-transfer/search`,r).subscribe({next:e=>{this.moneyTransfersHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchReturnHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/return/search`,r).subscribe({next:e=>{this.returnHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchPurchasesHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/purchase/search`,r).subscribe({next:e=>{this.purchasesHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}fetchReceiptsHistory(r){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/receipt/search`,r).subscribe({next:e=>{this.receiptsHistory.set(e),this.signal_loading.set(!1)},error:e=>{this.signal_loading.set(!1),this.notificationService.handleError(e.error,"home")}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var kt=De(Pe());var lt=(()=>{let l=class l{constructor(){this.http=g(le),this.api=g($),this.notificationService=g(A),this.whatsappLoading=P(!1)}sendMessage(r){this.whatsappLoading.set(!0),this.http.post(`${this.api.host}/send-whatsapp`,r).subscribe({next:e=>{this.notificationService.showInfo(e.message,"home",!1),this.whatsappLoading.set(!1)},error:e=>{this.whatsappLoading.set(!1),this.notificationService.showError("Error sending whatsapp!","home")}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var Vt=(()=>{let l=class l{constructor(){this.apiService=g($),this.http=g(le),this.notificationService=g(A),this.customersService=g(ie),this.host=this.apiService.host,this.currentInvoice=P({}),this.signal_submited=P(!1),this.signal_submit_loading=P(!1),this.action_status$=new ye(""),this.selectedCustomerLatestItems=new ye([])}checkout(r,e){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/sell-orders`,r).subscribe({next:a=>{this.notificationService.showSuccess("Invoice Updated","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(r.customer_id)}})}returnCheckout(r,e){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,r).subscribe({next:a=>{this.notificationService.showSuccess("Invoice Updated","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(r.customer_id)}})}deleteInvoice(r,e){let a=r.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/sell-orders/${a}`).subscribe({next:_=>{this.notificationService.showSuccess(_.message,"home")},error:_=>{this.notificationService.handleError(_.error,"home"),this.signal_submited.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(r.customer_id)}})}returnDeleteInvoice(r,e){let a=r.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${a}`).subscribe({next:_=>{this.notificationService.showSuccess(_.message,"home")},error:_=>{this.notificationService.handleError(_.error,"home"),this.signal_submited.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(r.customer_id)}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var Ht=De(Pe());var ei=()=>({width:"95vw",height:"75vh"}),ti=()=>({width:"65vw"}),ii=()=>({"1199px":"75vw","575px":"95vw"}),ni=()=>({width:"35vw"}),oi=()=>({standalone:!0}),ri=i=>({invalid:i}),ai=i=>({"text-orange-500":i}),li=i=>({selected:i});function si(i,l){i&1&&(n(0,"tr")(1,"th",31),p(2,"Barcode"),o(),n(3,"th",32),p(4,"Description"),o(),n(5,"th",33),p(6,"Unit"),o(),n(7,"th",33),p(8,"Discount"),o(),n(9,"th",34),p(10,"Qty"),o(),n(11,"th",33),p(12,"Total"),o(),n(13,"th",34),p(14,"Del?"),o()())}function pi(i,l){if(i&1){let t=w();n(0,"p-inputNumber",42),I("ngModelChange",function(e){u(t);let a=c().$implicit;return T(a.unit_price,e)||(a.unit_price=e),h(e)}),d("ngModelChange",function(){u(t);let e=c().$implicit,a=c(2);return h(a.setPrice(e))})("onFocus",function(e){u(t);let a=c(3);return h(a.select(e.target))}),o()}if(i&2){let t=c().$implicit;E("ngModel",t.unit_price),m("maxFractionDigits",2)("min",0)}}function ci(i,l){i&1&&C(0,"i",45)}function mi(i,l){if(i&1&&(n(0,"span",43),p(1),b(2,"currency"),n(3,"span"),y(4,ci,1,0,"i",44),o()()),i&2){let t=c().$implicit,r=c(2);m("ngClass",ae(5,ai,r.getPriceWarining(t))),s(),f(x(2,3,t.unit_price)),s(3),m("ngIf",r.getPriceWarining(t))}}function di(i,l){if(i&1){let t=w();n(0,"p-inputNumber",46,2),I("ngModelChange",function(e){u(t);let a=c().$implicit;return T(a.discount_percentage,e)||(a.discount_percentage=e),h(e)}),d("ngModelChange",function(){u(t);let e=c().rowIndex,a=c(2);return h(a.onDiscountChange(e))})("onFocus",function(e){u(t);let a=c(3);return h(a.select(e.target))}),o()}if(i&2){let t=c().$implicit;E("ngModel",t.discount_percentage),m("maxFractionDigits",2)("min",0)}}function _i(i,l){if(i&1&&(n(0,"span"),p(1),o()),i&2){let t=c().$implicit;s(),S("",t.discount_percentage,"%")}}function ui(i,l){if(i&1){let t=w();n(0,"p-inputNumber",47),I("ngModelChange",function(e){u(t);let a=c().$implicit;return T(a.quantity,e)||(a.quantity=e),h(e)}),d("onFocus",function(e){u(t);let a=c(3);return h(a.select(e.target))})("ngModelChange",function(){u(t);let e=c().$implicit,a=c(2);return h(a.setQty(e))}),o()}if(i&2){let t=c().$implicit;E("ngModel",t.quantity),m("maxFractionDigits",2)("minFractionDigits",0)}}function hi(i,l){if(i&1&&(n(0,"span"),p(1),o()),i&2){let t=c().$implicit;s(),f(t.quantity)}}function gi(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),C(5,"br"),n(6,"small"),p(7),o()(),n(8,"td",35)(9,"p-cellEditor"),y(10,pi,1,3,"ng-template",36)(11,mi,5,7,"ng-template",37),o()(),n(12,"td",38)(13,"p-cellEditor"),y(14,di,2,3,"ng-template",36)(15,_i,2,1,"ng-template",37),o()(),n(16,"td",39)(17,"p-cellEditor"),y(18,ui,1,3,"ng-template",36)(19,hi,2,1,"ng-template",37),o()(),n(20,"td"),p(21),b(22,"currency"),o(),n(23,"td",40),d("click",function(){let e=u(t).rowIndex,a=c(2);return h(a.removeRow(e))}),C(24,"i",41),o()()}if(i&2){let t=l.$implicit;s(2),f(t.barcode||"---"),s(2),S(" ",t.product_name," "),s(3),f(t.expiry_date),s(),m("pEditableColumn",t.unit_price),s(4),m("pEditableColumn",t.discount_percentage),s(4),m("pEditableColumn",t.quantity)("ngClass",ae(10,ri,!t.quantity)),s(5),S(" ",x(22,8,t.unit_price*t.quantity)," ")}}function fi(i,l){if(i&1&&(n(0,"h4",49),p(1),o()),i&2){let t=c(3);s(),S(" Total units: ",t.invoiceTotal.total_qty," ")}}function vi(i,l){if(i&1&&y(0,fi,2,1,"h4",48),i&2){let t=c(2);m("ngIf",t.invoiceTotal.total_qty)}}function yi(i,l){i&1&&(n(0,"tr",50)(1,"td",51),p(2,"No data yet!"),o()())}function Ci(i,l){if(i&1){let t=w();n(0,"p-card",10)(1,"div",11)(2,"div",12)(3,"div",13),C(4,"div",14),n(5,"label"),p(6,"Invoice Date"),o(),n(7,"p-calendar",15),I("ngModelChange",function(e){u(t);let a=c();return T(a.invoice_date,e)||(a.invoice_date=e),h(e)}),o()()(),n(8,"div",12)(9,"div",14)(10,"label",16),p(11,"Customer"),o(),n(12,"p-dropdown",17),I("ngModelChange",function(e){u(t);let a=c();return T(a.customer_id,e)||(a.customer_id=e),h(e)}),d("onChange",function(e){u(t);let a=c();return h(a.customerChange(e.value))}),o()()(),n(13,"div",18)(14,"h3",19),p(15),b(16,"currency"),o(),n(17,"h3",20),p(18),b(19,"lira"),o()()(),n(20,"div",11)(21,"div",21)(22,"p-table",22,0),d("onEditComplete",function(e){u(t);let a=c();return h(a.onEditComplete(e))}),y(24,si,15,0,"ng-template",23)(25,gi,25,12,"ng-template",4)(26,vi,1,1,"ng-template",24)(27,yi,3,0,"ng-template",25),o()(),n(28,"div",26)(29,"p-autoComplete",27,1),I("ngModelChange",function(e){u(t);let a=c();return T(a.search_product,e)||(a.search_product=e),h(e)}),d("completeMethod",function(e){u(t);let a=c();return h(a.searchItem(e))})("onKeyUp",function(e){u(t);let a=c();return h(a.submitInvoiceInput(e))}),o(),n(31,"button",28),d("click",function(){u(t);let e=c();return h(e.openProductsDialog())}),o()(),C(32,"div",26),n(33,"div",26)(34,"label",29),p(35,"Reason:"),o(),n(36,"input",30),I("ngModelChange",function(e){u(t);let a=c();return T(a.update_reason,e)||(a.update_reason=e),h(e)}),o()()()()}if(i&2){let t=c();s(7),E("ngModel",t.invoice_date),m("ngModelOptions",D(26,oi))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),s(5),E("ngModel",t.customer_id),m("options",t.customers)("filter",!0)("showClear",!0),s(3),S(" USD: ",x(16,22,t.invoiceTotal.total_dollar)," "),s(3),S(" LBP: ",x(19,24,t.invoiceTotal.total_dollar*t.invoice.exchange_rate)," "),s(4),Ne("scrollHeight",t.vh),m("value",t.order_items)("scrollable",!0),s(7),E("ngModel",t.search_product),m("suggestions",t.matching_products)("delay",150)("autofocus",!0),s(7),ut("invalid",!t.update_reason),E("ngModel",t.update_reason)}}function bi(i,l){if(i&1){let t=w();n(0,"p-button",55),d("onClick",function(){u(t);let e=c(2);return h(e.deleteDialogVisible=!0)}),o()}if(i&2){let t=c(2);m("disabled",t.submitted())}}function xi(i,l){if(i&1){let t=w();y(0,bi,1,1,"p-button",52),n(1,"p-button",53),d("onClick",function(){u(t);let e=c();return h(e.closeEditDialog())}),o(),n(2,"p-button",54),d("onClick",function(){u(t);let e=c();return h(e.submitEditInvoice())}),o()}if(i&2){let t=c();m("ngIf",t.userPermissions().delete_invoice),s(),m("disabled",t.submitted()),s(),m("loading",t.submitted())("disabled",t.order_items.length==0||!t.update_reason)}}function Si(i,l){if(i&1){let t=w();n(0,"div",57)(1,"div",58),d("click",function(){let e=u(t).$implicit,a=c(2);return h(a.selectedVariant=e)}),n(2,"p"),p(3),C(4,"br"),n(5,"small"),p(6),o()()()()}if(i&2){let t=l.$implicit,r=c(2);s(),m("ngClass",ae(3,li,r.selectedVariant==t)),s(2),S(" ",t.expiry_date," "),s(3),S("Current qty: ",t.variant_quantity,"")}}function wi(i,l){if(i&1&&(n(0,"div",11),y(1,Si,7,5,"div",56),o()),i&2){let t=c();s(),m("ngForOf",t.productToAdd==null?null:t.productToAdd.variants_records)}}function Ei(i,l){if(i&1){let t=w();n(0,"p-button",59),d("onClick",function(){u(t);let e=c();return h(e.variantDialogVisible=!1)}),o(),n(1,"p-button",60),d("onClick",function(){u(t);let e=c();return h(e.submitVariant())}),o()}}function Ti(i,l){if(i&1){let t=w();n(0,"div",61)(1,"div",62)(2,"label",63),p(3,"Delete Reason"),o(),n(4,"input",64),I("ngModelChange",function(e){u(t);let a=c();return T(a.deleteNote,e)||(a.deleteNote=e),h(e)}),o()()()}if(i&2){let t=c();s(4),E("ngModel",t.deleteNote)}}function Ii(i,l){if(i&1){let t=w();n(0,"p-button",65),d("onClick",function(){u(t);let e=c();return h(e.deleteDialogVisible=!1)}),o(),n(1,"p-button",66),d("onClick",function(){u(t);let e=c();return h(e.confirmDelete())}),o()}if(i&2){let t=c();s(),m("disabled",!t.deleteNote)("loading",t.loadingSubmitDelete)}}var st=(()=>{let l=class l{constructor(){this.visible=!1,this.customers=[],this.return_invoice_edit=!1,this.onSubmit=new Ce,this.onHide=new Ce,this.stockService=g(Xe),this.editInvoiceService=g(Vt),this.authService=g(ce),this.confirmationService=g(We),this.notificationsService=g(A),this.sellService=g(Et),this.fb=g(ze),this.api=g($),this.notification=g(A),this.customersService=g(ie),this.userPermissions=this.authService.userPermissions,this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new it,this.order_items=[],this.customer_id=null,this.invoice_number="123",this.selected_price_type="latest",this.selectedCustomerLatestItems=[],this.update_reason=null,this.productsDialogVisible=!1,this.subscriptions=new K,this.products=this.stockService.products,this.matching_products=[],this.priceTypes=Object.keys(wt),this.editDialogVisible=!1,this.vh="50vh",this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null,this.deleteDialogVisible=!1,this.deleteNote=null,this.loadingSubmitDelete=!1}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(r=>{(r==="UPDATE"||r==="DELETE")&&(this.onSubmit.emit({action:r}),this.editInvoiceService.action_status$.next(""),this.visible=!1,this.update_reason=null)})),this.subscriptions.add(this.editInvoiceService.selectedCustomerLatestItems.subscribe(r=>{this.selectedCustomerLatestItems=r})),this.subscriptions.add(this.sellService.barcodeResponse.subscribe(r=>{r&&(this.addProduct(r),this.sellService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=(0,Ht.default)(this.invoice.order_date).format("YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.order_items=structuredClone(this.invoice.items),this.customer_id=this.invoice.customer_id,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_amount,this.customerChange(this.invoice.customer_id))}setPrice(r){this.updatedRowIndex=r}onDiscountChange(r){this.updatedRowIndex=r}onEditComplete(r){r.field=="discount_percentage"?this.order_items=this.order_items.map((e,a)=>this.updatedRowIndex===a?mt(ct({},e),{unit_price:parseFloat((e.original_price*(1-e.discount_percentage/100)).toFixed(2))}):e):r.field=="unit_price"&&(this.order_items=this.order_items.map((e,a)=>this.updatedRowIndex===a?mt(ct({},e),{discount_percentage:parseFloat((100*(1-e.unit_price/e.original_price)).toFixed(2))}):e)),this.calculateTotal("edit")}setQty(r){this.calculateTotal("edit")}validateItems(){return!1}addProduct(r){this.productToAdd=r,r.has_variants?this.variantDialogVisible=!0:this.addProductToInvoice(r)}addProductToInvoice(r,e=null){let a=this.order_items.find(_=>_.product_id===r.product_id&&_.variant_id===e?.variant_id);a?(a.quantity+=1,this.calculateTotal("edit")):(this.order_items.push({product_id:r.product_id,barcode:r.barcode,product_name:r.product_name,original_price:r.unit_price_usd,unit_cost:r.unit_cost_usd,unit_price:r.unit_price_usd,quantity:1,variant_id:e?.variant_id,expiry_date:e?.expiry_date,stock_management:r.stock_management}),this.calculateTotal("add"))}submitVariant(){this.addProductToInvoice(this.productToAdd,this.selectedVariant),this.variantDialogVisible=!1}resetVariantsDialog(){this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}submitInvoiceInput(r){r.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.sellService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(r){if(r){let e=-1,a=["*","+"];for(let M=0;M<a.length;M++)if(r.indexOf(a[M])!==-1){e=r.indexOf(a[M]);break}let _=r.substring(0,e)||1,v=parseInt(r.substring(e+1,r.length));e!=-1&&e!=0?(this.sellService.factor.set(parseInt(_)),this.sellService.submitBarcode(v)):this.sellService.submitBarcode(r)}}calculateTotal(r){let e=new it,a=this.order_items;return a.length>0&&(a.forEach(_=>{e.total_qty+=_.quantity,e.cost_dollar+=_.unit_cost*_.quantity,e.subtotal_dollar+=_.unit_price*_.quantity}),e.total_dollar=e.subtotal_dollar-e.discount_dollar),this.invoiceTotal=e,e}submitEditInvoice(){let r=this.validateItems();r?r&&this.notificationsService.showError("Please enter price for all items","home"):this.return_invoice_edit?this.editInvoiceService.returnCheckout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.checkout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number,update_reason:this.update_reason},this.stockService)}searchItem(r){let e=this.products(),a=[],_=r.query;for(let v=0;v<e.length;v++){let M=e[v];M.product_name.toLowerCase().indexOf(_.toLowerCase())>-1&&a.push(M)}this.matching_products=a}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}customerChange(r){}removeRow(r){this.order_items.splice(r,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.order_items=[],this.submitted.set(!1),this.invoiceTotal=new it}})}assignSelectedProducts(r){this.productsDialogVisible=!1,r.forEach(e=>{this.addProduct(e)})}getPriceTypeLabel(r){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[r]}select(r){r.select()}getPriceWarining(r){if(!r.unit_price)return!1;let e=r.unit_cost||0,a=r.unit_price;return typeof e=="string"&&(e=parseFloat(e)),typeof a=="string"&&(a=parseFloat(a)),a<e}deleteInvoice(){this.deleteDialogVisible=!0}hideDeleteDialog(){this.deleteNote=null,this.deleteDialogVisible=!1}confirmDelete(){this.deleteNote&&(this.loadingSubmitDelete=!0,this.api.delete(`sell-orders/${this.invoice.order_id}?message=${this.deleteNote}`).pipe(Me(()=>{this.loadingSubmitDelete=!1,this.stockService.getItems(),this.customersService.getCustomerTotalBalance(this.invoice.customer_id),this.deleteDialogVisible=!1,this.visible=!1})).subscribe({next:r=>{this.notification.showSuccess(r.message,"home")}}))}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["edit-invoice"]],inputs:{visible:"visible",invoice:"invoice",customers:"customers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[Be],decls:10,vars:24,consts:[["invoiceTable",""],["barcodeInput",""],["editPrice",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","products"],["position","top","header","Choose Variant","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints","closeOnEscape","closable"],["pTemplate","content"],["header","Confirm","position","center",3,"visibleChange","onHide","visible","modal","closable"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","customer"],["styleClass","p-inputtext-sm","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"onEditComplete","value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],["for",""],["type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["width","20%"],["width","40%"],["width","10%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","discount_percentage",3,"pEditableColumn"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","priceEditable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],["min","0.1","step","0.1",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","minFractionDigits"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["label","Delete","icon","pi pi-trash","severity","danger","size","small","class","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["label","Cancel Edit","icon","pi pi-times","severity","secondary","size","small",1,"w-full","mt-2","md:w-auto","md:ml-2",3,"onClick","disabled"],["size","small","label","Submit Edit","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2","size","small",3,"onClick","loading","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",1,"w-full","mt-4","md:w-auto","md:mt-0",3,"onClick","disabled"],["class","col-12 md:col-3",4,"ngFor","ngForOf"],[1,"col-12","md:col-3"],[1,"dark-hover","shadow-2","p-3","text-center","border-round",3,"click","ngClass"],["pRipple","","size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],["pRipple","","size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],[1,"formgrid","grid"],[1,"field","col-12"],["for","note"],["type","text","id","note","name","note","required","","pInputText","","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngModelChange","ngModel"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Proceed","icon","pi pi-check","severity","danger","size","small",3,"onClick","disabled","loading"]],template:function(e,a){e&1&&(n(0,"p-dialog",3),I("visibleChange",function(v){return T(a.visible,v)||(a.visible=v),v}),d("onHide",function(){return a.closeEditDialog()}),y(1,Ci,37,27,"ng-template",4)(2,xi,3,4,"ng-template",5),o(),n(3,"products-dialog",6),d("onHide",function(){return a.productsDialogVisible=!1})("onSubmit",function(v){return a.assignSelectedProducts(v)}),o(),n(4,"p-dialog",7),I("visibleChange",function(v){return T(a.variantDialogVisible,v)||(a.variantDialogVisible=v),v}),d("onHide",function(){return a.resetVariantsDialog()}),y(5,wi,2,1,"ng-template",8)(6,Ei,2,0,"ng-template",5),o(),n(7,"p-dialog",9),I("visibleChange",function(v){return T(a.deleteDialogVisible,v)||(a.deleteDialogVisible=v),v}),d("onHide",function(){return a.hideDeleteDialog()}),y(8,Ti,5,1,"ng-template",8)(9,Ii,2,2,"ng-template",5),o()),e&2&&(L(D(20,ei)),E("visible",a.visible),m("modal",!0)("closable",!0)("maximizable",!0),s(3),m("visible",a.productsDialogVisible)("products",a.products),s(),L(D(21,ti)),E("visible",a.variantDialogVisible),m("modal",!0)("breakpoints",D(22,ii))("closeOnEscape",!1)("closable",!0),s(3),L(D(23,ni)),E("visible",a.deleteDialogVisible),m("modal",!0)("closable",!0))},dependencies:[xe,Oe,Q,Y,B,Le,Se,we,W,k,Qe,Ue,j,O,N,te,G,z,R,Ge,nt,F,ot],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:40px;height:28px}.priceEditable[_ngcontent-%COMP%]{width:60px;height:28px;text-align:center}[_nghost-%COMP%]  .p-inputnumber-input{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}[_nghost-%COMP%]  .small-button{font-size:.5rem!important;padding:.2rem .4rem!important;width:2rem!important}[_nghost-%COMP%]  .small-input>span>input{padding:.3rem!important;width:2rem!important;text-align:center}[_nghost-%COMP%]  .invoice-body>div>div{padding:0!important}[_nghost-%COMP%]  .p-dataview-emptymessage{display:none}[_nghost-%COMP%]  .p-card-content{padding:0!important}.invalid[_ngcontent-%COMP%]{border-color:var(--red-500)!important}.category-cards[_ngcontent-%COMP%]{border-radius:6px;color:#343a40;text-align:center;padding:.8rem;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.selected[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}[_nghost-%COMP%]  .p-datatable{font-size:13px!important}[_nghost-%COMP%]  .p-card-body{padding:.8rem!important}[_nghost-%COMP%]  .maxHeight{height:100%!important}[_nghost-%COMP%]  .small-table{font-size:12px!important}"]});let i=l;return i})();var Di=()=>[10,25,50],Ft=()=>({width:"95vw"});function Pi(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Invoice #"),o(),n(3,"th"),p(4,"Customer"),o(),n(5,"th"),p(6,"Datetime"),o(),n(7,"th"),p(8,"total"),o(),n(9,"th",20),p(10,"Options"),o()())}function Vi(i,l){if(i&1){let t=w();n(0,"p-button",25),d("onClick",function(){u(t);let e=c().$implicit,a=c();return h(a.openEditDialog(e))}),o()}}function Hi(i,l){if(i&1){let t=w();n(0,"p-button",26),d("onClick",function(){u(t);let e=c().$implicit,a=c();return h(a.openEditHistoryDialog(e))}),o()}if(i&2){let t=c(2);m("loading",t.loadingEditHistory)}}function Mi(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td")(11,"p-button",21),d("onClick",function(){let e=u(t).$implicit,a=c();return h(a.showInvoiceDialog(e))}),o()(),n(12,"td")(13,"p-button",22),d("onClick",function(){let e=u(t).$implicit,a=c();return h(a.printInvoice(e))}),o()(),n(14,"td"),y(15,Vi,1,0,"p-button",23),o(),n(16,"td"),y(17,Hi,1,1,"p-button",24),o()()}if(i&2){let t=l.$implicit,r=c();s(2),f(t.invoice_number),s(2),f(t.customer_name||"---"),s(2),f(t.order_date),s(2),f(x(9,6,t.total_amount)),s(7),m("ngIf",r.userPermissions().edit_invoice),s(2),m("ngIf",t.update_reason)}}function Fi(i,l){i&1&&(n(0,"tr")(1,"td",27),p(2,"No Records Found!"),o()())}function ki(i,l){i&1&&(n(0,"th",35),p(1," Unit Cost "),o())}function Bi(i,l){i&1&&(n(0,"th"),p(1,"Total Cost"),o())}function Ni(i,l){if(i&1&&(n(0,"tr")(1,"th",30),p(2,"Barcode"),o(),n(3,"th",31),p(4,"Description"),o(),n(5,"th"),p(6,"Expiry Date"),o(),n(7,"th"),p(8,"Original Price"),o(),n(9,"th"),p(10,"Sold Price"),o(),n(11,"th"),p(12,"Discount %"),o(),n(13,"th",32),p(14,"Qty"),o(),n(15,"th"),p(16,"Total Price"),o(),y(17,ki,2,0,"th",33)(18,Bi,2,0,"th",34),o()),i&2){let t=c(3);s(17),m("ngIf",t.userPermissions().show_cost),s(),m("ngIf",t.userPermissions().show_cost)}}function Oi(i,l){if(i&1&&(n(0,"td",35),p(1),b(2,"currency"),o()),i&2){let t=c().$implicit;s(),S(" ",x(2,1,t.unit_cost)," ")}}function Ri(i,l){if(i&1&&(n(0,"td"),p(1),b(2,"currency"),o()),i&2){let t=c().$implicit;s(),S(" ",x(2,1,t.unit_cost*t.quantity)," ")}}function Wi(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td"),p(11),b(12,"currency"),o(),n(13,"td"),p(14),o(),n(15,"td"),p(16),o(),n(17,"td"),p(18),b(19,"currency"),o(),y(20,Oi,3,3,"td",33)(21,Ri,3,3,"td",34),o()),i&2){let t=l.$implicit,r=c(3);s(2),f(t.barcode||"---"),s(2),f(t.product_name),s(2),f(t.expiry_date||"---"),s(2),f(x(9,10,t.original_price)),s(3),S(" ",x(12,12,t.unit_price)," "),s(3),S("",t.discount_percentage,"%"),s(2),f(t.quantity),s(2),S(" ",x(19,14,t.total_price)," "),s(2),m("ngIf",r.userPermissions().show_cost),s(),m("ngIf",r.userPermissions().show_cost)}}function Li(i,l){i&1&&C(0,"td",35)}function zi(i,l){if(i&1&&(n(0,"td"),p(1),b(2,"currency"),o()),i&2){let t=c(4);s(),S(" ",x(2,1,t.selectedInvoiceTotals.totalCost)," ")}}function qi(i,l){if(i&1&&(n(0,"tr"),C(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td"),n(7,"td"),p(8),o(),n(9,"td"),p(10),b(11,"currency"),o(),y(12,Li,1,0,"td",33)(13,zi,3,3,"td",34),o()),i&2){let t=c(3);s(8),f(t.selectedInvoiceTotals.totalQty),s(2),S(" ",x(11,4,t.selectedInvoiceTotals.totalPrice)," "),s(2),m("ngIf",t.userPermissions().show_cost),s(),m("ngIf",t.userPermissions().show_cost)}}function Ai(i,l){if(i&1&&(n(0,"p-table",29),y(1,Ni,19,2,"ng-template",12)(2,Wi,22,16,"ng-template",13)(3,qi,14,6,"ng-template",17),o()),i&2){let t=c(2);m("value",t.invoiceItems)}}function $i(i,l){if(i&1&&y(0,Ai,4,1,"p-table",28),i&2){let t=c();m("ngIf",t.invoiceItems.length!=0)}}function Yi(i,l){if(i&1){let t=w();n(0,"p-button",36),d("onClick",function(){u(t);let e=c();return h(e.hideInvoiceDialog())}),o()}}function ji(i,l){i&1&&(n(0,"tr"),C(1,"th",39),n(2,"th"),p(3,"Created At"),o(),n(4,"th"),p(5,"Updated At"),o(),n(6,"th"),p(7,"Update Reason"),o(),n(8,"th"),p(9,"Total Price"),o()())}function Gi(i,l){if(i&1&&(n(0,"tr")(1,"td"),C(2,"p-button",40),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),o(),n(9,"td"),p(10),b(11,"currency"),o()()),i&2){let t=l.$implicit,r=l.expanded;s(2),m("pRowToggler",t)("text",!0)("rounded",!0)("plain",!0)("icon",r?"pi pi-chevron-down":"pi pi-chevron-right"),s(2),f(t.order_datetime),s(2),f(t.updated_at),s(2),f(t.update_reason),s(2),S(" ",x(11,9,t.total_amount)," ")}}function Ki(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Description"),o(),C(3,"th")(4,"th")(5,"th"),o())}function Qi(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),b(5,"currency"),o(),n(6,"td"),p(7),o(),n(8,"td"),p(9),b(10,"currency"),o()()),i&2){let t=l.$implicit;s(2),f(t.product_name),s(2),S(" ",x(5,4,t.unit_price)," "),s(3),f(t.quantity),s(2),S(" ",x(10,6,t.total_price)," ")}}function Ui(i,l){if(i&1&&(n(0,"tr")(1,"td",41)(2,"div",42)(3,"p-table",43),y(4,Ki,6,0,"ng-template",12)(5,Qi,11,8,"ng-template",13),o()()()()),i&2){let t=l.$implicit;s(3),m("value",t.items)}}function Ji(i,l){if(i&1&&(n(0,"p-table",37),y(1,ji,10,0,"ng-template",12)(2,Gi,12,11,"ng-template",13)(3,Ui,6,1,"ng-template",38),o()),i&2){let t=c();m("value",t.editHistory)("expandedRowKeys",t.expandedRows)}}function Xi(i,l){if(i&1){let t=w();n(0,"p-button",36),d("onClick",function(){u(t);let e=c();return h(e.editHistoryDialogVisible=!1)}),o()}}var Bt=(()=>{let l=class l{constructor(){this.customerService=g(ie),this.historyService=g(oe),this.decimalService=g(pe),this.printService=g(Te),this.authService=g(ce),this.whatsappService=g(lt),this.api=g($),this.userPermissions=this.authService.userPermissions,this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new K,this.salesHistory=this.historyService.salesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({invoice_number:new V(null),customer_id:new V(null),invoice_date:new V(null)}),this.whatsappLoading=this.whatsappService.whatsappLoading,this.editHistoryDialogVisible=!1,this.loadingEditHistory=!1,this.expandedRows={}}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,kt.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchSalesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchSalesHistory(null)}showInvoiceDialog(r){this.invoiceItems=r.items,this.invoiceItems.forEach(e=>{this.selectedInvoiceTotals.totalQty+=e.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,e.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,e.unit_cost*e.quantity)}),this.detailsDialogVisible=!0}openEditDialog(r){this.selectedInvoice=r,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(r){this.historyService.fetchSalesHistory(this.searchForm.value)}printInvoice(r){this.printService.print(r,"sale")}sendWhatsapp(r){this.whatsappLoading.set(!0);let e={to:r.customer_phone,messageContents:[r.invoice_number,r.order_datetime,`${r.total_amount}$`]};this.whatsappService.sendMessage(e)}openEditHistoryDialog(r){this.loadingEditHistory=!0,this.api.get(`history/edits/${r.order_id}`).pipe(Me(()=>{this.loadingEditHistory=!1})).subscribe({next:e=>{console.log(e),this.editHistoryDialogVisible=!0,this.editHistory=e}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-sell-history"]],decls:26,vars:37,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers"],["header","Edit History","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["colspan","4","width","10%"],["size","small","severity","info","icon","fas fa-eye",3,"onClick"],["size","small","severity","secondary","icon","pi pi-print",3,"onClick"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick",4,"ngIf"],["size","small","severity","help","icon","pi pi-history",3,"loading","onClick",4,"ngIf"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["size","small","severity","help","icon","pi pi-history",3,"onClick","loading"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","15%"],["width","30%"],["width","5%"],["style","border-left: 1px #e5e7eb solid",4,"ngIf"],[4,"ngIf"],[2,"border-left","1px #e5e7eb solid"],["label","Close","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value","expandedRowKeys"],["pTemplate","rowexpansion"],[2,"width","5rem"],["type","button",3,"pRowToggler","text","rounded","plain","icon"],["colspan","7"],[1,"p-3"],["dataKey","id",3,"value"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"input",6),o(),n(8,"div",5),C(9,"p-dropdown",7),o(),n(10,"div",5),C(11,"p-calendar",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,Pi,11,0,"ng-template",12)(17,Mi,18,8,"ng-template",13)(18,Fi,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),I("visibleChange",function(v){return T(a.detailsDialogVisible,v)||(a.detailsDialogVisible=v),v}),d("onHide",function(){return a.hideInvoiceDialog()}),y(20,$i,1,1,"ng-template",16)(21,Yi,1,0,"ng-template",17),o(),n(22,"edit-invoice",18),d("onHide",function(){return a.closeEditDialog()})("onSubmit",function(v){return a.submitEdit(v)}),o(),n(23,"p-dialog",19),I("visibleChange",function(v){return T(a.editHistoryDialogVisible,v)||(a.editHistoryDialogVisible=v),v}),d("onHide",function(){return a.editHistory=null}),y(24,Ji,4,2,"ng-template",16)(25,Xi,1,0,"ng-template",17),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(5),m("options",a.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),s(2),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.salesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(34,Di))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),L(D(35,Ft)),E("visible",a.detailsDialogVisible),m("modal",!0)("closable",!0)("maximizable",!0),s(3),m("visible",a.editDialogVisible)("invoice",a.selectedInvoice)("customers",a.customers()),s(),L(D(36,Ft)),E("visible",a.editHistoryDialogVisible),m("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[Q,X,Y,B,U,Z,ee,W,k,bt,O,N,te,G,z,R,ne,st,F]});let i=l;return i})();var Nt=De(Pe());var Zi=()=>[10,25,50];function en(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Payment #"),o(),n(3,"th"),p(4,"Customer"),o(),n(5,"th"),p(6,"Datetime"),o(),n(7,"th"),p(8,"total"),o(),n(9,"th",16),p(10,"Options"),o()())}function tn(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td")(11,"button",17),d("click",function(){let e=u(t).$implicit,a=c();return h(a.printInvoice(e))}),o()(),n(12,"td")(13,"button",18),d("click",function(){let e=u(t).$implicit,a=c();return h(a.openEditDialog(e))}),o()()()}if(i&2){let t=l.$implicit;s(2),f(t.journal_number),s(2),f(t.partner_name),s(2),f(t.payment_date),s(2),f(x(9,4,t.total_value))}}function nn(i,l){i&1&&(n(0,"tr")(1,"td",19),p(2,"No Records Found!"),o()())}var Ot=(()=>{let l=class l{constructor(){this.customerService=g(ie),this.historyService=g(oe),this.customers=this.customerService.customers,this.customersLoading=this.customerService.signal_tableLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.paymentsHistory=this.historyService.paymentsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({payment_date:new V(null),partner_id:new V(null),payment_number:new V(null)})}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=(0,Nt.default)(this.searchForm.value.payment_date).format("YYYY-MM-DD")),this.historyService.fetchPaymentHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPaymentHistory(null)}showInvoiceDialog(r){}printInvoice(r){}openEditDialog(r){this.selectedPayment=r,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(r){this.historyService.fetchPaymentHistory(this.searchForm.value)}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-payment-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"input",6),o(),n(8,"div",5),C(9,"p-dropdown",7),o(),n(10,"div",5),C(11,"p-calendar",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,en,11,0,"ng-template",12)(17,tn,14,6,"ng-template",13)(18,nn,3,0,"ng-template",14),o()()()(),n(19,"payment-dialog",15),d("onClose",function(){return a.hidePaymentDialog()})("onSubmit",function(v){return a.getPaymentDilogResult(v)}),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(5),m("options",a.customers())("loading",a.customersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0),s(2),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.paymentsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(22,Zi))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),m("visible",a.editDialogVisible)("selected_payment",a.selectedPayment)("accounts",a.customers()))},dependencies:[X,Y,B,U,Z,ee,W,k,j,O,N,G,z,R,ne,Ze,F]});let i=l;return i})();var Rt=De(Pe());var on=()=>[10,25,50],rn=()=>({width:"95vw"});function an(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Invoice #"),o(),n(3,"th"),p(4,"Customer"),o(),n(5,"th"),p(6,"Datetime"),o(),n(7,"th"),p(8,"total"),o(),n(9,"th",19),p(10,"Options"),o()())}function ln(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td")(11,"button",20),d("click",function(){let e=u(t).$implicit,a=c();return h(a.showInvoiceDialog(e))}),o()(),n(12,"td")(13,"button",21),d("click",function(){let e=u(t).$implicit,a=c();return h(a.printInvoice(e))}),o()(),n(14,"td")(15,"button",22),d("click",function(){let e=u(t).$implicit,a=c();return h(a.openEditDialog(e))}),o()()()}if(i&2){let t=l.$implicit;s(2),f(t.invoice_number),s(2),f(t.customer_name),s(2),f(t.order_date),s(2),f(x(9,4,t.total_amount))}}function sn(i,l){i&1&&(n(0,"tr")(1,"td",23),p(2,"No Records Found!"),o()())}function pn(i,l){i&1&&(n(0,"tr")(1,"th",26),p(2,"Description"),o(),n(3,"th",27),p(4,"Unit Price"),o(),n(5,"th",28),p(6,"Qty"),o(),n(7,"th",27),p(8,"Total Price"),o()())}function cn(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),b(5,"currency"),o(),n(6,"td"),p(7),o(),n(8,"td"),p(9),b(10,"currency"),o()()),i&2){let t=l.$implicit;s(2),f(t.product_name),s(2),S(" ",x(5,4,t.unit_price)," "),s(3),f(t.quantity),s(2),S(" ",x(10,6,t.total_price)," ")}}function mn(i,l){if(i&1&&(n(0,"tr"),C(1,"td")(2,"td"),n(3,"td"),p(4),o(),n(5,"td"),p(6),b(7,"currency"),o()()),i&2){let t=c(3);s(4),f(t.selectedInvoiceTotals.totalQty),s(2),S(" Total: ",x(7,2,t.selectedInvoiceTotals.totalPrice)," ")}}function dn(i,l){if(i&1&&(n(0,"p-table",25),y(1,pn,9,0,"ng-template",12)(2,cn,11,8,"ng-template",13)(3,mn,8,4,"ng-template",17),o()),i&2){let t=c(2);m("value",t.invoiceItems)}}function _n(i,l){if(i&1&&y(0,dn,4,1,"p-table",24),i&2){let t=c();m("ngIf",t.invoiceItems.length!=0)}}function un(i,l){if(i&1){let t=w();n(0,"button",29),d("click",function(){u(t);let e=c();return h(e.hideInvoiceDialog())}),o()}}var Wt=(()=>{let l=class l{constructor(){this.customerService=g(ie),this.historyService=g(oe),this.decimalService=g(pe),this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new K,this.returnHistory=this.historyService.returnHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({invoice_number:new V(null),customer_id:new V(null),invoice_date:new V(null)})}ngOnInit(){}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,Rt.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchReturnHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReturnHistory(null)}showInvoiceDialog(r){this.invoiceItems=r.items,this.invoiceItems.forEach(e=>{this.selectedInvoiceTotals.totalQty+=e.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,e.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,e.unit_cost)}),this.detailsDialogVisible=!0}printInvoice(r){}printDelivery(r){}openEditDialog(r){console.log(r),this.selectedInvoice=r,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(r){this.historyService.fetchReturnHistory(this.searchForm.value)}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-sell-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers","return_invoice_edit"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","pi pi-print",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","50%"],["width","20%"],["width","10%"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"p-dropdown",6),o(),n(8,"div",5),C(9,"p-calendar",7),o(),n(10,"div",5),C(11,"input",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,an,11,0,"ng-template",12)(17,ln,16,6,"ng-template",13)(18,sn,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),I("visibleChange",function(v){return T(a.detailsDialogVisible,v)||(a.detailsDialogVisible=v),v}),d("onHide",function(){return a.hideInvoiceDialog()}),y(20,_n,1,1,"ng-template",16)(21,un,1,0,"ng-template",17),o(),n(22,"edit-invoice",18),d("onHide",function(){return a.closeEditDialog()})("onSubmit",function(v){return a.submitEdit(v)}),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(3),m("options",a.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0),s(4),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.returnHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(28,on))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),L(D(29,rn)),E("visible",a.detailsDialogVisible),m("modal",!0)("closable",!0)("maximizable",!0),s(3),m("visible",a.editDialogVisible)("invoice",a.selectedInvoice)("customers",a.customers())("return_invoice_edit",!0))},dependencies:[Q,X,Y,B,U,Z,ee,W,k,j,O,N,te,G,z,R,ne,st,F]});let i=l;return i})();var At=De(Pe());var Lt=(()=>{let l=class l{constructor(){this.apiService=g($),this.http=g(le),this.notificationService=g(A),this.suppliersService=g(Ee),this.host=this.apiService.host,this.currentInvoice=P({}),this.signal_submited=P(!1),this.signal_submit_loading=P(!1),this.action_status$=new ye(""),this.selectedSupplierLatestItems=new ye([])}chcekout(r,e){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/supply`,r).subscribe({next:a=>{this.notificationService.showSuccess("Invoice Updated","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(r.partner_id_fk)}})}returnCheckout(r,e){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,r).subscribe({next:a=>{this.notificationService.showSuccess("Invoice Updated","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(r.partner_id_fk)}})}deleteInvoice(r,e){let a=r.order_id;console.log(a),this.signal_submited.set(!0),this.http.delete(`${this.host}/supply/${a}`).subscribe({next:_=>{this.notificationService.showSuccess(_.message,"home")},error:_=>{this.notificationService.handleError(_.error,"home"),this.signal_submited.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(r.partner_id_fk)}})}returnDeleteInvoice(r,e){let a=r.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${a}`).subscribe({next:_=>{this.notificationService.showSuccess(_.message,"home")},error:_=>{this.notificationService.handleError(_.error,"home"),this.signal_submited.set(!1)},complete:()=>{e.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(r.partner_id_fk)}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var hn=()=>({width:"95vw",height:"75vh"}),gn=()=>({width:"65vw"}),fn=()=>({"1199px":"75vw","575px":"95vw"}),vn=()=>({standalone:!0}),yn=i=>({"ng-invalid ng-dirty":i}),zt=i=>({invalid:i}),Cn=(i,l)=>({"text-red-500":i,"text-orange-500":l}),bn=i=>({"text-red-500":i}),xn=i=>({selected:i});function Sn(i,l){i&1&&(n(0,"small",29),p(1,"Supplier is required."),o())}function wn(i,l){i&1&&(n(0,"tr")(1,"th",30),p(2,"Barcode"),o(),n(3,"th",31),p(4,"Description"),o(),n(5,"th",32),p(6,"Expiry Date"),o(),n(7,"th",33),p(8,"Unit"),o(),n(9,"th",34),p(10,"Qty"),o(),n(11,"th",33),p(12,"Total"),o(),n(13,"th",34),p(14,"Del?"),o()())}function En(i,l){if(i&1){let t=w();n(0,"p-inputNumber",41),I("ngModelChange",function(e){u(t);let a=c().$implicit;return T(a.unit_price,e)||(a.unit_price=e),h(e)}),d("ngModelChange",function(){u(t);let e=c().$implicit,a=c(2);return h(a.setPrice(e))})("onFocus",function(e){u(t);let a=c(3);return h(a.select(e.target))}),o()}if(i&2){let t=c().$implicit;E("ngModel",t.unit_price),m("maxFractionDigits",2)("min",0)}}function Tn(i,l){i&1&&C(0,"i",44)}function In(i,l){if(i&1&&(n(0,"span",42),p(1),b(2,"currency"),n(3,"span"),y(4,Tn,1,0,"i",43),o()()),i&2){let t=c().$implicit,r=c(2);m("ngClass",be(5,Cn,!t.unit_price,r.getPriceWarining(t))),s(),f(x(2,3,t.unit_price)),s(3),m("ngIf",r.getPriceWarining(t))}}function Dn(i,l){if(i&1){let t=w();n(0,"p-inputNumber",45),I("ngModelChange",function(e){u(t);let a=c().$implicit;return T(a.quantity,e)||(a.quantity=e),h(e)}),d("onFocus",function(e){u(t);let a=c(3);return h(a.select(e.target))})("ngModelChange",function(){u(t);let e=c().$implicit,a=c(2);return h(a.setQty(e))}),o()}if(i&2){let t=c().$implicit;E("ngModel",t.quantity)}}function Pn(i,l){if(i&1&&(n(0,"span",42),p(1),o()),i&2){let t=c().$implicit;m("ngClass",ae(2,bn,!t.quantity)),s(),f(t.quantity)}}function Vn(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td",35)(8,"p-cellEditor"),y(9,En,1,3,"ng-template",36)(10,In,5,8,"ng-template",37),o()(),n(11,"td",38)(12,"p-cellEditor"),y(13,Dn,1,1,"ng-template",36)(14,Pn,2,4,"ng-template",37),o()(),n(15,"td"),p(16),b(17,"currency"),o(),n(18,"td",39),d("click",function(){let e=u(t).rowIndex,a=c(2);return h(a.removeRow(e))}),C(19,"i",40),o()()}if(i&2){let t=l.$implicit;s(2),f(t.barcode||"---"),s(2),f(t.product_name),s(2),f(t.expiry_date||"---"),s(),m("pEditableColumn",t.unit_price)("ngClass",ae(10,zt,!t.unit_price)),s(4),m("pEditableColumn",t.quantity)("ngClass",ae(12,zt,!t.quantity)),s(5),S(" ",x(17,8,t.unit_price*t.quantity)," ")}}function Hn(i,l){if(i&1&&(n(0,"h4",47),p(1),o()),i&2){let t=c(3);s(),S(" Total units: ",t.invoiceTotal.total_qty," ")}}function Mn(i,l){if(i&1&&y(0,Hn,2,1,"h4",46),i&2){let t=c(2);m("ngIf",t.invoiceTotal.total_qty)}}function Fn(i,l){i&1&&(n(0,"tr",48)(1,"td",49),p(2,"No data yet!"),o()())}function kn(i,l){if(i&1){let t=w();n(0,"p-card",8)(1,"div",9)(2,"div",10)(3,"div",11),C(4,"div",12),n(5,"label"),p(6,"Invoice Date"),o(),n(7,"p-calendar",13),I("ngModelChange",function(e){u(t);let a=c();return T(a.invoice_date,e)||(a.invoice_date=e),h(e)}),o()()(),n(8,"div",10)(9,"div",12)(10,"label",14),p(11,"Supplier"),n(12,"span",15),p(13," *"),o()(),n(14,"p-dropdown",16),I("ngModelChange",function(e){u(t);let a=c();return T(a.supplier_id,e)||(a.supplier_id=e),h(e)}),d("onChange",function(e){u(t);let a=c();return h(a.supplierChange(e.value))}),o(),y(15,Sn,2,0,"small",17),o()(),n(16,"div",18)(17,"h3",19),p(18),b(19,"currency"),o(),n(20,"h3",20),p(21),b(22,"lira"),o()()(),n(23,"div",9)(24,"div",21)(25,"p-table",22,0),y(27,wn,15,0,"ng-template",23)(28,Vn,20,14,"ng-template",3)(29,Mn,1,1,"ng-template",24)(30,Fn,3,0,"ng-template",25),o()(),n(31,"div",26)(32,"p-autoComplete",27,1),I("ngModelChange",function(e){u(t);let a=c();return T(a.search_product,e)||(a.search_product=e),h(e)}),d("completeMethod",function(e){u(t);let a=c();return h(a.searchItem(e))})("onKeyUp",function(e){u(t);let a=c();return h(a.submitInvoiceInput(e))}),o(),n(34,"button",28),d("click",function(){u(t);let e=c();return h(e.openProductsDialog())}),o()()()()}if(i&2){let t=c();s(7),E("ngModel",t.invoice_date),m("ngModelOptions",D(25,vn))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),s(7),E("ngModel",t.supplier_id),m("options",t.suppliers)("filter",!0)("showClear",!0)("ngClass",ae(26,yn,!t.supplier_id)),s(),m("ngIf",!t.supplier_id),s(3),S(" USD: ",x(19,21,t.invoiceTotal.total_dollar)," "),s(3),S(" LBP: ",x(22,23,t.invoiceTotal.total_dollar*t.invoice.exchange_rate)," "),s(4),Ne("scrollHeight",t.vh),m("value",t.invoice_items())("scrollable",!0),s(7),E("ngModel",t.search_product),m("suggestions",t.matching_products)("delay",150)("autofocus",!0)}}function Bn(i,l){if(i&1){let t=w();n(0,"p-button",50),d("onClick",function(){u(t);let e=c();return h(e.deleteInvoice())}),o(),n(1,"p-button",51),d("onClick",function(){u(t);let e=c();return h(e.closeEditDialog())}),o(),n(2,"p-button",52),d("onClick",function(){u(t);let e=c();return h(e.submitEditInvoice())}),o()}if(i&2){let t=c();m("disabled",t.submitted()),s(),m("disabled",t.submitted()),s(),m("loading",t.submitted())("disabled",t.invoice_items().length==0)}}function Nn(i,l){if(i&1){let t=w();n(0,"div",54)(1,"div",55),d("click",function(){let e=u(t).$implicit,a=c(2);return h(a.selectedVariant=e)}),n(2,"p"),p(3),C(4,"br"),n(5,"small"),p(6),o()()()()}if(i&2){let t=l.$implicit,r=c(2);s(),m("ngClass",ae(3,xn,r.selectedVariant==t)),s(2),S(" ",t.expiry_date," "),s(3),S("Current qty: ",t.variant_quantity,"")}}function On(i,l){if(i&1&&(n(0,"div",9),y(1,Nn,7,5,"div",53),o()),i&2){let t=c();s(),m("ngForOf",t.productToAdd==null?null:t.productToAdd.variants_records)}}function Rn(i,l){if(i&1){let t=w();n(0,"p-button",56),d("onClick",function(){u(t);let e=c();return h(e.variantDialogVisible=!1)}),o(),n(1,"p-button",57),d("onClick",function(){u(t);let e=c();return h(e.submitVariant())}),o()}}var qt=(()=>{let l=class l{constructor(){this.visible=!1,this.suppliers=[],this.return_invoice_edit=!1,this.onSubmit=new Ce,this.onHide=new Ce,this.stockService=g(Xe),this.editInvoiceService=g(Lt),this.authService=g(ce),this.confirmationService=g(We),this.notificationsService=g(A),this.supplyService=g(It),this.dateService=g(se),this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new rt,this.supplier_id=null,this.invoice_number="123",this.invoice_items=P([]),this.selectedSupplierLatestItems=[],this.productsDialogVisible=!1,this.subscriptions=new K,this.products=this.stockService.products,this.matching_products=[],this.editDialogVisible=!1,this.vh="50vh",this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(r=>{(r==="UPDATE"||r==="DELETE")&&(this.onSubmit.emit({action:r}),this.editInvoiceService.action_status$.next(""),this.visible=!1)})),this.subscriptions.add(this.supplyService.barcodeResponse.subscribe(r=>{r&&(this.addProduct(r),this.supplyService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=this.dateService.formatDate(this.invoice.order_datetime,"YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.invoice_items.set(structuredClone(this.invoice.items)),this.supplier_id=this.invoice.partner_id_fk,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_cost,this.supplierChange(this.invoice.supplier_id))}setPrice(r){r.unit_price?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}setQty(r){r.quantity?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}validateItems(){return this.invoice_items().find(e=>!e.unit_price||!e.quantity)?(this.form_error=!0,!0):(this.form_error=!1,!1)}addProduct(r){this.productToAdd=r,r.has_variants?this.variantDialogVisible=!0:this.addProductToInvoice(r)}addProductToInvoice(r,e=null){let a=this.supplyService.factor(),_=structuredClone(this.invoice_items()),v=_.find(M=>M.product_id===r.product_id&&M.variant_id===e?.variant_id);v?v.quantity+=a:_.push({product_id:r.product_id,variant_id:e?.variant_id,expiry_date:e?.expiry_date,barcode:r.barcode,product_name:r.product_name,unit_cost:r.unit_cost_usd,unit_price:r.unit_cost_usd,quantity:a,unit_abbreviation:r.unit_abbreviation,product_unit_id:r.unit_id_fk}),this.invoice_items.set(_),this.supplyService.factor.set(1),this.calculateTotal("add")}submitVariant(){this.addProductToInvoice(this.productToAdd,this.selectedVariant),this.variantDialogVisible=!1}resetVariantsDialog(){this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}submitInvoiceInput(r){r.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.supplyService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(r){if(r){let e=-1,a=["*","+"];for(let M=0;M<a.length;M++)if(r.indexOf(a[M])!==-1){e=r.indexOf(a[M]);break}let _=r.substring(0,e)||1,v=parseInt(r.substring(e+1,r.length));e!=-1&&e!=0?(this.supplyService.factor.set(parseInt(_)),this.supplyService.submitBarcode(v)):this.supplyService.submitBarcode(r)}}calculateTotal(r){let e=new rt,a=this.invoice_items();return a.length>0&&(a.forEach(_=>{e.total_qty+=_.quantity,e.cost_dollar+=_.unit_cost*_.quantity,e.subtotal_dollar+=_.unit_price*_.quantity}),e.total_dollar=e.subtotal_dollar-e.discount_dollar),this.invoiceTotal=e,e}submitEditInvoice(){let r=this.validateItems();!r&&this.supplier_id?this.return_invoice_edit?this.editInvoiceService.returnCheckout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.chcekout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):r&&this.notificationsService.showError("Please enter price for all items","home")}searchItem(r){let e=this.products(),a=[],_=r.query;for(let v=0;v<e.length;v++){let M=e[v];M.product_name.toLowerCase().indexOf(_.toLowerCase())>-1&&a.push(M)}this.matching_products=a}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}supplierChange(r){}removeRow(r){this.invoice_items().splice(r,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.invoice_items.set([]),this.submitted.set(!1),this.invoiceTotal=new rt}})}deleteInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.return_invoice_edit?this.editInvoiceService.returnDeleteInvoice(this.invoice,this.stockService):this.editInvoiceService.deleteInvoice(this.invoice,this.stockService)}})}closeProductsDialog(){}assignSelectedProducts(r){this.productsDialogVisible=!1,r.forEach(e=>{this.addProduct(e)})}getPriceTypeLabel(r){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[r]}select(r){r.select()}getPriceWarining(r){if(!r.unit_price)return!1;let e=r.unit_cost||0,a=r.unit_price;return typeof e=="string"&&(e=parseFloat(e)),typeof a=="string"&&(a=parseFloat(a)),a<e}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["edit-purchase"]],inputs:{visible:"visible",invoice:"invoice",suppliers:"suppliers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[Be],decls:7,vars:18,consts:[["invoiceTable",""],["barcodeInput",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],["price","cost",3,"onHide","onSubmit","visible","products"],["position","top","header","Choose Variant","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints","closeOnEscape","closable"],["pTemplate","content"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","supplier"],[1,"text-red-500"],["styleClass","p-inputtext-sm","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear","ngClass"],["class","p-error",4,"ngIf"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],[1,"p-error"],["width","20%"],["width","35%"],["width","15%"],["width","10%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn","ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["min","0","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",3,"onClick","disabled"],["label","Cancel Edit","icon","pi pi-times","severity","secondary","size","small",3,"onClick","disabled"],["label","Submit Edit","icon","pi pi-check","severity","success","size","small",3,"onClick","loading","disabled"],["class","col-12 md:col-3",4,"ngFor","ngForOf"],[1,"col-12","md:col-3"],[1,"dark-hover","shadow-2","p-3","text-center","border-round",3,"click","ngClass"],["size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],["size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"]],template:function(e,a){e&1&&(n(0,"p-dialog",2),I("visibleChange",function(v){return T(a.visible,v)||(a.visible=v),v}),d("onHide",function(){return a.closeEditDialog()}),y(1,kn,35,28,"ng-template",3)(2,Bn,3,4,"ng-template",4),o(),n(3,"products-dialog",5),d("onHide",function(){return a.productsDialogVisible=!1})("onSubmit",function(v){return a.assignSelectedProducts(v)}),o(),n(4,"p-dialog",6),I("visibleChange",function(v){return T(a.variantDialogVisible,v)||(a.variantDialogVisible=v),v}),d("onHide",function(){return a.resetVariantsDialog()}),y(5,On,2,1,"ng-template",7)(6,Rn,2,0,"ng-template",4),o()),e&2&&(L(D(15,hn)),E("visible",a.visible),m("modal",!0)("closable",!0)("maximizable",!0),s(3),m("visible",a.productsDialogVisible)("products",a.products),s(),L(D(16,gn)),E("visible",a.variantDialogVisible),m("modal",!0)("breakpoints",D(17,fn))("closeOnEscape",!1)("closable",!0))},dependencies:[xe,Oe,Q,B,Se,we,W,k,Qe,Ue,j,O,N,te,z,R,Ge,nt,F,ot],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:100%;height:28px}[_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.invalid[_ngcontent-%COMP%]{border-bottom:1px solid var(--red-500)!important}[_nghost-%COMP%]  .p-card-content{padding-top:0!important;padding-bottom:0!important}.selected[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}"]});let i=l;return i})();var Ln=()=>[10,25,50],zn=()=>({width:"95vw"});function qn(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Invoice #"),o(),n(3,"th"),p(4,"Supplier"),o(),n(5,"th"),p(6,"Datetime"),o(),n(7,"th"),p(8,"total"),o(),n(9,"th",19),p(10,"Options"),o()())}function An(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td")(11,"button",20),d("click",function(){let e=u(t).$implicit,a=c();return h(a.showInvoiceDialog(e))}),o()(),n(12,"td")(13,"button",21),d("click",function(){let e=u(t).$implicit,a=c();return h(a.openEditDialog(e))}),o()()()}if(i&2){let t=l.$implicit;s(2),f(t.invoice_number),s(2),f(t.supplier_name||"---"),s(2),f(t.order_date),s(2),f(x(9,4,t.total_cost))}}function $n(i,l){i&1&&(n(0,"tr")(1,"td",22),p(2,"No Records Found!"),o()())}function Yn(i,l){i&1&&(n(0,"tr")(1,"th",25),p(2,"Barcode"),o(),n(3,"th",26),p(4,"Description"),o(),n(5,"th",25),p(6,"Expiry Date"),o(),n(7,"th",27),p(8,"Unit Price"),o(),n(9,"th",28),p(10,"Qty"),o(),n(11,"th",27),p(12,"Total Price"),o()())}function jn(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td"),p(11),o(),n(12,"td"),p(13),b(14,"currency"),o()()),i&2){let t=l.$implicit;s(2),f(t.barcode||"---"),s(2),f(t.product_name),s(2),f(t.expiry_date||"---"),s(2),S(" ",x(9,6,t.unit_cost)," "),s(3),f(t.quantity),s(2),S(" ",x(14,8,t.unit_cost*t.quantity)," ")}}function Gn(i,l){if(i&1&&(n(0,"tr"),C(1,"td")(2,"td")(3,"td")(4,"td"),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o()()),i&2){let t=c(3);s(6),f(t.selectedInvoiceTotals.totalQty),s(2),S(" ",x(9,2,t.selectedInvoiceTotals.totalCost)," ")}}function Kn(i,l){if(i&1&&(n(0,"p-table",24),y(1,Yn,13,0,"ng-template",12)(2,jn,15,10,"ng-template",13)(3,Gn,10,4,"ng-template",17),o()),i&2){let t=c(2);m("value",t.invoiceItems)}}function Qn(i,l){if(i&1&&y(0,Kn,4,1,"p-table",23),i&2){let t=c();m("ngIf",t.invoiceItems.length!=0)}}function Un(i,l){if(i&1){let t=w();n(0,"p-button",29),d("onClick",function(){u(t);let e=c();return h(e.hideInvoiceDialog())}),o()}}var $t=(()=>{let l=class l{constructor(){this.suppliersService=g(Ee),this.historyService=g(oe),this.decimalService=g(pe),this.printService=g(Te),this.suppliers=[],this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0},this.subscriptions=new K,this.purchasesHistory=this.historyService.purchasesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({invoice_number:new V(null),supplier_id:new V(null),invoice_date:new V(null)})}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(r=>{this.suppliers=r}))}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,At.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchPurchasesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPurchasesHistory(null)}showInvoiceDialog(r){this.invoiceItems=r.items,this.invoiceItems.forEach(e=>{console.log(e),this.selectedInvoiceTotals.totalQty+=e.quantity,this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,e.unit_cost*e.quantity)}),this.detailsDialogVisible=!0}printDelivery(r){}openEditDialog(r){this.selectedInvoice=r,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0}}submitEdit(r){this.historyService.fetchPurchasesHistory(this.searchForm.value)}printInvoice(r){this.printService.print(r,"sale")}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-supply-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","supplier_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","suppliers"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","20%"],["width","35%"],["width","10%"],["width","5%"],["size","small","label","Close","icon","pi pi-times","severity","secondary",3,"onClick"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"input",6),o(),n(8,"div",5),C(9,"p-dropdown",7),o(),n(10,"div",5),C(11,"p-calendar",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,qn,11,0,"ng-template",12)(17,An,14,6,"ng-template",13)(18,$n,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),I("visibleChange",function(v){return T(a.detailsDialogVisible,v)||(a.detailsDialogVisible=v),v}),d("onHide",function(){return a.hideInvoiceDialog()}),y(20,Qn,1,1,"ng-template",16)(21,Un,1,0,"ng-template",17),o(),n(22,"edit-purchase",18),d("onHide",function(){return a.closeEditDialog()})("onSubmit",function(v){return a.submitEdit(v)}),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(5),m("options",a.suppliers)("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),s(2),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.purchasesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(28,Ln))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),L(D(29,zn)),E("visible",a.detailsDialogVisible),m("modal",!0)("closable",!0)("maximizable",!0),s(3),m("visible",a.editDialogVisible)("invoice",a.selectedInvoice)("suppliers",a.suppliers))},dependencies:[Q,X,Y,B,U,Z,ee,W,k,j,O,N,te,G,z,R,ne,qt,F]});let i=l;return i})();var Jn=()=>[10,25,50];function Xn(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Payment #"),o(),n(3,"th"),p(4,"Supplier"),o(),n(5,"th"),p(6,"Datetime"),o(),n(7,"th"),p(8,"total"),o(),n(9,"th",16),p(10,"Options"),o()())}function Zn(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td")(11,"button",17),d("click",function(){let e=u(t).$implicit,a=c();return h(a.printInvoice(e))}),o()(),n(12,"td")(13,"button",18),d("click",function(){let e=u(t).$implicit,a=c();return h(a.openEditDialog(e))}),o()()()}if(i&2){let t=l.$implicit;s(2),f(t.journal_number),s(2),f(t.partner_name),s(2),f(t.payment_date),s(2),f(x(9,4,t.total_value))}}function eo(i,l){i&1&&(n(0,"tr")(1,"td",19),p(2,"No Records Found!"),o()())}var Yt=(()=>{let l=class l{constructor(){this.suppliersService=g(Ee),this.historyService=g(oe),this.dateService=g(se),this.suppliers=[],this.suppliersLoading=this.suppliersService.suppliersLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.subscriptions=new K,this.receiptsHistory=this.historyService.receiptsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({payment_date:new V(null),partner_id:new V(null),payment_number:new V(null)})}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(r=>{this.suppliers=r}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=this.dateService.formatDate(this.searchForm.value.payment_date)),this.historyService.fetchReceiptsHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReceiptsHistory(null)}showInvoiceDialog(r){}printInvoice(r){}openEditDialog(r){this.selectedPayment=r,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(r){this.historyService.fetchReceiptsHistory(this.searchForm.value)}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-receipts-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"input",6),o(),n(8,"div",5),C(9,"p-dropdown",7),o(),n(10,"div",5),C(11,"p-calendar",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,Xn,11,0,"ng-template",12)(17,Zn,14,6,"ng-template",13)(18,eo,3,0,"ng-template",14),o()()()(),n(19,"supplier-payment-dialog",15),d("onClose",function(){return a.hidePaymentDialog()})("onSubmit",function(v){return a.getPaymentDilogResult(v)}),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(5),m("options",a.suppliers)("loading",a.suppliersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0),s(2),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.receiptsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(22,Jn))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),m("visible",a.editDialogVisible)("selected_payment",a.selectedPayment)("accounts",a.suppliers))},dependencies:[X,Y,B,U,Z,ee,W,k,j,O,N,G,z,R,ne,at,F]});let i=l;return i})();var jt=(()=>{let l=class l{constructor(){this.api=g($),this.notificationService=g(A),this.http=g(le),this.dateService=g(se),this.startDate=P(this.dateService.getStartOfMonth()),this.endDate=P(this.dateService.getCurrentDate()),this.loadingTransactions=P(!1),this.cashTransactions=P([])}startDateChanged(){this.startDate.set(this.dateService.formatDate(this.startDate(),"YYYY-MM-DD"))}getCashTransactions(r,e){this.loadingTransactions.set(!0),r=this.dateService.formatDate(r,"YYYY-MM-DD"),e=this.dateService.formatDate(e,"YYYY-MM-DD"),this.http.get(`${this.api.host}/balance/transactions/${r}&${e}`).subscribe({next:a=>{this.cashTransactions.set(a),this.loadingTransactions.set(!1)},error:a=>{this.notificationService.handleError(a.error,"home"),this.loadingTransactions.set(!1)}})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();var to=(i,l)=>({"text-300":i,"text-green-600":l}),io=(i,l)=>({"text-300":i,"text-red-600":l}),no=(i,l,t)=>({"text-red-600":i,"text-green-600":l,"font-bold":t}),oo=(i,l)=>({"text-red-600":i,"text-green-600":l});function ro(i,l){if(i&1){let t=w();n(0,"label",9),p(1,"Start Date:"),o(),n(2,"p-calendar",10),I("ngModelChange",function(e){u(t);let a=c();return T(a.startDate,e)||(a.startDate=e),h(e)}),d("onSelect",function(){u(t);let e=c();return h(e.startDateChanged())}),o()}if(i&2){let t=c();s(2),E("ngModel",t.startDate),m("showIcon",!0)("readonlyInput",!0)("showButtonBar",!0)("required",!0)("iconDisplay","input")}}function ao(i,l){if(i&1){let t=w();n(0,"label",9),p(1,"End Date:"),o(),n(2,"p-calendar",10),I("ngModelChange",function(e){u(t);let a=c();return T(a.endDate,e)||(a.endDate=e),h(e)}),d("onSelect",function(){u(t);let e=c();return h(e.endDateChanged())}),o()}if(i&2){let t=c();s(2),E("ngModel",t.endDate),m("showIcon",!0)("readonlyInput",!0)("showButtonBar",!0)("required",!0)("iconDisplay","input")}}function lo(i,l){if(i&1){let t=w();n(0,"p-button",11),d("onClick",function(){u(t);let e=c();return h(e.selectToday())}),o(),n(1,"p-button",12),d("onClick",function(){u(t);let e=c();return h(e.selectThisMonth())}),o(),n(2,"p-button",13),d("onClick",function(){u(t);let e=c();return h(e.selectThisYear())}),o()}i&2&&(m("size","small"),s(),m("size","small"),s(),m("size","small"))}function so(i,l){i&1&&(n(0,"tr")(1,"th",14),p(2,"Date"),o(),n(3,"th",14),p(4,"Transaction"),o(),n(5,"th",15),p(6,"Description"),o(),n(7,"th",15),p(8,"Debit"),o(),n(9,"th",15),p(10,"Credit"),o(),n(11,"th",15),p(12,"Balance"),o()())}function po(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td",16),p(8),b(9,"currency"),o(),n(10,"td",16),p(11),b(12,"currency"),o(),n(13,"td",16),p(14),b(15,"currency"),o()()),i&2){let t=l.$implicit,r=l.rowIndex,e=c();s(2),S(" ",t.journal_date||"Before "+e.startDate()," "),s(2),f(t.journal_number||"---"),s(2),f(t.journal_description||"---"),s(),m("ngClass",be(15,to,t.debit==0,t.debit!=0)),s(),S(" ",x(9,9,t.debit)," "),s(2),m("ngClass",be(18,io,t.credit==0,t.credit!=0)),s(),S(" ",x(12,11,t.credit)," "),s(2),m("ngClass",gt(21,no,e.balances[r]<0,e.balances[r]>0,e.balances[r]==0)),s(),S(" ",x(15,13,e.balances[r])," ")}}function co(i,l){if(i&1&&(n(0,"tr"),C(1,"td",17),n(2,"td"),p(3,"Balance Due"),o(),n(4,"td",16),p(5),b(6,"currency"),o()()),i&2){let t=c();s(4),m("ngClass",be(4,oo,t.balances[t.balances.length-1]<0,t.balances[t.balances.length-1]>0)),s(),S(" ",x(6,2,t.balances[t.balances.length-1])," ")}}var pt=(()=>{let l=class l{constructor(){this.transactionService=g(jt),this.fb=g(ze),this.dateService=g(se),this.decimalService=g(pe),this.loadingTransactions=this.transactionService.loadingTransactions,this.cashTransactions=this.transactionService.cashTransactions,this.startDate=this.transactionService.startDate,this.endDate=this.transactionService.endDate,this.balances=[],this.submitSearch(),ft(()=>{let r=this.cashTransactions();if(console.log(r),r.length>0){this.balances=[],this.balances[0]=parseFloat(r[0].balance);for(let e=1;e<r.length;e++)this.balances[e]=this.decimalService.add(this.balances[e-1],this.decimalService.subtract(r[e].debit,r[e].credit))}else this.balances=[]})}submitSearch(){this.transactionService.getCashTransactions(this.startDate(),this.endDate())}startDateChanged(){this.transactionService.startDateChanged(),this.submitSearch()}endDateChanged(){this.submitSearch()}selectToday(){this.transactionService.startDate.set(this.dateService.getCurrentDate()),this.transactionService.endDate.set(this.dateService.getCurrentDate()),this.submitSearch()}selectThisMonth(){this.transactionService.startDate.set(this.dateService.getStartOfMonth()),this.transactionService.endDate.set(this.dateService.getEndOfMonth()),this.submitSearch()}selectThisYear(){this.transactionService.startDate.set(this.dateService.getStartOfYear()),this.transactionService.endDate.set(this.dateService.getEndOfYear()),this.submitSearch()}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["cash-transactions"]],standalone:!0,features:[ht],decls:11,vars:2,consts:[[1,"grid","m-1"],[1,"col-12"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["dataKey","account_number","styleClass","p-datatable-sm","scrollHeight","68vh",1,"ledger_table",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"mr-2"],["styleClass","p-inputtext-sm","dateFormat","yy-mm-dd",3,"ngModelChange","onSelect","ngModel","showIcon","readonlyInput","showButtonBar","required","iconDisplay"],["label","Today","severity","secondary",3,"onClick","size"],["styleClass","mx-2","label","This Month","severity","secondary",3,"onClick","size"],["label","This Year","severity","secondary",3,"onClick","size"],["width","20%"],["width","15%"],[3,"ngClass"],["colspan","4"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-toolbar"),y(4,ro,3,6,"ng-template",2)(5,ao,3,6,"ng-template",3)(6,lo,3,3,"ng-template",4),o(),n(7,"p-table",5),y(8,so,13,0,"ng-template",6)(9,po,16,25,"ng-template",7)(10,co,7,7,"ng-template",8),o()()()()),e&2&&(s(7),m("value",a.cashTransactions())("scrollable",!0))},dependencies:[Ae,N,k,tt,Ye,Ke,R,O,Je,W,$e,F,je,qe,B,Le,Se,Re,xe,et,xt]});let i=l;return i})();var Gt=(()=>{let l=class l{};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-cash-history"]],decls:1,vars:0,template:function(e,a){e&1&&C(0,"cash-transactions")},dependencies:[pt]});let i=l;return i})();var _o=()=>[10,25,50],uo=()=>({width:"95vw"});function ho(i,l){i&1&&(n(0,"tr")(1,"th"),p(2,"Invoice #"),o(),n(3,"th"),p(4,"Customer"),o(),n(5,"th"),p(6,"Created at"),o(),n(7,"th"),p(8,"Deleted at"),o(),n(9,"th"),p(10,"Notes"),o(),n(11,"th"),p(12,"Total"),o(),n(13,"th"),p(14,"Options"),o()())}function go(i,l){if(i&1){let t=w();n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),o(),n(9,"td"),p(10),o(),n(11,"td"),p(12),b(13,"currency"),o(),n(14,"td")(15,"p-button",18),d("onClick",function(){let e=u(t).$implicit,a=c();return h(a.showInvoiceDialog(e))}),o()()()}if(i&2){let t=l.$implicit;s(2),f(t.invoice_number),s(2),f(t.customer_name||"---"),s(2),f(t.order_date),s(2),f(t.deleted_at),s(2),f(t.delete_reason||"---"),s(2),f(x(13,6,t.total_amount))}}function fo(i,l){i&1&&(n(0,"tr")(1,"td",19),p(2,"No Records Found!"),o()())}function vo(i,l){i&1&&(n(0,"th",27),p(1," Unit Cost "),o())}function yo(i,l){i&1&&(n(0,"th"),p(1,"Total Cost"),o())}function Co(i,l){if(i&1&&(n(0,"tr")(1,"th",22),p(2,"Barcode"),o(),n(3,"th",23),p(4,"Description"),o(),n(5,"th"),p(6,"Expiry Date"),o(),n(7,"th"),p(8,"Original Price"),o(),n(9,"th"),p(10,"Sold Price"),o(),n(11,"th"),p(12,"Discount %"),o(),n(13,"th",24),p(14,"Qty"),o(),n(15,"th"),p(16,"Total Price"),o(),y(17,vo,2,0,"th",25)(18,yo,2,0,"th",26),o()),i&2){let t=c(3);s(17),m("ngIf",t.userPermissions().show_cost),s(),m("ngIf",t.userPermissions().show_cost)}}function bo(i,l){if(i&1&&(n(0,"td",27),p(1),b(2,"currency"),o()),i&2){let t=c().$implicit;s(),S(" ",x(2,1,t.unit_cost)," ")}}function xo(i,l){if(i&1&&(n(0,"td"),p(1),b(2,"currency"),o()),i&2){let t=c().$implicit;s(),S(" ",x(2,1,t.unit_cost*t.quantity)," ")}}function So(i,l){if(i&1&&(n(0,"tr")(1,"td"),p(2),o(),n(3,"td"),p(4),o(),n(5,"td"),p(6),o(),n(7,"td"),p(8),b(9,"currency"),o(),n(10,"td"),p(11),b(12,"currency"),o(),n(13,"td"),p(14),o(),n(15,"td"),p(16),o(),n(17,"td"),p(18),b(19,"currency"),o(),y(20,bo,3,3,"td",25)(21,xo,3,3,"td",26),o()),i&2){let t=l.$implicit,r=c(3);s(2),f(t.barcode||"---"),s(2),f(t.product_name),s(2),f(t.expiry_date||"---"),s(2),f(x(9,10,t.original_price)),s(3),S(" ",x(12,12,t.unit_price)," "),s(3),S("",t.discount_percentage,"%"),s(2),f(t.quantity),s(2),S(" ",x(19,14,t.total_price)," "),s(2),m("ngIf",r.userPermissions().show_cost),s(),m("ngIf",r.userPermissions().show_cost)}}function wo(i,l){i&1&&C(0,"td",27)}function Eo(i,l){if(i&1&&(n(0,"td"),p(1),b(2,"currency"),o()),i&2){let t=c(4);s(),S(" ",x(2,1,t.selectedInvoiceTotals.totalCost)," ")}}function To(i,l){if(i&1&&(n(0,"tr"),C(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td"),n(7,"td"),p(8),o(),n(9,"td"),p(10),b(11,"currency"),o(),y(12,wo,1,0,"td",25)(13,Eo,3,3,"td",26),o()),i&2){let t=c(3);s(8),f(t.selectedInvoiceTotals.totalQty),s(2),S(" ",x(11,4,t.selectedInvoiceTotals.totalPrice)," "),s(2),m("ngIf",t.userPermissions().show_cost),s(),m("ngIf",t.userPermissions().show_cost)}}function Io(i,l){if(i&1&&(n(0,"p-table",21),y(1,Co,19,2,"ng-template",12)(2,So,22,16,"ng-template",13)(3,To,14,6,"ng-template",17),o()),i&2){let t=c(2);m("value",t.invoiceItems)}}function Do(i,l){if(i&1&&y(0,Io,4,1,"p-table",20),i&2){let t=c();m("ngIf",t.invoiceItems.length!=0)}}function Po(i,l){if(i&1){let t=w();n(0,"button",28),d("click",function(){u(t);let e=c();return h(e.hideInvoiceDialog())}),o()}}var Kt=(()=>{let l=class l{constructor(){this.customerService=g(ie),this.historyService=g(oe),this.decimalService=g(pe),this.printService=g(Te),this.authService=g(ce),this.whatsappService=g(lt),this.dateService=g(se),this.userPermissions=this.authService.userPermissions,this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.deletedHistory=this.historyService.deletedHistory,this.loading=this.historyService.signal_loading,this.searchForm=new J({invoice_number:new V(null),customer_id:new V(null),invoice_date:new V(null)})}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=this.dateService.formatDate(this.searchForm.value.invoice_date,"YYYY-MM-DD")),this.historyService.fetchDeletedHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchDeletedHistory(null)}showInvoiceDialog(r){this.invoiceItems=r.items,this.invoiceItems.forEach(e=>{this.selectedInvoiceTotals.totalQty+=e.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,e.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,e.unit_cost*e.quantity)}),this.detailsDialogVisible=!0}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=H({type:l,selectors:[["app-delete-history"]],decls:22,vars:27,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["size","small","severity","info","icon","fas fa-eye",3,"onClick"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","15%"],["width","30%"],["width","5%"],["style","border-left: 1px #e5e7eb solid",4,"ngIf"],[4,"ngIf"],[2,"border-left","1px #e5e7eb solid"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return a.submitSearch()}),n(5,"div",4)(6,"div",5),C(7,"input",6),o(),n(8,"div",5),C(9,"p-dropdown",7),o(),n(10,"div",5),C(11,"p-calendar",8),o(),n(12,"div",5),C(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return a.resetSearch()}),o()()()()(),n(15,"p-table",11),y(16,ho,15,0,"ng-template",12)(17,go,16,8,"ng-template",13)(18,fo,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),I("visibleChange",function(v){return T(a.detailsDialogVisible,v)||(a.detailsDialogVisible=v),v}),d("onHide",function(){return a.hideInvoiceDialog()}),y(20,Do,1,1,"ng-template",16)(21,Po,1,0,"ng-template",17),o()),e&2&&(s(3),m("toggleable",!0),s(),m("formGroup",a.searchForm),s(5),m("options",a.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),s(2),m("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),s(2),m("loading",a.loading()),s(),m("disabled",a.loading()),s(),m("value",a.deletedHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",D(25,_o))("alwaysShowPaginator",!1)("loading",a.loading()),s(4),L(D(26,uo)),E("visible",a.detailsDialogVisible),m("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[Q,X,Y,B,U,Z,ee,W,k,j,O,N,te,G,z,R,ne,F]});let i=l;return i})();var Vo=[{path:"sales-history",data:{breadcrumb:"sales"},component:Bt},{path:"payment-history",data:{breadcrumb:"payments"},component:Ot},{path:"return-history",data:{breadcrumb:"returns"},component:Wt},{path:"purchases-history",data:{breadcrumb:"purchases"},component:$t},{path:"receipts-history",data:{breadcrumb:"receipts"},component:Yt},{path:"cash-history",data:{breadcrumb:"Cash"},component:Gt,canActivate:[_t]},{path:"deleted-history",data:{breadcrumb:"deleted invoices"},component:Kt,canActivate:[_t]}],Qt=(()=>{let l=class l{};l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=ke({type:l}),l.\u0275inj=Fe({imports:[dt.forChild(Vo),dt]});let i=l;return i})();var rs=(()=>{let l=class l{};l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=ke({type:l}),l.\u0275inj=Fe({imports:[Re,Qt,qe,vt,we,Je,$e,Ae,yt,Ye,et,je,Ke,tt,Dt,Ct,Pt,Tt,St,Ze,at,pt]});let i=l;return i})();export{rs as HistoryModule};
