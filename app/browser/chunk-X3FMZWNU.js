import{a as kt}from"./chunk-OA6YC3PP.js";import{a as Nt}from"./chunk-SKYJA6BO.js";import{a as Et,b as _i,c as hi}from"./chunk-XVTJG4C3.js";import{a as Dt,c as gi}from"./chunk-OOYENC3R.js";import{a as je}from"./chunk-6SPTK7QA.js";import{a as Tt,b as fi,d as ze}from"./chunk-UN4TYE34.js";import{b as vi,d as yi}from"./chunk-OQ73NTVM.js";import{a as Pt}from"./chunk-DKBJHHEA.js";import{a as It}from"./chunk-GLAC23CS.js";import{a as Ue}from"./chunk-OUZXLSMN.js";import"./chunk-5Y4A7MAH.js";import{a as Ht}from"./chunk-THLQUWZR.js";import{a as Pe,b as di}from"./chunk-JRHKHFDF.js";import{a as Re}from"./chunk-BDP5IQ5Z.js";import{a as Ct}from"./chunk-7OIYUPV4.js";import{a as st}from"./chunk-HUT5LNQK.js";import"./chunk-6M5CHABF.js";import{a as wt,b as ci,d as ae,i as St,j as xt,o as pi}from"./chunk-YXGZ3Y4J.js";import{b as si}from"./chunk-KWHJ4U2D.js";import"./chunk-PTV2L6W6.js";import{b as mi}from"./chunk-I3ZYYSXS.js";import{c as se,d as li,i as le,j as ai}from"./chunk-6CJYKBUA.js";import{a as Te,b as ui}from"./chunk-KTNSRC6L.js";import"./chunk-VVJEHS3M.js";import{a as ne,b as ni}from"./chunk-2WM322QF.js";import"./chunk-THDET7PA.js";import{$b as z,A as S,Ab as Gt,B as J,Bb as Be,C as _t,Da as _,Ea as T,Fa as L,G as ht,Gb as yt,H as C,Ha as A,I as w,Ia as $,Ja as U,M as $e,Ma as j,Na as Me,Oa as gt,Pb as te,Sb as ue,Ub as be,V as d,Va as M,Wa as V,Yb as ie,Zb as Ce,_b as we,aa as W,ac as bt,bc as Se,cc as xe,da as N,db as vt,dc as Ee,fa as v,fb as ye,g as rt,gc as ti,hc as ii,i as me,ia as ve,ib as ee,jb as ei,l as Ae,la as a,lb as Fe,ma as c,na as H,qc as oe,ra as F,rc as re,sa as b,sc as oi,ta as y,tc as Ie,uc as ri,w as ge,wa as ft,x as dt}from"./chunk-FYHOXPUP.js";var De=(()=>{let o=class o{constructor(){this.http=S(Fe),this.apiService=S(Be),this.notificationService=S(ue),this.salesHistory=W([]),this.paymentsHistory=W([]),this.signal_loading=W(!1),this.moneyTransfersHistory=W([]),this.returnHistory=W([]),this.receiptsHistory=W([]),this.purchasesHistory=W([])}fetchSalesHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/sales/search`,t).subscribe({next:n=>{this.salesHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}fetchPaymentHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/payment/search`,t).subscribe({next:n=>{this.paymentsHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}fetchMoneyTransferHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/money-transfer/search`,t).subscribe({next:n=>{this.moneyTransfersHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}fetchReturnHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/return/search`,t).subscribe({next:n=>{this.returnHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}fetchPurchasesHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/purchase/search`,t).subscribe({next:n=>{this.purchasesHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}fetchReceiptsHistory(t){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/receipt/search`,t).subscribe({next:n=>{this.receiptsHistory.set(n),this.signal_loading.set(!1)},error:n=>{this.signal_loading.set(!1),this.notificationService.handleError(n.error,"home")}})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Ge=9e15,We=1e9,Yt="0123456789abcdef",Vt="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ft="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Zt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ge,maxE:Ge,crypto:!1},Si,Ve,P=!0,Rt="[DecimalError] ",qe=Rt+"Invalid argument: ",xi=Rt+"Precision limit exceeded",Ei=Rt+"crypto unavailable",Ii="[object Decimal]",K=Math.floor,G=Math.pow,Xi=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ji=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,en=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ti=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe=1e7,I=7,tn=9007199254740991,nn=Vt.length-1,Qt=Ft.length-1,g={toStringTag:Ii};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),x(e)};g.ceil=function(){return x(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,o){var i,t=this,n=t.constructor;if(e=new n(e),o=new n(o),!e.s||!o.s)return new n(NaN);if(e.gt(o))throw Error(qe+o);return i=t.cmp(e),i<0?e:t.cmp(o)>0?o:new n(t)};g.comparedTo=g.cmp=function(e){var o,i,t,n,r=this,s=r.d,l=(e=new r.constructor(e)).d,m=r.s,p=e.s;if(!s||!l)return!m||!p?NaN:m!==p?m:s===l?0:!s^m<0?1:-1;if(!s[0]||!l[0])return s[0]?m:l[0]?-p:0;if(m!==p)return m;if(r.e!==e.e)return r.e>e.e^m<0?1:-1;for(t=s.length,n=l.length,o=0,i=t<n?t:n;o<i;++o)if(s[o]!==l[o])return s[o]>l[o]^m<0?1:-1;return t===n?0:t>n^m<0?1:-1};g.cosine=g.cos=function(){var e,o,i=this,t=i.constructor;return i.d?i.d[0]?(e=t.precision,o=t.rounding,t.precision=e+Math.max(i.e,i.sd())+I,t.rounding=1,i=on(t,ki(t,i)),t.precision=e,t.rounding=o,x(Ve==2||Ve==3?i.neg():i,e,o,!0)):new t(1):new t(NaN)};g.cubeRoot=g.cbrt=function(){var e,o,i,t,n,r,s,l,m,p,u=this,h=u.constructor;if(!u.isFinite()||u.isZero())return new h(u);for(P=!1,r=u.s*G(u.s*u,1/3),!r||Math.abs(r)==1/0?(i=Y(u.d),e=u.e,(r=(e-i.length+1)%3)&&(i+=r==1||r==-2?"0":"00"),r=G(i,1/3),e=K((e+1)/3)-(e%3==(e<0?-1:2)),r==1/0?i="5e"+e:(i=r.toExponential(),i=i.slice(0,i.indexOf("e")+1)+e),t=new h(i),t.s=u.s):t=new h(r.toString()),s=(e=h.precision)+3;;)if(l=t,m=l.times(l).times(l),p=m.plus(u),t=R(p.plus(u).times(l),p.plus(m),s+2,1),Y(l.d).slice(0,s)===(i=Y(t.d)).slice(0,s))if(i=i.slice(s-3,s+1),i=="9999"||!n&&i=="4999"){if(!n&&(x(l,e+1,0),l.times(l).times(l).eq(u))){t=l;break}s+=4,n=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(x(t,e+1,1),o=!t.times(t).times(t).eq(u));break}return P=!0,x(t,e,h.rounding,o)};g.decimalPlaces=g.dp=function(){var e,o=this.d,i=NaN;if(o){if(e=o.length-1,i=(e-K(this.e/I))*I,e=o[e],e)for(;e%10==0;e/=10)i--;i<0&&(i=0)}return i};g.dividedBy=g.div=function(e){return R(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var o=this,i=o.constructor;return x(R(o,new i(e),0,1,1),i.precision,i.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return x(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var o=this.cmp(e);return o==1||o===0};g.hyperbolicCosine=g.cosh=function(){var e,o,i,t,n,r=this,s=r.constructor,l=new s(1);if(!r.isFinite())return new s(r.s?1/0:NaN);if(r.isZero())return l;i=s.precision,t=s.rounding,s.precision=i+Math.max(r.e,r.sd())+4,s.rounding=1,n=r.d.length,n<32?(e=Math.ceil(n/3),o=(1/Lt(4,e)).toString()):(e=16,o="2.3283064365386962890625e-10"),r=Ye(s,1,r.times(o),new s(1),!0);for(var m,p=e,u=new s(8);p--;)m=r.times(r),r=l.minus(m.times(u.minus(m.times(u))));return x(r,s.precision=i,s.rounding=t,!0)};g.hyperbolicSine=g.sinh=function(){var e,o,i,t,n=this,r=n.constructor;if(!n.isFinite()||n.isZero())return new r(n);if(o=r.precision,i=r.rounding,r.precision=o+Math.max(n.e,n.sd())+4,r.rounding=1,t=n.d.length,t<3)n=Ye(r,2,n,n,!0);else{e=1.4*Math.sqrt(t),e=e>16?16:e|0,n=n.times(1/Lt(5,e)),n=Ye(r,2,n,n,!0);for(var s,l=new r(5),m=new r(16),p=new r(20);e--;)s=n.times(n),n=n.times(l.plus(s.times(m.times(s).plus(p))))}return r.precision=o,r.rounding=i,x(n,o,i,!0)};g.hyperbolicTangent=g.tanh=function(){var e,o,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(e=t.precision,o=t.rounding,t.precision=e+7,t.rounding=1,R(i.sinh(),i.cosh(),t.precision=e,t.rounding=o)):new t(i.s)};g.inverseCosine=g.acos=function(){var e,o=this,i=o.constructor,t=o.abs().cmp(1),n=i.precision,r=i.rounding;return t!==-1?t===0?o.isNeg()?he(i,n,r):new i(0):new i(NaN):o.isZero()?he(i,n+4,r).times(.5):(i.precision=n+6,i.rounding=1,o=o.asin(),e=he(i,n+4,r).times(.5),i.precision=n,i.rounding=r,e.minus(o))};g.inverseHyperbolicCosine=g.acosh=function(){var e,o,i=this,t=i.constructor;return i.lte(1)?new t(i.eq(1)?0:NaN):i.isFinite()?(e=t.precision,o=t.rounding,t.precision=e+Math.max(Math.abs(i.e),i.sd())+4,t.rounding=1,P=!1,i=i.times(i).minus(1).sqrt().plus(i),P=!0,t.precision=e,t.rounding=o,i.ln()):new t(i)};g.inverseHyperbolicSine=g.asinh=function(){var e,o,i=this,t=i.constructor;return!i.isFinite()||i.isZero()?new t(i):(e=t.precision,o=t.rounding,t.precision=e+2*Math.max(Math.abs(i.e),i.sd())+6,t.rounding=1,P=!1,i=i.times(i).plus(1).sqrt().plus(i),P=!0,t.precision=e,t.rounding=o,i.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,o,i,t,n=this,r=n.constructor;return n.isFinite()?n.e>=0?new r(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(e=r.precision,o=r.rounding,t=n.sd(),Math.max(t,e)<2*-n.e-1?x(new r(n),e,o,!0):(r.precision=i=t-n.e,n=R(n.plus(1),new r(1).minus(n),i+e,1),r.precision=e+4,r.rounding=1,n=n.ln(),r.precision=e,r.rounding=o,n.times(.5))):new r(NaN)};g.inverseSine=g.asin=function(){var e,o,i,t,n=this,r=n.constructor;return n.isZero()?new r(n):(o=n.abs().cmp(1),i=r.precision,t=r.rounding,o!==-1?o===0?(e=he(r,i+4,t).times(.5),e.s=n.s,e):new r(NaN):(r.precision=i+6,r.rounding=1,n=n.div(new r(1).minus(n.times(n)).sqrt().plus(1)).atan(),r.precision=i,r.rounding=t,n.times(2)))};g.inverseTangent=g.atan=function(){var e,o,i,t,n,r,s,l,m,p=this,u=p.constructor,h=u.precision,f=u.rounding;if(p.isFinite()){if(p.isZero())return new u(p);if(p.abs().eq(1)&&h+4<=Qt)return s=he(u,h+4,f).times(.25),s.s=p.s,s}else{if(!p.s)return new u(NaN);if(h+4<=Qt)return s=he(u,h+4,f).times(.5),s.s=p.s,s}for(u.precision=l=h+10,u.rounding=1,i=Math.min(28,l/I+2|0),e=i;e;--e)p=p.div(p.times(p).plus(1).sqrt().plus(1));for(P=!1,o=Math.ceil(l/I),t=1,m=p.times(p),s=new u(p),n=p;e!==-1;)if(n=n.times(m),r=s.minus(n.div(t+=2)),n=n.times(m),s=r.plus(n.div(t+=2)),s.d[o]!==void 0)for(e=o;s.d[e]===r.d[e]&&e--;);return i&&(s=s.times(2<<i-1)),P=!0,x(s,u.precision=h,u.rounding=f,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&K(this.e/I)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var o,i,t,n,r,s,l,m,p=this,u=p.constructor,h=u.precision,f=u.rounding,E=5;if(e==null)e=new u(10),o=!0;else{if(e=new u(e),i=e.d,e.s<0||!i||!i[0]||e.eq(1))return new u(NaN);o=e.eq(10)}if(i=p.d,p.s<0||!i||!i[0]||p.eq(1))return new u(i&&!i[0]?-1/0:p.s!=1?NaN:i?0:1/0);if(o)if(i.length>1)r=!0;else{for(n=i[0];n%10===0;)n/=10;r=n!==1}if(P=!1,l=h+E,s=Le(p,l),t=o?Bt(u,l+10):Le(e,l),m=R(s,t,l,1),lt(m.d,n=h,f))do if(l+=10,s=Le(p,l),t=o?Bt(u,l+10):Le(e,l),m=R(s,t,l,1),!r){+Y(m.d).slice(n+1,n+15)+1==1e14&&(m=x(m,h+1,0));break}while(lt(m.d,n+=10,f));return P=!0,x(m,h,f)};g.minus=g.sub=function(e){var o,i,t,n,r,s,l,m,p,u,h,f,E=this,k=E.constructor;if(e=new k(e),!E.d||!e.d)return!E.s||!e.s?e=new k(NaN):E.d?e.s=-e.s:e=new k(e.d||E.s!==e.s?E:NaN),e;if(E.s!=e.s)return e.s=-e.s,E.plus(e);if(p=E.d,f=e.d,l=k.precision,m=k.rounding,!p[0]||!f[0]){if(f[0])e.s=-e.s;else if(p[0])e=new k(E);else return new k(m===3?-0:0);return P?x(e,l,m):e}if(i=K(e.e/I),u=K(E.e/I),p=p.slice(),r=u-i,r){for(h=r<0,h?(o=p,r=-r,s=f.length):(o=f,i=u,s=p.length),t=Math.max(Math.ceil(l/I),s)+2,r>t&&(r=t,o.length=1),o.reverse(),t=r;t--;)o.push(0);o.reverse()}else{for(t=p.length,s=f.length,h=t<s,h&&(s=t),t=0;t<s;t++)if(p[t]!=f[t]){h=p[t]<f[t];break}r=0}for(h&&(o=p,p=f,f=o,e.s=-e.s),s=p.length,t=f.length-s;t>0;--t)p[s++]=0;for(t=f.length;t>r;){if(p[--t]<f[t]){for(n=t;n&&p[--n]===0;)p[n]=fe-1;--p[n],p[t]+=fe}p[t]-=f[t]}for(;p[--s]===0;)p.pop();for(;p[0]===0;p.shift())--i;return p[0]?(e.d=p,e.e=Ot(p,i),P?x(e,l,m):e):new k(m===3?-0:0)};g.modulo=g.mod=function(e){var o,i=this,t=i.constructor;return e=new t(e),!i.d||!e.s||e.d&&!e.d[0]?new t(NaN):!e.d||i.d&&!i.d[0]?x(new t(i),t.precision,t.rounding):(P=!1,t.modulo==9?(o=R(i,e.abs(),0,3,1),o.s*=e.s):o=R(i,e,0,t.modulo,1),o=o.times(e),P=!0,i.minus(o))};g.naturalExponential=g.exp=function(){return Kt(this)};g.naturalLogarithm=g.ln=function(){return Le(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,x(e)};g.plus=g.add=function(e){var o,i,t,n,r,s,l,m,p,u,h=this,f=h.constructor;if(e=new f(e),!h.d||!e.d)return!h.s||!e.s?e=new f(NaN):h.d||(e=new f(e.d||h.s===e.s?h:NaN)),e;if(h.s!=e.s)return e.s=-e.s,h.minus(e);if(p=h.d,u=e.d,l=f.precision,m=f.rounding,!p[0]||!u[0])return u[0]||(e=new f(h)),P?x(e,l,m):e;if(r=K(h.e/I),t=K(e.e/I),p=p.slice(),n=r-t,n){for(n<0?(i=p,n=-n,s=u.length):(i=u,t=r,s=p.length),r=Math.ceil(l/I),s=r>s?r+1:s+1,n>s&&(n=s,i.length=1),i.reverse();n--;)i.push(0);i.reverse()}for(s=p.length,n=u.length,s-n<0&&(n=s,i=u,u=p,p=i),o=0;n;)o=(p[--n]=p[n]+u[n]+o)/fe|0,p[n]%=fe;for(o&&(p.unshift(o),++t),s=p.length;p[--s]==0;)p.pop();return e.d=p,e.e=Ot(p,t),P?x(e,l,m):e};g.precision=g.sd=function(e){var o,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(qe+e);return i.d?(o=Pi(i.d),e&&i.e+1>o&&(o=i.e+1)):o=NaN,o};g.round=function(){var e=this,o=e.constructor;return x(new o(e),e.e+1,o.rounding)};g.sine=g.sin=function(){var e,o,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(e=t.precision,o=t.rounding,t.precision=e+Math.max(i.e,i.sd())+I,t.rounding=1,i=sn(t,ki(t,i)),t.precision=e,t.rounding=o,x(Ve>2?i.neg():i,e,o,!0)):new t(NaN)};g.squareRoot=g.sqrt=function(){var e,o,i,t,n,r,s=this,l=s.d,m=s.e,p=s.s,u=s.constructor;if(p!==1||!l||!l[0])return new u(!p||p<0&&(!l||l[0])?NaN:l?s:1/0);for(P=!1,p=Math.sqrt(+s),p==0||p==1/0?(o=Y(l),(o.length+m)%2==0&&(o+="0"),p=Math.sqrt(o),m=K((m+1)/2)-(m<0||m%2),p==1/0?o="5e"+m:(o=p.toExponential(),o=o.slice(0,o.indexOf("e")+1)+m),t=new u(o)):t=new u(p.toString()),i=(m=u.precision)+3;;)if(r=t,t=r.plus(R(s,r,i+2,1)).times(.5),Y(r.d).slice(0,i)===(o=Y(t.d)).slice(0,i))if(o=o.slice(i-3,i+1),o=="9999"||!n&&o=="4999"){if(!n&&(x(r,m+1,0),r.times(r).eq(s))){t=r;break}i+=4,n=1}else{(!+o||!+o.slice(1)&&o.charAt(0)=="5")&&(x(t,m+1,1),e=!t.times(t).eq(s));break}return P=!0,x(t,m,u.rounding,e)};g.tangent=g.tan=function(){var e,o,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(e=t.precision,o=t.rounding,t.precision=e+10,t.rounding=1,i=i.sin(),i.s=1,i=R(i,new t(1).minus(i.times(i)).sqrt(),e+10,0),t.precision=e,t.rounding=o,x(Ve==2||Ve==4?i.neg():i,e,o,!0)):new t(NaN)};g.times=g.mul=function(e){var o,i,t,n,r,s,l,m,p,u=this,h=u.constructor,f=u.d,E=(e=new h(e)).d;if(e.s*=u.s,!f||!f[0]||!E||!E[0])return new h(!e.s||f&&!f[0]&&!E||E&&!E[0]&&!f?NaN:!f||!E?e.s/0:e.s*0);for(i=K(u.e/I)+K(e.e/I),m=f.length,p=E.length,m<p&&(r=f,f=E,E=r,s=m,m=p,p=s),r=[],s=m+p,t=s;t--;)r.push(0);for(t=p;--t>=0;){for(o=0,n=m+t;n>t;)l=r[n]+E[t]*f[n-t-1]+o,r[n--]=l%fe|0,o=l/fe|0;r[n]=(r[n]+o)%fe|0}for(;!r[--s];)r.pop();return o?++i:r.shift(),e.d=r,e.e=Ot(r,i),P?x(e,h.precision,h.rounding):e};g.toBinary=function(e,o){return Jt(this,2,e,o)};g.toDecimalPlaces=g.toDP=function(e,o){var i=this,t=i.constructor;return i=new t(i),e===void 0?i:(ce(e,0,We),o===void 0?o=t.rounding:ce(o,0,8),x(i,e+i.e+1,o))};g.toExponential=function(e,o){var i,t=this,n=t.constructor;return e===void 0?i=Ne(t,!0):(ce(e,0,We),o===void 0?o=n.rounding:ce(o,0,8),t=x(new n(t),e+1,o),i=Ne(t,!0,e+1)),t.isNeg()&&!t.isZero()?"-"+i:i};g.toFixed=function(e,o){var i,t,n=this,r=n.constructor;return e===void 0?i=Ne(n):(ce(e,0,We),o===void 0?o=r.rounding:ce(o,0,8),t=x(new r(n),e+n.e+1,o),i=Ne(t,!1,e+t.e+1)),n.isNeg()&&!n.isZero()?"-"+i:i};g.toFraction=function(e){var o,i,t,n,r,s,l,m,p,u,h,f,E=this,k=E.d,D=E.constructor;if(!k)return new D(E);if(p=i=new D(1),t=m=new D(0),o=new D(t),r=o.e=Pi(k)-E.e-1,s=r%I,o.d[0]=G(10,s<0?I+s:s),e==null)e=r>0?o:p;else{if(l=new D(e),!l.isInt()||l.lt(p))throw Error(qe+l);e=l.gt(o)?r>0?o:p:l}for(P=!1,l=new D(Y(k)),u=D.precision,D.precision=r=k.length*I*2;h=R(l,o,0,1,1),n=i.plus(h.times(t)),n.cmp(e)!=1;)i=t,t=n,n=p,p=m.plus(h.times(n)),m=n,n=o,o=l.minus(h.times(n)),l=n;return n=R(e.minus(i),t,0,1,1),m=m.plus(n.times(p)),i=i.plus(n.times(t)),m.s=p.s=E.s,f=R(p,t,r,1).minus(E).abs().cmp(R(m,i,r,1).minus(E).abs())<1?[p,t]:[m,i],D.precision=u,P=!0,f};g.toHexadecimal=g.toHex=function(e,o){return Jt(this,16,e,o)};g.toNearest=function(e,o){var i=this,t=i.constructor;if(i=new t(i),e==null){if(!i.d)return i;e=new t(1),o=t.rounding}else{if(e=new t(e),o===void 0?o=t.rounding:ce(o,0,8),!i.d)return e.s?i:e;if(!e.d)return e.s&&(e.s=i.s),e}return e.d[0]?(P=!1,i=R(i,e,0,o,1).times(e),P=!0,x(i)):(e.s=i.s,i=e),i};g.toNumber=function(){return+this};g.toOctal=function(e,o){return Jt(this,8,e,o)};g.toPower=g.pow=function(e){var o,i,t,n,r,s,l=this,m=l.constructor,p=+(e=new m(e));if(!l.d||!e.d||!l.d[0]||!e.d[0])return new m(G(+l,p));if(l=new m(l),l.eq(1))return l;if(t=m.precision,r=m.rounding,e.eq(1))return x(l,t,r);if(o=K(e.e/I),o>=e.d.length-1&&(i=p<0?-p:p)<=tn)return n=Di(m,l,i,t),e.s<0?new m(1).div(n):x(n,t,r);if(s=l.s,s<0){if(o<e.d.length-1)return new m(NaN);if(e.d[o]&1||(s=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=s,l}return i=G(+l,p),o=i==0||!isFinite(i)?K(p*(Math.log("0."+Y(l.d))/Math.LN10+l.e+1)):new m(i+"").e,o>m.maxE+1||o<m.minE-1?new m(o>0?s/0:0):(P=!1,m.rounding=l.s=1,i=Math.min(12,(o+"").length),n=Kt(e.times(Le(l,t+i)),t),n.d&&(n=x(n,t+5,1),lt(n.d,t,r)&&(o=t+10,n=x(Kt(e.times(Le(l,o+i)),o),o+5,1),+Y(n.d).slice(t+1,t+15)+1==1e14&&(n=x(n,t+1,0)))),n.s=s,P=!0,m.rounding=r,x(n,t,r))};g.toPrecision=function(e,o){var i,t=this,n=t.constructor;return e===void 0?i=Ne(t,t.e<=n.toExpNeg||t.e>=n.toExpPos):(ce(e,1,We),o===void 0?o=n.rounding:ce(o,0,8),t=x(new n(t),e,o),i=Ne(t,e<=t.e||t.e<=n.toExpNeg,e)),t.isNeg()&&!t.isZero()?"-"+i:i};g.toSignificantDigits=g.toSD=function(e,o){var i=this,t=i.constructor;return e===void 0?(e=t.precision,o=t.rounding):(ce(e,1,We),o===void 0?o=t.rounding:ce(o,0,8)),x(new t(i),e,o)};g.toString=function(){var e=this,o=e.constructor,i=Ne(e,e.e<=o.toExpNeg||e.e>=o.toExpPos);return e.isNeg()&&!e.isZero()?"-"+i:i};g.truncated=g.trunc=function(){return x(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,o=e.constructor,i=Ne(e,e.e<=o.toExpNeg||e.e>=o.toExpPos);return e.isNeg()?"-"+i:i};function Y(e){var o,i,t,n=e.length-1,r="",s=e[0];if(n>0){for(r+=s,o=1;o<n;o++)t=e[o]+"",i=I-t.length,i&&(r+=Oe(i)),r+=t;s=e[o],t=s+"",i=I-t.length,i&&(r+=Oe(i))}else if(s===0)return"0";for(;s%10===0;)s/=10;return r+s}function ce(e,o,i){if(e!==~~e||e<o||e>i)throw Error(qe+e)}function lt(e,o,i,t){var n,r,s,l;for(r=e[0];r>=10;r/=10)--o;return--o<0?(o+=I,n=0):(n=Math.ceil((o+1)/I),o%=I),r=G(10,I-o),l=e[n]%r|0,t==null?o<3?(o==0?l=l/100|0:o==1&&(l=l/10|0),s=i<4&&l==99999||i>3&&l==49999||l==5e4||l==0):s=(i<4&&l+1==r||i>3&&l+1==r/2)&&(e[n+1]/r/100|0)==G(10,o-2)-1||(l==r/2||l==0)&&(e[n+1]/r/100|0)==0:o<4?(o==0?l=l/1e3|0:o==1?l=l/100|0:o==2&&(l=l/10|0),s=(t||i<4)&&l==9999||!t&&i>3&&l==4999):s=((t||i<4)&&l+1==r||!t&&i>3&&l+1==r/2)&&(e[n+1]/r/1e3|0)==G(10,o-3)-1,s}function Mt(e,o,i){for(var t,n=[0],r,s=0,l=e.length;s<l;){for(r=n.length;r--;)n[r]*=o;for(n[0]+=Yt.indexOf(e.charAt(s++)),t=0;t<n.length;t++)n[t]>i-1&&(n[t+1]===void 0&&(n[t+1]=0),n[t+1]+=n[t]/i|0,n[t]%=i)}return n.reverse()}function on(e,o){var i,t,n;if(o.isZero())return o;t=o.d.length,t<32?(i=Math.ceil(t/3),n=(1/Lt(4,i)).toString()):(i=16,n="2.3283064365386962890625e-10"),e.precision+=i,o=Ye(e,1,o.times(n),new e(1));for(var r=i;r--;){var s=o.times(o);o=s.times(s).minus(s).times(8).plus(1)}return e.precision-=i,o}var R=function(){function e(t,n,r){var s,l=0,m=t.length;for(t=t.slice();m--;)s=t[m]*n+l,t[m]=s%r|0,l=s/r|0;return l&&t.unshift(l),t}function o(t,n,r,s){var l,m;if(r!=s)m=r>s?1:-1;else for(l=m=0;l<r;l++)if(t[l]!=n[l]){m=t[l]>n[l]?1:-1;break}return m}function i(t,n,r,s){for(var l=0;r--;)t[r]-=l,l=t[r]<n[r]?1:0,t[r]=l*s+t[r]-n[r];for(;!t[0]&&t.length>1;)t.shift()}return function(t,n,r,s,l,m){var p,u,h,f,E,k,D,X,q,de,B,Z,ct,ke,Ut,pt,ot,zt,_e,mt,ut=t.constructor,jt=t.s==n.s?1:-1,Q=t.d,O=n.d;if(!Q||!Q[0]||!O||!O[0])return new ut(!t.s||!n.s||(Q?O&&Q[0]==O[0]:!O)?NaN:Q&&Q[0]==0||!O?jt*0:jt/0);for(m?(E=1,u=t.e-n.e):(m=fe,E=I,u=K(t.e/E)-K(n.e/E)),_e=O.length,ot=Q.length,q=new ut(jt),de=q.d=[],h=0;O[h]==(Q[h]||0);h++);if(O[h]>(Q[h]||0)&&u--,r==null?(ke=r=ut.precision,s=ut.rounding):l?ke=r+(t.e-n.e)+1:ke=r,ke<0)de.push(1),k=!0;else{if(ke=ke/E+2|0,h=0,_e==1){for(f=0,O=O[0],ke++;(h<ot||f)&&ke--;h++)Ut=f*m+(Q[h]||0),de[h]=Ut/O|0,f=Ut%O|0;k=f||h<ot}else{for(f=m/(O[0]+1)|0,f>1&&(O=e(O,f,m),Q=e(Q,f,m),_e=O.length,ot=Q.length),pt=_e,B=Q.slice(0,_e),Z=B.length;Z<_e;)B[Z++]=0;mt=O.slice(),mt.unshift(0),zt=O[0],O[1]>=m/2&&++zt;do f=0,p=o(O,B,_e,Z),p<0?(ct=B[0],_e!=Z&&(ct=ct*m+(B[1]||0)),f=ct/zt|0,f>1?(f>=m&&(f=m-1),D=e(O,f,m),X=D.length,Z=B.length,p=o(D,B,X,Z),p==1&&(f--,i(D,_e<X?mt:O,X,m))):(f==0&&(p=f=1),D=O.slice()),X=D.length,X<Z&&D.unshift(0),i(B,D,Z,m),p==-1&&(Z=B.length,p=o(O,B,_e,Z),p<1&&(f++,i(B,_e<Z?mt:O,Z,m))),Z=B.length):p===0&&(f++,B=[0]),de[h++]=f,p&&B[0]?B[Z++]=Q[pt]||0:(B=[Q[pt]],Z=1);while((pt++<ot||B[0]!==void 0)&&ke--);k=B[0]!==void 0}de[0]||de.shift()}if(E==1)q.e=u,Si=k;else{for(h=1,f=de[0];f>=10;f/=10)h++;q.e=h+u*E-1,x(q,l?r+q.e+1:r,s,k)}return q}}();function x(e,o,i,t){var n,r,s,l,m,p,u,h,f,E=e.constructor;e:if(o!=null){if(h=e.d,!h)return e;for(n=1,l=h[0];l>=10;l/=10)n++;if(r=o-n,r<0)r+=I,s=o,u=h[f=0],m=u/G(10,n-s-1)%10|0;else if(f=Math.ceil((r+1)/I),l=h.length,f>=l)if(t){for(;l++<=f;)h.push(0);u=m=0,n=1,r%=I,s=r-I+1}else break e;else{for(u=l=h[f],n=1;l>=10;l/=10)n++;r%=I,s=r-I+n,m=s<0?0:u/G(10,n-s-1)%10|0}if(t=t||o<0||h[f+1]!==void 0||(s<0?u:u%G(10,n-s-1)),p=i<4?(m||t)&&(i==0||i==(e.s<0?3:2)):m>5||m==5&&(i==4||t||i==6&&(r>0?s>0?u/G(10,n-s):0:h[f-1])%10&1||i==(e.s<0?8:7)),o<1||!h[0])return h.length=0,p?(o-=e.e+1,h[0]=G(10,(I-o%I)%I),e.e=-o||0):h[0]=e.e=0,e;if(r==0?(h.length=f,l=1,f--):(h.length=f+1,l=G(10,I-r),h[f]=s>0?(u/G(10,n-s)%G(10,s)|0)*l:0),p)for(;;)if(f==0){for(r=1,s=h[0];s>=10;s/=10)r++;for(s=h[0]+=l,l=1;s>=10;s/=10)l++;r!=l&&(e.e++,h[0]==fe&&(h[0]=1));break}else{if(h[f]+=l,h[f]!=fe)break;h[f--]=0,l=1}for(r=h.length;h[--r]===0;)h.pop()}return P&&(e.e>E.maxE?(e.d=null,e.e=NaN):e.e<E.minE&&(e.e=0,e.d=[0])),e}function Ne(e,o,i){if(!e.isFinite())return Hi(e);var t,n=e.e,r=Y(e.d),s=r.length;return o?(i&&(t=i-s)>0?r=r.charAt(0)+"."+r.slice(1)+Oe(t):s>1&&(r=r.charAt(0)+"."+r.slice(1)),r=r+(e.e<0?"e":"e+")+e.e):n<0?(r="0."+Oe(-n-1)+r,i&&(t=i-s)>0&&(r+=Oe(t))):n>=s?(r+=Oe(n+1-s),i&&(t=i-n-1)>0&&(r=r+"."+Oe(t))):((t=n+1)<s&&(r=r.slice(0,t)+"."+r.slice(t)),i&&(t=i-s)>0&&(n+1===s&&(r+="."),r+=Oe(t))),r}function Ot(e,o){var i=e[0];for(o*=I;i>=10;i/=10)o++;return o}function Bt(e,o,i){if(o>nn)throw P=!0,i&&(e.precision=i),Error(xi);return x(new e(Vt),o,1,!0)}function he(e,o,i){if(o>Qt)throw Error(xi);return x(new e(Ft),o,i,!0)}function Pi(e){var o=e.length-1,i=o*I+1;if(o=e[o],o){for(;o%10==0;o/=10)i--;for(o=e[0];o>=10;o/=10)i++}return i}function Oe(e){for(var o="";e--;)o+="0";return o}function Di(e,o,i,t){var n,r=new e(1),s=Math.ceil(t/I+4);for(P=!1;;){if(i%2&&(r=r.times(o),Ci(r.d,s)&&(n=!0)),i=K(i/2),i===0){i=r.d.length-1,n&&r.d[i]===0&&++r.d[i];break}o=o.times(o),Ci(o.d,s)}return P=!0,r}function bi(e){return e.d[e.d.length-1]&1}function Ni(e,o,i){for(var t,n=new e(o[0]),r=0;++r<o.length;)if(t=new e(o[r]),t.s)n[i](t)&&(n=t);else{n=t;break}return n}function Kt(e,o){var i,t,n,r,s,l,m,p=0,u=0,h=0,f=e.constructor,E=f.rounding,k=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(o==null?(P=!1,m=k):m=o,l=new f(.03125);e.e>-2;)e=e.times(l),h+=5;for(t=Math.log(G(2,h))/Math.LN10*2+5|0,m+=t,i=r=s=new f(1),f.precision=m;;){if(r=x(r.times(e),m,1),i=i.times(++u),l=s.plus(R(r,i,m,1)),Y(l.d).slice(0,m)===Y(s.d).slice(0,m)){for(n=h;n--;)s=x(s.times(s),m,1);if(o==null)if(p<3&&lt(s.d,m-t,E,p))f.precision=m+=10,i=r=l=new f(1),u=0,p++;else return x(s,f.precision=k,E,P=!0);else return f.precision=k,s}s=l}}function Le(e,o){var i,t,n,r,s,l,m,p,u,h,f,E=1,k=10,D=e,X=D.d,q=D.constructor,de=q.rounding,B=q.precision;if(D.s<0||!X||!X[0]||!D.e&&X[0]==1&&X.length==1)return new q(X&&!X[0]?-1/0:D.s!=1?NaN:X?0:D);if(o==null?(P=!1,u=B):u=o,q.precision=u+=k,i=Y(X),t=i.charAt(0),Math.abs(r=D.e)<15e14){for(;t<7&&t!=1||t==1&&i.charAt(1)>3;)D=D.times(e),i=Y(D.d),t=i.charAt(0),E++;r=D.e,t>1?(D=new q("0."+i),r++):D=new q(t+"."+i.slice(1))}else return p=Bt(q,u+2,B).times(r+""),D=Le(new q(t+"."+i.slice(1)),u-k).plus(p),q.precision=B,o==null?x(D,B,de,P=!0):D;for(h=D,m=s=D=R(D.minus(1),D.plus(1),u,1),f=x(D.times(D),u,1),n=3;;){if(s=x(s.times(f),u,1),p=m.plus(R(s,new q(n),u,1)),Y(p.d).slice(0,u)===Y(m.d).slice(0,u))if(m=m.times(2),r!==0&&(m=m.plus(Bt(q,u+2,B).times(r+""))),m=R(m,new q(E),u,1),o==null)if(lt(m.d,u-k,de,l))q.precision=u+=k,p=s=D=R(h.minus(1),h.plus(1),u,1),f=x(D.times(D),u,1),n=l=1;else return x(m,q.precision=B,de,P=!0);else return q.precision=B,m;m=p,n+=2}}function Hi(e){return String(e.s*e.s/0)}function Xt(e,o){var i,t,n;for((i=o.indexOf("."))>-1&&(o=o.replace(".","")),(t=o.search(/e/i))>0?(i<0&&(i=t),i+=+o.slice(t+1),o=o.substring(0,t)):i<0&&(i=o.length),t=0;o.charCodeAt(t)===48;t++);for(n=o.length;o.charCodeAt(n-1)===48;--n);if(o=o.slice(t,n),o){if(n-=t,e.e=i=i-t-1,e.d=[],t=(i+1)%I,i<0&&(t+=I),t<n){for(t&&e.d.push(+o.slice(0,t)),n-=I;t<n;)e.d.push(+o.slice(t,t+=I));o=o.slice(t),t=I-o.length}else t-=n;for(;t--;)o+="0";e.d.push(+o),P&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function rn(e,o){var i,t,n,r,s,l,m,p,u;if(o.indexOf("_")>-1){if(o=o.replace(/(\d)_(?=\d)/g,"$1"),Ti.test(o))return Xt(e,o)}else if(o==="Infinity"||o==="NaN")return+o||(e.s=NaN),e.e=NaN,e.d=null,e;if(Ji.test(o))i=16,o=o.toLowerCase();else if(Xi.test(o))i=2;else if(en.test(o))i=8;else throw Error(qe+o);for(r=o.search(/p/i),r>0?(m=+o.slice(r+1),o=o.substring(2,r)):o=o.slice(2),r=o.indexOf("."),s=r>=0,t=e.constructor,s&&(o=o.replace(".",""),l=o.length,r=l-r,n=Di(t,new t(i),r,r*2)),p=Mt(o,i,fe),u=p.length-1,r=u;p[r]===0;--r)p.pop();return r<0?new t(e.s*0):(e.e=Ot(p,u),e.d=p,P=!1,s&&(e=R(e,n,l*4)),m&&(e=e.times(Math.abs(m)<54?G(2,m):at.pow(2,m))),P=!0,e)}function sn(e,o){var i,t=o.d.length;if(t<3)return o.isZero()?o:Ye(e,2,o,o);i=1.4*Math.sqrt(t),i=i>16?16:i|0,o=o.times(1/Lt(5,i)),o=Ye(e,2,o,o);for(var n,r=new e(5),s=new e(16),l=new e(20);i--;)n=o.times(o),o=o.times(r.plus(n.times(s.times(n).minus(l))));return o}function Ye(e,o,i,t,n){var r,s,l,m,p=1,u=e.precision,h=Math.ceil(u/I);for(P=!1,m=i.times(i),l=new e(t);;){if(s=R(l.times(m),new e(o++*o++),u,1),l=n?t.plus(s):t.minus(s),t=R(s.times(m),new e(o++*o++),u,1),s=l.plus(t),s.d[h]!==void 0){for(r=h;s.d[r]===l.d[r]&&r--;);if(r==-1)break}r=l,l=t,t=s,s=r,p++}return P=!0,s.d.length=h+1,s}function Lt(e,o){for(var i=e;--o;)i*=e;return i}function ki(e,o){var i,t=o.s<0,n=he(e,e.precision,1),r=n.times(.5);if(o=o.abs(),o.lte(r))return Ve=t?4:1,o;if(i=o.divToInt(n),i.isZero())Ve=t?3:2;else{if(o=o.minus(i.times(n)),o.lte(r))return Ve=bi(i)?t?2:3:t?4:1,o;Ve=bi(i)?t?1:4:t?3:2}return o.minus(n).abs()}function Jt(e,o,i,t){var n,r,s,l,m,p,u,h,f,E=e.constructor,k=i!==void 0;if(k?(ce(i,1,We),t===void 0?t=E.rounding:ce(t,0,8)):(i=E.precision,t=E.rounding),!e.isFinite())u=Hi(e);else{for(u=Ne(e),s=u.indexOf("."),k?(n=2,o==16?i=i*4-3:o==8&&(i=i*3-2)):n=o,s>=0&&(u=u.replace(".",""),f=new E(1),f.e=u.length-s,f.d=Mt(Ne(f),10,n),f.e=f.d.length),h=Mt(u,10,n),r=m=h.length;h[--m]==0;)h.pop();if(!h[0])u=k?"0p+0":"0";else{if(s<0?r--:(e=new E(e),e.d=h,e.e=r,e=R(e,f,i,t,0,n),h=e.d,r=e.e,p=Si),s=h[i],l=n/2,p=p||h[i+1]!==void 0,p=t<4?(s!==void 0||p)&&(t===0||t===(e.s<0?3:2)):s>l||s===l&&(t===4||p||t===6&&h[i-1]&1||t===(e.s<0?8:7)),h.length=i,p)for(;++h[--i]>n-1;)h[i]=0,i||(++r,h.unshift(1));for(m=h.length;!h[m-1];--m);for(s=0,u="";s<m;s++)u+=Yt.charAt(h[s]);if(k){if(m>1)if(o==16||o==8){for(s=o==16?4:3,--m;m%s;m++)u+="0";for(h=Mt(u,n,o),m=h.length;!h[m-1];--m);for(s=1,u="1.";s<m;s++)u+=Yt.charAt(h[s])}else u=u.charAt(0)+"."+u.slice(1);u=u+(r<0?"p":"p+")+r}else if(r<0){for(;++r;)u="0"+u;u="0."+u}else if(++r>m)for(r-=m;r--;)u+="0";else r<m&&(u=u.slice(0,r)+"."+u.slice(r))}u=(o==16?"0x":o==2?"0b":o==8?"0o":"")+u}return e.s<0?"-"+u:u}function Ci(e,o){if(e.length>o)return e.length=o,!0}function ln(e){return new this(e).abs()}function an(e){return new this(e).acos()}function cn(e){return new this(e).acosh()}function pn(e,o){return new this(e).plus(o)}function mn(e){return new this(e).asin()}function un(e){return new this(e).asinh()}function dn(e){return new this(e).atan()}function _n(e){return new this(e).atanh()}function hn(e,o){e=new this(e),o=new this(o);var i,t=this.precision,n=this.rounding,r=t+4;return!e.s||!o.s?i=new this(NaN):!e.d&&!o.d?(i=he(this,r,1).times(o.s>0?.25:.75),i.s=e.s):!o.d||e.isZero()?(i=o.s<0?he(this,t,n):new this(0),i.s=e.s):!e.d||o.isZero()?(i=he(this,r,1).times(.5),i.s=e.s):o.s<0?(this.precision=r,this.rounding=1,i=this.atan(R(e,o,r,1)),o=he(this,r,1),this.precision=t,this.rounding=n,i=e.s<0?i.minus(o):i.plus(o)):i=this.atan(R(e,o,r,1)),i}function fn(e){return new this(e).cbrt()}function gn(e){return x(e=new this(e),e.e+1,2)}function vn(e,o,i){return new this(e).clamp(o,i)}function yn(e){if(!e||typeof e!="object")throw Error(Rt+"Object expected");var o,i,t,n=e.defaults===!0,r=["precision",1,We,"rounding",0,8,"toExpNeg",-Ge,0,"toExpPos",0,Ge,"maxE",0,Ge,"minE",-Ge,0,"modulo",0,9];for(o=0;o<r.length;o+=3)if(i=r[o],n&&(this[i]=Zt[i]),(t=e[i])!==void 0)if(K(t)===t&&t>=r[o+1]&&t<=r[o+2])this[i]=t;else throw Error(qe+i+": "+t);if(i="crypto",n&&(this[i]=Zt[i]),(t=e[i])!==void 0)if(t===!0||t===!1||t===0||t===1)if(t)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[i]=!0;else throw Error(Ei);else this[i]=!1;else throw Error(qe+i+": "+t);return this}function bn(e){return new this(e).cos()}function Cn(e){return new this(e).cosh()}function Mi(e){var o,i,t;function n(r){var s,l,m,p=this;if(!(p instanceof n))return new n(r);if(p.constructor=n,wi(r)){p.s=r.s,P?!r.d||r.e>n.maxE?(p.e=NaN,p.d=null):r.e<n.minE?(p.e=0,p.d=[0]):(p.e=r.e,p.d=r.d.slice()):(p.e=r.e,p.d=r.d?r.d.slice():r.d);return}if(m=typeof r,m==="number"){if(r===0){p.s=1/r<0?-1:1,p.e=0,p.d=[0];return}if(r<0?(r=-r,p.s=-1):p.s=1,r===~~r&&r<1e7){for(s=0,l=r;l>=10;l/=10)s++;P?s>n.maxE?(p.e=NaN,p.d=null):s<n.minE?(p.e=0,p.d=[0]):(p.e=s,p.d=[r]):(p.e=s,p.d=[r]);return}else if(r*0!==0){r||(p.s=NaN),p.e=NaN,p.d=null;return}return Xt(p,r.toString())}else if(m!=="string")throw Error(qe+r);return(l=r.charCodeAt(0))===45?(r=r.slice(1),p.s=-1):(l===43&&(r=r.slice(1)),p.s=1),Ti.test(r)?Xt(p,r):rn(p,r)}if(n.prototype=g,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=yn,n.clone=Mi,n.isDecimal=wi,n.abs=ln,n.acos=an,n.acosh=cn,n.add=pn,n.asin=mn,n.asinh=un,n.atan=dn,n.atanh=_n,n.atan2=hn,n.cbrt=fn,n.ceil=gn,n.clamp=vn,n.cos=bn,n.cosh=Cn,n.div=wn,n.exp=Sn,n.floor=xn,n.hypot=En,n.ln=In,n.log=Tn,n.log10=Dn,n.log2=Pn,n.max=Nn,n.min=Hn,n.mod=kn,n.mul=Mn,n.pow=Vn,n.random=Fn,n.round=Bn,n.sign=Rn,n.sin=On,n.sinh=Ln,n.sqrt=qn,n.sub=Wn,n.sum=An,n.tan=$n,n.tanh=Un,n.trunc=zn,e===void 0&&(e={}),e&&e.defaults!==!0)for(t=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],o=0;o<t.length;)e.hasOwnProperty(i=t[o++])||(e[i]=this[i]);return n.config(e),n}function wn(e,o){return new this(e).div(o)}function Sn(e){return new this(e).exp()}function xn(e){return x(e=new this(e),e.e+1,3)}function En(){var e,o,i=new this(0);for(P=!1,e=0;e<arguments.length;)if(o=new this(arguments[e++]),o.d)i.d&&(i=i.plus(o.times(o)));else{if(o.s)return P=!0,new this(1/0);i=o}return P=!0,i.sqrt()}function wi(e){return e instanceof at||e&&e.toStringTag===Ii||!1}function In(e){return new this(e).ln()}function Tn(e,o){return new this(e).log(o)}function Pn(e){return new this(e).log(2)}function Dn(e){return new this(e).log(10)}function Nn(){return Ni(this,arguments,"lt")}function Hn(){return Ni(this,arguments,"gt")}function kn(e,o){return new this(e).mod(o)}function Mn(e,o){return new this(e).mul(o)}function Vn(e,o){return new this(e).pow(o)}function Fn(e){var o,i,t,n,r=0,s=new this(1),l=[];if(e===void 0?e=this.precision:ce(e,1,We),t=Math.ceil(e/I),this.crypto)if(crypto.getRandomValues)for(o=crypto.getRandomValues(new Uint32Array(t));r<t;)n=o[r],n>=429e7?o[r]=crypto.getRandomValues(new Uint32Array(1))[0]:l[r++]=n%1e7;else if(crypto.randomBytes){for(o=crypto.randomBytes(t*=4);r<t;)n=o[r]+(o[r+1]<<8)+(o[r+2]<<16)+((o[r+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(o,r):(l.push(n%1e7),r+=4);r=t/4}else throw Error(Ei);else for(;r<t;)l[r++]=Math.random()*1e7|0;for(t=l[--r],e%=I,t&&e&&(n=G(10,I-e),l[r]=(t/n|0)*n);l[r]===0;r--)l.pop();if(r<0)i=0,l=[0];else{for(i=-1;l[0]===0;i-=I)l.shift();for(t=1,n=l[0];n>=10;n/=10)t++;t<I&&(i-=I-t)}return s.e=i,s.d=l,s}function Bn(e){return x(e=new this(e),e.e+1,this.rounding)}function Rn(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function On(e){return new this(e).sin()}function Ln(e){return new this(e).sinh()}function qn(e){return new this(e).sqrt()}function Wn(e,o){return new this(e).sub(o)}function An(){var e=0,o=arguments,i=new this(o[e]);for(P=!1;i.s&&++e<o.length;)i=i.plus(o[e]);return P=!0,x(i,this.precision,this.rounding)}function $n(e){return new this(e).tan()}function Un(e){return new this(e).tanh()}function zn(e){return x(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var at=g.constructor=Mi(Zt);Vt=new at(Vt);Ft=new at(Ft);var He=at;var Ze=(()=>{let o=class o{add(t,n){let r=new He(t),s=new He(n);return r.add(s).toNumber()}subtract(t,n){let r=new He(t),s=new He(n);return r.sub(s).toNumber()}multiply(t,n){let r=new He(t),s=new He(n);return r.mul(s).toNumber()}divide(t,n){let r=new He(t),s=new He(n);return r.div(s).toNumber()}decimal(t){return new He(t).toNumber()}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Li=rt(st());var Vi=(()=>{let o=class o{constructor(){this.http=S(Fe),this.api=S(Be),this.notificationService=S(ue),this.whatsappLoading=W(!1)}sendMessage(t){this.whatsappLoading.set(!0),this.http.post(`${this.api.host}/send-whatsapp`,t).subscribe({next:n=>{this.notificationService.showInfo(n.message,"home",!1),this.whatsappLoading.set(!1)},error:n=>{this.whatsappLoading.set(!1),this.notificationService.showError("Error sending whatsapp!","home")}})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Fi=(()=>{let o=class o{constructor(){this.apiService=S(Be),this.http=S(Fe),this.notificationService=S(ue),this.customersService=S(Re),this.host=this.apiService.host,this.currentInvoice=W({}),this.signal_submited=W(!1),this.signal_submit_loading=W(!1),this.action_status$=new Ae(""),this.selectedCustomerLatestItems=new Ae([])}chcekout(t,n){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/sell-orders`,t).subscribe({next:r=>{this.notificationService.showSuccess("Invoice Updated","home")},error:r=>{this.notificationService.showError(r.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(t.customer_id)}})}returnCheckout(t,n){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,t).subscribe({next:r=>{this.notificationService.showSuccess("Invoice Updated","home")},error:r=>{this.notificationService.showError(r.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(t.customer_id)}})}deleteInvoice(t,n){let r=t.order_id;console.log(r),this.signal_submited.set(!0),this.http.delete(`${this.host}/sell-orders/${r}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(t.customer_id)}})}returnDeleteInvoice(t,n){let r=t.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${r}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(t.customer_id)}})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Ri=rt(st());var Qn=()=>({width:"95vw",height:"75vh"}),Kn=()=>({standalone:!0}),Bi=e=>({invalid:e}),Xn=(e,o)=>({"text-red-500":e,"text-orange-500":o}),Jn=e=>({"text-red-500":e});function eo(e,o){e&1&&(a(0,"tr")(1,"th",26),_(2,"Barcode"),c(),a(3,"th",27),_(4,"Description"),c(),a(5,"th",28),_(6,"Unit"),c(),a(7,"th",29),_(8,"Qty"),c(),a(9,"th",28),_(10,"Total"),c(),a(11,"th",29),_(12,"Del?"),c()())}function to(e,o){if(e&1){let i=F();a(0,"p-inputNumber",36),U("ngModelChange",function(n){C(i);let r=y().$implicit;return $(r.unit_price,n)||(r.unit_price=n),w(n)}),b("ngModelChange",function(){C(i);let n=y().$implicit,r=y(2);return w(r.setPrice(n))})("onFocus",function(n){C(i);let r=y(3);return w(r.select(n.target))}),c()}if(e&2){let i=y().$implicit;A("ngModel",i.unit_price),v("maxFractionDigits",2)("min",0)}}function io(e,o){e&1&&H(0,"i",39)}function no(e,o){if(e&1&&(a(0,"span",37),_(1),M(2,"currency"),a(3,"span"),N(4,io,1,0,"i",38),c()()),e&2){let i=y().$implicit,t=y(2);v("ngClass",gt(5,Xn,!i.unit_price,t.getPriceWarining(i))),d(),T(V(2,3,i.unit_price)),d(3),v("ngIf",t.getPriceWarining(i))}}function oo(e,o){if(e&1){let i=F();a(0,"p-inputNumber",40),U("ngModelChange",function(n){C(i);let r=y().$implicit;return $(r.quantity,n)||(r.quantity=n),w(n)}),b("onFocus",function(n){C(i);let r=y(3);return w(r.select(n.target))})("ngModelChange",function(){C(i);let n=y().$implicit,r=y(2);return w(r.setQty(n))}),c()}if(e&2){let i=y().$implicit;A("ngModel",i.quantity)}}function ro(e,o){if(e&1&&(a(0,"span",37),_(1),c()),e&2){let i=y().$implicit;v("ngClass",Me(2,Jn,!i.quantity)),d(),T(i.quantity)}}function so(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td",30)(6,"p-cellEditor"),N(7,to,1,3,"ng-template",31)(8,no,5,8,"ng-template",32),c()(),a(9,"td",33)(10,"p-cellEditor"),N(11,oo,1,1,"ng-template",31)(12,ro,2,4,"ng-template",32),c()(),a(13,"td"),_(14),M(15,"currency"),c(),a(16,"td",34),b("click",function(){let n=C(i).rowIndex,r=y(2);return w(r.removeRow(n))}),H(17,"i",35),c()()}if(e&2){let i=o.$implicit;d(2),T(i.barcode||"---"),d(2),T(i.product_name),d(),v("pEditableColumn",i.unit_price)("ngClass",Me(9,Bi,!i.unit_price)),d(4),v("pEditableColumn",i.quantity)("ngClass",Me(11,Bi,!i.quantity)),d(5),L(" ",V(15,7,i.unit_price*i.quantity)," ")}}function lo(e,o){if(e&1&&(a(0,"h4",42),_(1),c()),e&2){let i=y(3);d(),L(" Total units: ",i.invoiceTotal.total_qty," ")}}function ao(e,o){if(e&1&&N(0,lo,2,1,"h4",41),e&2){let i=y(2);v("ngIf",i.invoiceTotal.total_qty)}}function co(e,o){e&1&&(a(0,"tr",43)(1,"td",44),_(2,"No data yet!"),c()())}function po(e,o){if(e&1){let i=F();a(0,"p-card",6)(1,"div",7)(2,"div",8)(3,"div",9),H(4,"div",10),a(5,"label"),_(6,"Invoice Date"),c(),a(7,"p-calendar",11),U("ngModelChange",function(n){C(i);let r=y();return $(r.invoice_date,n)||(r.invoice_date=n),w(n)}),c()()(),a(8,"div",8)(9,"div",10)(10,"label",12),_(11,"Customer"),a(12,"span",13),_(13," *"),c()(),a(14,"p-dropdown",14),U("ngModelChange",function(n){C(i);let r=y();return $(r.customer_id,n)||(r.customer_id=n),w(n)}),b("onChange",function(n){C(i);let r=y();return w(r.customerChange(n.value))}),c()()(),a(15,"div",15)(16,"h3",16),_(17),M(18,"currency"),c(),a(19,"h3",17),_(20),M(21,"lira"),c()()(),a(22,"div",7)(23,"div",18)(24,"p-table",19,0),N(26,eo,13,0,"ng-template",20)(27,so,18,13,"ng-template",3)(28,ao,1,1,"ng-template",21)(29,co,3,0,"ng-template",22),c()(),a(30,"div",23)(31,"p-autoComplete",24,1),U("ngModelChange",function(n){C(i);let r=y();return $(r.search_product,n)||(r.search_product=n),w(n)}),b("completeMethod",function(n){C(i);let r=y();return w(r.searchItem(n))})("onKeyUp",function(n){C(i);let r=y();return w(r.submitInvoiceInput(n))}),c(),a(33,"button",25),b("click",function(){C(i);let n=y();return w(n.openProductsDialog())}),c()()()()}if(e&2){let i=y();d(7),A("ngModel",i.invoice_date),v("ngModelOptions",j(23,Kn))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),d(7),A("ngModel",i.customer_id),v("options",i.customers)("filter",!0)("showClear",!0),d(3),L(" USD: ",V(18,19,i.invoiceTotal.total_dollar)," "),d(3),L(" LBP: ",V(21,21,i.invoiceTotal.total_dollar*i.invoice.exchange_rate)," "),d(4),ft("scrollHeight",i.vh),v("value",i.order_items)("scrollable",!0),d(7),A("ngModel",i.search_product),v("suggestions",i.matching_products)("delay",150)("autofocus",!0)}}function mo(e,o){if(e&1){let i=F();a(0,"p-button",48),b("click",function(){C(i);let n=y(2);return w(n.deleteInvoice())}),c()}if(e&2){let i=y(2);v("disabled",i.submitted())}}function uo(e,o){if(e&1){let i=F();N(0,mo,1,1,"p-button",45),a(1,"p-button",46),b("click",function(){C(i);let n=y();return w(n.closeEditDialog())}),c(),a(2,"p-button",47),b("click",function(){C(i);let n=y();return w(n.submitEditInvoice())}),c()}if(e&2){let i=y();v("ngIf",i.userPermissions().delete_invoice),d(),v("disabled",i.submitted()),d(),v("loading",i.submitted())("disabled",i.order_items.length==0)}}var Wt=(()=>{let o=class o{constructor(){this.visible=!1,this.customers=[],this.return_invoice_edit=!1,this.onSubmit=new $e,this.onHide=new $e,this.stockService=S(It),this.editInvoiceService=S(Fi),this.authService=S(Ue),this.confirmationService=S(yt),this.notificationsService=S(ue),this.sellService=S(hi),this.userPermissions=this.authService.userPermissions,this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new Et,this.order_items=[],this.customer_id=null,this.invoice_number="123",this.selected_price_type="latest",this.selectedCustomerLatestItems=[],this.productsDialogVisible=!1,this.subscriptions=new me,this.products=this.stockService.products,this.matching_products=[],this.priceTypes=Object.keys(_i),this.editDialogVisible=!1,this.vh="50vh"}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(t=>{(t==="UPDATE"||t==="DELETE")&&(this.onSubmit.emit({action:t}),this.editInvoiceService.action_status$.next(""),this.visible=!1)})),this.subscriptions.add(this.editInvoiceService.selectedCustomerLatestItems.subscribe(t=>{this.selectedCustomerLatestItems=t})),this.subscriptions.add(this.sellService.barcodeResponse.subscribe(t=>{t&&(this.addProduct(t),this.sellService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=(0,Ri.default)(this.invoice.order_date).format("YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.order_items=structuredClone(this.invoice.items),this.customer_id=this.invoice.customer_id,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_amount,this.customerChange(this.invoice.customer_id))}setPrice(t){t.unit_price?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}setQty(t){t.quantity?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}validateItems(){return this.order_items.find(n=>!n.unit_price||!n.quantity)?(this.form_error=!0,!0):(this.form_error=!1,!1)}addProduct(t){let n=this.order_items.find(r=>r.product_id===t.product_id);n?(n.quantity+=1,this.calculateTotal("edit")):(this.order_items.push({product_id:t.product_id,barcode:t.barcode,product_name:t.product_name,unit_cost:t.unit_cost_usd,unit_price:t.unit_price_usd,quantity:1,stock_management:t.stock_management}),this.calculateTotal("add"))}submitInvoiceInput(t){t.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.sellService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(t){if(t){let n=-1,r=["*","+"];for(let m=0;m<r.length;m++)if(t.indexOf(r[m])!==-1){n=t.indexOf(r[m]);break}let s=t.substring(0,n)||1,l=parseInt(t.substring(n+1,t.length));n!=-1&&n!=0?(this.sellService.factor.set(parseInt(s)),this.sellService.submitBarcode(l)):this.sellService.submitBarcode(t)}}calculateTotal(t){let n=new Et,r=this.order_items;return r.length>0&&(r.forEach(s=>{n.total_qty+=s.quantity,n.cost_dollar+=s.unit_cost*s.quantity,n.subtotal_dollar+=s.unit_price*s.quantity}),n.total_dollar=n.subtotal_dollar-n.discount_dollar),this.invoiceTotal=n,n}submitEditInvoice(){let t=this.validateItems();t?t&&this.notificationsService.showError("Please enter price for all items","home"):this.return_invoice_edit?this.editInvoiceService.returnCheckout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.chcekout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService)}searchItem(t){let n=this.products(),r=[],s=t.query;for(let l=0;l<n.length;l++){let m=n[l];m.product_name.toLowerCase().indexOf(s.toLowerCase())>-1&&r.push(m)}this.matching_products=r}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}customerChange(t){}removeRow(t){this.order_items.splice(t,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.order_items=[],this.submitted.set(!1),this.invoiceTotal=new Et}})}deleteInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.return_invoice_edit?this.editInvoiceService.returnDeleteInvoice(this.invoice,this.stockService):this.editInvoiceService.deleteInvoice(this.invoice,this.stockService)}})}closeProductsDialog(){}assignSelectedProducts(t){this.productsDialogVisible=!1,t.forEach(n=>{this.addProduct(n)})}getPriceTypeLabel(t){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[t]}select(t){t.select()}getPriceWarining(t){if(!t.unit_price)return!1;let n=t.unit_cost||0,r=t.unit_price;return typeof n=="string"&&(n=parseFloat(n)),typeof r=="string"&&(r=parseFloat(r)),r<n}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["edit-invoice"]],inputs:{visible:"visible",invoice:"invoice",customers:"customers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[ht],decls:4,vars:9,consts:[["invoiceTable",""],["barcodeInput",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","products"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","customer"],[1,"text-red-500"],["styleClass","p-inputtext-sm","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],["width","20%"],["width","40%"],["width","15%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn","ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["min","0","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["label","Delete","icon","pi pi-trash","severity","danger","size","small","class","w-full mt-4 md:w-auto md:mt-0",3,"disabled","click",4,"ngIf"],["label","Cancel Edit","icon","pi pi-times","severity","secondary","size","small",1,"w-full","mt-2","md:w-auto","md:ml-2",3,"click","disabled"],["size","small","label","Submit Edit","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"click","loading","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",1,"w-full","mt-4","md:w-auto","md:mt-0",3,"click","disabled"]],template:function(n,r){n&1&&(a(0,"p-dialog",2),U("visibleChange",function(l){return $(r.visible,l)||(r.visible=l),l}),b("onHide",function(){return r.closeEditDialog()}),N(1,po,34,24,"ng-template",3)(2,uo,3,4,"ng-template",4),c(),a(3,"products-dialog",5),b("onHide",function(){return r.productsDialogVisible=!1})("onSubmit",function(l){return r.assignSelectedProducts(l)}),c()),n&2&&(ve(j(8,Qn)),A("visible",r.visible),v("modal",!0)("closable",!0)("maximizable",!0),d(3),v("visible",r.productsDialogVisible)("products",r.products))},dependencies:[vt,ye,ie,bt,ze,ae,te,St,xt,oe,re,ne,Te,le,se,wt,Tt,ee,Pt],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:100%;height:28px}[_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.invalid[_ngcontent-%COMP%]{border-bottom:1px solid var(--red-500)!important}[_nghost-%COMP%]  .p-card-content{padding-top:0!important;padding-bottom:0!important}"]});let e=o;return e})();var _o=()=>[10,25,50],ho=()=>({width:"95vw"});function fo(e,o){e&1&&(a(0,"tr")(1,"th"),_(2,"Invoice #"),c(),a(3,"th"),_(4,"Customer"),c(),a(5,"th"),_(6,"Datetime"),c(),a(7,"th"),_(8,"total"),c(),a(9,"th",19),_(10,"Options"),c()())}function go(e,o){if(e&1){let i=F();a(0,"p-button",24),b("onClick",function(){C(i);let n=y().$implicit,r=y();return w(r.openEditDialog(n))}),c()}}function vo(e,o){if(e&1){let i=F();a(0,"p-button",25),b("onClick",function(){C(i);let n=y().$implicit,r=y();return w(r.sendWhatsapp(n))}),c()}if(e&2){let i=y(2);v("loading",i.whatsappLoading())}}function yo(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),c(),a(7,"td"),_(8),M(9,"currency"),c(),a(10,"td")(11,"p-button",20),b("onClick",function(){let n=C(i).$implicit,r=y();return w(r.showInvoiceDialog(n))}),c()(),a(12,"td")(13,"p-button",21),b("onClick",function(){let n=C(i).$implicit,r=y();return w(r.printInvoice(n))}),c()(),a(14,"td"),N(15,go,1,0,"p-button",22),c(),a(16,"td"),N(17,vo,1,1,"p-button",23),c()()}if(e&2){let i=o.$implicit,t=y();d(2),T(i.invoice_number),d(2),T(i.customer_name||"---"),d(2),T(i.order_date),d(2),T(V(9,6,i.total_amount)),d(7),v("ngIf",t.userPermissions().edit_invoice),d(2),v("ngIf",i.customer_phone)}}function bo(e,o){e&1&&(a(0,"tr")(1,"td",26),_(2,"No Records Found!"),c()())}function Co(e,o){e&1&&(a(0,"th"),_(1,"Unit Cost"),c())}function wo(e,o){e&1&&(a(0,"th"),_(1," Total Unit Cost "),c())}function So(e,o){if(e&1&&(a(0,"tr")(1,"th",29),_(2,"Barcode"),c(),a(3,"th",30),_(4,"Description"),c(),a(5,"th"),_(6,"Unit Price"),c(),a(7,"th",31),_(8,"Qty"),c(),a(9,"th"),_(10,"Total Price"),c(),N(11,Co,2,0,"th",32)(12,wo,2,0,"th",32),c()),e&2){let i=y(3);d(11),v("ngIf",i.userPermissions().show_cost),d(),v("ngIf",i.userPermissions().show_cost)}}function xo(e,o){if(e&1&&(a(0,"td"),_(1),M(2,"currency"),c()),e&2){let i=y().$implicit;d(),L(" ",V(2,1,i.unit_cost)," ")}}function Eo(e,o){if(e&1&&(a(0,"td"),_(1),M(2,"currency"),c()),e&2){let i=y().$implicit;d(),L(" ",V(2,1,i.unit_cost*i.quantity)," ")}}function Io(e,o){if(e&1&&(a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),M(7,"currency"),c(),a(8,"td"),_(9),c(),a(10,"td"),_(11),M(12,"currency"),c(),N(13,xo,3,3,"td",32)(14,Eo,3,3,"td",32),c()),e&2){let i=o.$implicit,t=y(3);d(2),T(i.barcode||"---"),d(2),T(i.product_name),d(2),L(" ",V(7,7,i.unit_price)," "),d(3),T(i.quantity),d(2),L(" ",V(12,9,i.total_price)," "),d(2),v("ngIf",t.userPermissions().show_cost),d(),v("ngIf",t.userPermissions().show_cost)}}function To(e,o){e&1&&H(0,"td")}function Po(e,o){if(e&1&&(a(0,"td"),_(1),M(2,"currency"),c()),e&2){let i=y(4);d(),L(" ",V(2,1,i.selectedInvoiceTotals.totalCost)," ")}}function Do(e,o){if(e&1&&(a(0,"tr"),H(1,"td")(2,"td")(3,"td"),a(4,"td"),_(5),c(),a(6,"td"),_(7),M(8,"currency"),c(),N(9,To,1,0,"td",32)(10,Po,3,3,"td",32),c()),e&2){let i=y(3);d(5),T(i.selectedInvoiceTotals.totalQty),d(2),L(" ",V(8,4,i.selectedInvoiceTotals.totalPrice)," "),d(2),v("ngIf",i.userPermissions().show_cost),d(),v("ngIf",i.userPermissions().show_cost)}}function No(e,o){if(e&1&&(a(0,"p-table",28),N(1,So,13,2,"ng-template",12)(2,Io,15,11,"ng-template",13)(3,Do,11,6,"ng-template",17),c()),e&2){let i=y(2);v("value",i.invoiceItems)}}function Ho(e,o){if(e&1&&N(0,No,4,1,"p-table",27),e&2){let i=y();v("ngIf",i.invoiceItems.length!=0)}}function ko(e,o){if(e&1){let i=F();a(0,"button",33),b("click",function(){C(i);let n=y();return w(n.hideInvoiceDialog())}),c()}}var qi=(()=>{let o=class o{constructor(){this.customerService=S(Re),this.historyService=S(De),this.decimalService=S(Ze),this.printService=S(Nt),this.authService=S(Ue),this.whatsappService=S(Vi),this.userPermissions=this.authService.userPermissions,this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new me,this.salesHistory=this.historyService.salesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new we({invoice_number:new z(null),customer_id:new z(null),invoice_date:new z(null)}),this.whatsappLoading=this.whatsappService.whatsappLoading}ngOnInit(){}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,Li.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchSalesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchSalesHistory(null)}showInvoiceDialog(t){this.invoiceItems=t.items,this.invoiceItems.forEach(n=>{this.selectedInvoiceTotals.totalQty+=n.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,n.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,n.unit_cost*n.quantity)}),this.detailsDialogVisible=!0}openEditDialog(t){this.selectedInvoice=t,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(t){this.historyService.fetchSalesHistory(this.searchForm.value)}printInvoice(t){this.printService.print(t,"sale")}sendWhatsapp(t){this.whatsappLoading.set(!0);let n={to:t.customer_phone,messageContents:[t.invoice_number,t.order_datetime,`${t.total_amount}$`]};this.whatsappService.sendMessage(n)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["app-sell-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers"],["colspan","4","width","10%"],["size","small","severity","info","icon","fas fa-eye",3,"onClick"],["size","small","severity","secondary","icon","pi pi-print",3,"onClick"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick",4,"ngIf"],["size","small","severity","success","icon","pi pi-whatsapp",3,"loading","onClick",4,"ngIf"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["size","small","severity","success","icon","pi pi-whatsapp",3,"onClick","loading"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","15%"],["width","35%"],["width","5%"],[4,"ngIf"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),b("ngSubmit",function(){return r.submitSearch()}),a(5,"div",4)(6,"div",5),H(7,"input",6),c(),a(8,"div",5),H(9,"p-dropdown",7),c(),a(10,"div",5),H(11,"p-calendar",8),c(),a(12,"div",5),H(13,"p-button",9),a(14,"p-button",10),b("onClick",function(){return r.resetSearch()}),c()()()()(),a(15,"p-table",11),N(16,fo,11,0,"ng-template",12)(17,yo,18,8,"ng-template",13)(18,bo,3,0,"ng-template",14),c()()()(),a(19,"p-dialog",15),U("visibleChange",function(l){return $(r.detailsDialogVisible,l)||(r.detailsDialogVisible=l),l}),b("onHide",function(){return r.hideInvoiceDialog()}),N(20,Ho,1,1,"ng-template",16)(21,ko,1,0,"ng-template",17),c(),a(22,"edit-invoice",18),b("onHide",function(){return r.closeEditDialog()})("onSubmit",function(l){return r.submitEdit(l)}),c()),n&2&&(d(3),v("toggleable",!0),d(),v("formGroup",r.searchForm),d(5),v("options",r.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),d(2),v("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),d(2),v("loading",r.loading()),d(),v("disabled",r.loading()),d(),v("value",r.salesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(28,_o))("alwaysShowPaginator",!1)("loading",r.loading()),d(4),ve(j(29,ho)),A("visible",r.detailsDialogVisible),v("modal",!0)("closable",!0)("maximizable",!0),d(3),v("visible",r.editDialogVisible)("invoice",r.selectedInvoice)("customers",r.customers()))},dependencies:[ye,Se,be,ie,Ce,xe,Ee,ae,te,oe,re,ne,Te,Ie,le,se,Pe,Wt,ee]});let e=o;return e})();var Wi=rt(st());var Mo=()=>[10,25,50];function Vo(e,o){e&1&&(a(0,"tr")(1,"th"),_(2,"Payment #"),c(),a(3,"th"),_(4,"Customer"),c(),a(5,"th"),_(6,"Datetime"),c(),a(7,"th"),_(8,"total"),c(),a(9,"th",16),_(10,"Options"),c()())}function Fo(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),c(),a(7,"td"),_(8),M(9,"currency"),c(),a(10,"td")(11,"button",17),b("click",function(){let n=C(i).$implicit,r=y();return w(r.printInvoice(n))}),c()(),a(12,"td")(13,"button",18),b("click",function(){let n=C(i).$implicit,r=y();return w(r.openEditDialog(n))}),c()()()}if(e&2){let i=o.$implicit;d(2),T(i.journal_number),d(2),T(i.partner_name),d(2),T(i.payment_date),d(2),T(V(9,4,i.total_value))}}function Bo(e,o){e&1&&(a(0,"tr")(1,"td",19),_(2,"No Records Found!"),c()())}var Ai=(()=>{let o=class o{constructor(){this.customerService=S(Re),this.historyService=S(De),this.customers=this.customerService.customers,this.customersLoading=this.customerService.signal_tableLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.paymentsHistory=this.historyService.paymentsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new we({payment_date:new z(null),partner_id:new z(null),payment_number:new z(null)})}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=(0,Wi.default)(this.searchForm.value.payment_date).format("YYYY-MM-DD")),this.historyService.fetchPaymentHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPaymentHistory(null)}showInvoiceDialog(t){}printInvoice(t){}openEditDialog(t){this.selectedPayment=t,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(t){this.historyService.fetchPaymentHistory(this.searchForm.value)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["app-payment-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),b("ngSubmit",function(){return r.submitSearch()}),a(5,"div",4)(6,"div",5),H(7,"input",6),c(),a(8,"div",5),H(9,"p-dropdown",7),c(),a(10,"div",5),H(11,"p-calendar",8),c(),a(12,"div",5),H(13,"p-button",9),a(14,"p-button",10),b("onClick",function(){return r.resetSearch()}),c()()()()(),a(15,"p-table",11),N(16,Vo,11,0,"ng-template",12)(17,Fo,14,6,"ng-template",13)(18,Bo,3,0,"ng-template",14),c()()()(),a(19,"payment-dialog",15),b("onClose",function(){return r.hidePaymentDialog()})("onSubmit",function(l){return r.getPaymentDilogResult(l)}),c()),n&2&&(d(3),v("toggleable",!0),d(),v("formGroup",r.searchForm),d(5),v("options",r.customers())("loading",r.customersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),d(2),v("showIcon",!1)("showClear",!0)("readonlyInput",!0),d(2),v("loading",r.loading()),d(),v("disabled",r.loading()),d(),v("value",r.paymentsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(22,Mo))("alwaysShowPaginator",!1)("loading",r.loading()),d(4),v("visible",r.editDialogVisible)("selected_payment",r.selectedPayment)("accounts",r.customers()))},dependencies:[Se,be,ie,Ce,xe,Ee,ae,te,oe,re,ne,Ie,le,se,Pe,Ht,ee]});let e=o;return e})();var $i=rt(st());var Ro=()=>[10,25,50],Oo=()=>({width:"95vw"});function Lo(e,o){e&1&&(a(0,"tr")(1,"th"),_(2,"Invoice #"),c(),a(3,"th"),_(4,"Customer"),c(),a(5,"th"),_(6,"Datetime"),c(),a(7,"th"),_(8,"total"),c(),a(9,"th",19),_(10,"Options"),c()())}function qo(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),c(),a(7,"td"),_(8),M(9,"currency"),c(),a(10,"td")(11,"button",20),b("click",function(){let n=C(i).$implicit,r=y();return w(r.showInvoiceDialog(n))}),c()(),a(12,"td")(13,"button",21),b("click",function(){let n=C(i).$implicit,r=y();return w(r.printInvoice(n))}),c()(),a(14,"td")(15,"button",22),b("click",function(){let n=C(i).$implicit,r=y();return w(r.openEditDialog(n))}),c()()()}if(e&2){let i=o.$implicit;d(2),T(i.invoice_number),d(2),T(i.customer_name),d(2),T(i.order_date),d(2),T(V(9,4,i.total_amount))}}function Wo(e,o){e&1&&(a(0,"tr")(1,"td",23),_(2,"No Records Found!"),c()())}function Ao(e,o){e&1&&(a(0,"tr")(1,"th",26),_(2,"Description"),c(),a(3,"th",27),_(4,"Unit Price"),c(),a(5,"th",28),_(6,"Qty"),c(),a(7,"th",27),_(8,"Total Price"),c()())}function $o(e,o){if(e&1&&(a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),M(5,"currency"),c(),a(6,"td"),_(7),c(),a(8,"td"),_(9),M(10,"currency"),c()()),e&2){let i=o.$implicit;d(2),T(i.product_name),d(2),L(" ",V(5,4,i.unit_price)," "),d(3),T(i.quantity),d(2),L(" ",V(10,6,i.total_price)," ")}}function Uo(e,o){if(e&1&&(a(0,"tr"),H(1,"td")(2,"td"),a(3,"td"),_(4),c(),a(5,"td"),_(6),M(7,"currency"),c()()),e&2){let i=y(3);d(4),T(i.selectedInvoiceTotals.totalQty),d(2),L(" Total: ",V(7,2,i.selectedInvoiceTotals.totalPrice)," ")}}function zo(e,o){if(e&1&&(a(0,"p-table",25),N(1,Ao,9,0,"ng-template",12)(2,$o,11,8,"ng-template",13)(3,Uo,8,4,"ng-template",17),c()),e&2){let i=y(2);v("value",i.invoiceItems)}}function jo(e,o){if(e&1&&N(0,zo,4,1,"p-table",24),e&2){let i=y();v("ngIf",i.invoiceItems.length!=0)}}function Go(e,o){if(e&1){let i=F();a(0,"button",29),b("click",function(){C(i);let n=y();return w(n.hideInvoiceDialog())}),c()}}var Ui=(()=>{let o=class o{constructor(){this.customerService=S(Re),this.historyService=S(De),this.decimalService=S(Ze),this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new me,this.returnHistory=this.historyService.returnHistory,this.loading=this.historyService.signal_loading,this.searchForm=new we({invoice_number:new z(null),customer_id:new z(null),invoice_date:new z(null)})}ngOnInit(){}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,$i.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchReturnHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReturnHistory(null)}showInvoiceDialog(t){this.invoiceItems=t.items,this.invoiceItems.forEach(n=>{this.selectedInvoiceTotals.totalQty+=n.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,n.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,n.unit_cost)}),this.detailsDialogVisible=!0}printInvoice(t){}printDelivery(t){}openEditDialog(t){console.log(t),this.selectedInvoice=t,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(t){this.historyService.fetchReturnHistory(this.searchForm.value)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["app-sell-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers","return_invoice_edit"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","pi pi-print",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","50%"],["width","20%"],["width","10%"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),b("ngSubmit",function(){return r.submitSearch()}),a(5,"div",4)(6,"div",5),H(7,"p-dropdown",6),c(),a(8,"div",5),H(9,"p-calendar",7),c(),a(10,"div",5),H(11,"input",8),c(),a(12,"div",5),H(13,"p-button",9),a(14,"p-button",10),b("onClick",function(){return r.resetSearch()}),c()()()()(),a(15,"p-table",11),N(16,Lo,11,0,"ng-template",12)(17,qo,16,6,"ng-template",13)(18,Wo,3,0,"ng-template",14),c()()()(),a(19,"p-dialog",15),U("visibleChange",function(l){return $(r.detailsDialogVisible,l)||(r.detailsDialogVisible=l),l}),b("onHide",function(){return r.hideInvoiceDialog()}),N(20,jo,1,1,"ng-template",16)(21,Go,1,0,"ng-template",17),c(),a(22,"edit-invoice",18),b("onHide",function(){return r.closeEditDialog()})("onSubmit",function(l){return r.submitEdit(l)}),c()),n&2&&(d(3),v("toggleable",!0),d(),v("formGroup",r.searchForm),d(3),v("options",r.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),d(2),v("showIcon",!1)("showClear",!0)("readonlyInput",!0),d(4),v("loading",r.loading()),d(),v("disabled",r.loading()),d(),v("value",r.returnHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(28,Ro))("alwaysShowPaginator",!1)("loading",r.loading()),d(4),ve(j(29,Oo)),A("visible",r.detailsDialogVisible),v("modal",!0)("closable",!0)("maximizable",!0),d(3),v("visible",r.editDialogVisible)("invoice",r.selectedInvoice)("customers",r.customers())("return_invoice_edit",!0))},dependencies:[ye,Se,be,ie,Ce,xe,Ee,ae,te,oe,re,ne,Te,Ie,le,se,Pe,Wt,ee]});let e=o;return e})();var Yi=rt(st());var zi=(()=>{let o=class o{constructor(){this.apiService=S(Be),this.http=S(Fe),this.notificationService=S(ue),this.suppliersService=S(je),this.host=this.apiService.host,this.currentInvoice=W({}),this.signal_submited=W(!1),this.signal_submit_loading=W(!1),this.action_status$=new Ae(""),this.selectedSupplierLatestItems=new Ae([])}chcekout(t,n){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/supply`,t).subscribe({next:r=>{this.notificationService.showSuccess("Invoice Updated","home")},error:r=>{this.notificationService.showError(r.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(t.partner_id_fk)}})}returnCheckout(t,n){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,t).subscribe({next:r=>{this.notificationService.showSuccess("Invoice Updated","home")},error:r=>{this.notificationService.showError(r.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(t.partner_id_fk)}})}deleteInvoice(t,n){let r=t.order_id;console.log(r),this.signal_submited.set(!0),this.http.delete(`${this.host}/supply/${r}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(t.partner_id_fk)}})}returnDeleteInvoice(t,n){let r=t.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${r}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{n.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(t.partner_id_fk)}})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=ge({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();var Yo=()=>({width:"95vw",height:"75vh"}),Zo=()=>({standalone:!0}),Qo=e=>({"ng-invalid ng-dirty":e}),ji=e=>({invalid:e}),Ko=(e,o)=>({"text-red-500":e,"text-orange-500":o}),Xo=e=>({"text-red-500":e});function Jo(e,o){e&1&&(a(0,"small",27),_(1,"Supplier is required."),c())}function er(e,o){e&1&&(a(0,"tr")(1,"th",28),_(2,"Barcode"),c(),a(3,"th",29),_(4,"Description"),c(),a(5,"th",30),_(6,"Unit"),c(),a(7,"th",31),_(8,"Qty"),c(),a(9,"th",30),_(10,"Total"),c(),a(11,"th",31),_(12,"Del?"),c()())}function tr(e,o){if(e&1){let i=F();a(0,"p-inputNumber",38),U("ngModelChange",function(n){C(i);let r=y().$implicit;return $(r.unit_price,n)||(r.unit_price=n),w(n)}),b("ngModelChange",function(){C(i);let n=y().$implicit,r=y(2);return w(r.setPrice(n))})("onFocus",function(n){C(i);let r=y(3);return w(r.select(n.target))}),c()}if(e&2){let i=y().$implicit;A("ngModel",i.unit_price),v("maxFractionDigits",2)("min",0)}}function ir(e,o){e&1&&H(0,"i",41)}function nr(e,o){if(e&1&&(a(0,"span",39),_(1),M(2,"currency"),a(3,"span"),N(4,ir,1,0,"i",40),c()()),e&2){let i=y().$implicit,t=y(2);v("ngClass",gt(5,Ko,!i.unit_price,t.getPriceWarining(i))),d(),T(V(2,3,i.unit_price)),d(3),v("ngIf",t.getPriceWarining(i))}}function or(e,o){if(e&1){let i=F();a(0,"p-inputNumber",42),U("ngModelChange",function(n){C(i);let r=y().$implicit;return $(r.quantity,n)||(r.quantity=n),w(n)}),b("onFocus",function(n){C(i);let r=y(3);return w(r.select(n.target))})("ngModelChange",function(){C(i);let n=y().$implicit,r=y(2);return w(r.setQty(n))}),c()}if(e&2){let i=y().$implicit;A("ngModel",i.quantity)}}function rr(e,o){if(e&1&&(a(0,"span",39),_(1),c()),e&2){let i=y().$implicit;v("ngClass",Me(2,Xo,!i.quantity)),d(),T(i.quantity)}}function sr(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td",32)(6,"p-cellEditor"),N(7,tr,1,3,"ng-template",33)(8,nr,5,8,"ng-template",34),c()(),a(9,"td",35)(10,"p-cellEditor"),N(11,or,1,1,"ng-template",33)(12,rr,2,4,"ng-template",34),c()(),a(13,"td"),_(14),M(15,"currency"),c(),a(16,"td",36),b("click",function(){let n=C(i).rowIndex,r=y(2);return w(r.removeRow(n))}),H(17,"i",37),c()()}if(e&2){let i=o.$implicit;d(2),T(i.barcode||"---"),d(2),T(i.product_name),d(),v("pEditableColumn",i.unit_price)("ngClass",Me(9,ji,!i.unit_price)),d(4),v("pEditableColumn",i.quantity)("ngClass",Me(11,ji,!i.quantity)),d(5),L(" ",V(15,7,i.unit_price*i.quantity)," ")}}function lr(e,o){if(e&1&&(a(0,"h4",44),_(1),c()),e&2){let i=y(3);d(),L(" Total units: ",i.invoiceTotal.total_qty," ")}}function ar(e,o){if(e&1&&N(0,lr,2,1,"h4",43),e&2){let i=y(2);v("ngIf",i.invoiceTotal.total_qty)}}function cr(e,o){e&1&&(a(0,"tr",45)(1,"td",46),_(2,"No data yet!"),c()())}function pr(e,o){if(e&1){let i=F();a(0,"p-card",6)(1,"div",7)(2,"div",8)(3,"div",9),H(4,"div",10),a(5,"label"),_(6,"Invoice Date"),c(),a(7,"p-calendar",11),U("ngModelChange",function(n){C(i);let r=y();return $(r.invoice_date,n)||(r.invoice_date=n),w(n)}),c()()(),a(8,"div",8)(9,"div",10)(10,"label",12),_(11,"Supplier"),a(12,"span",13),_(13," *"),c()(),a(14,"p-dropdown",14),U("ngModelChange",function(n){C(i);let r=y();return $(r.supplier_id,n)||(r.supplier_id=n),w(n)}),b("onChange",function(n){C(i);let r=y();return w(r.supplierChange(n.value))}),c(),N(15,Jo,2,0,"small",15),c()(),a(16,"div",16)(17,"h3",17),_(18),M(19,"currency"),c(),a(20,"h3",18),_(21),M(22,"lira"),c()()(),a(23,"div",7)(24,"div",19)(25,"p-table",20,0),N(27,er,13,0,"ng-template",21)(28,sr,18,13,"ng-template",3)(29,ar,1,1,"ng-template",22)(30,cr,3,0,"ng-template",23),c()(),a(31,"div",24)(32,"p-autoComplete",25,1),U("ngModelChange",function(n){C(i);let r=y();return $(r.search_product,n)||(r.search_product=n),w(n)}),b("completeMethod",function(n){C(i);let r=y();return w(r.searchItem(n))})("onKeyUp",function(n){C(i);let r=y();return w(r.submitInvoiceInput(n))}),c(),a(34,"button",26),b("click",function(){C(i);let n=y();return w(n.openProductsDialog())}),c()()()()}if(e&2){let i=y();d(7),A("ngModel",i.invoice_date),v("ngModelOptions",j(25,Zo))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),d(7),A("ngModel",i.supplier_id),v("options",i.suppliers)("filter",!0)("showClear",!0)("ngClass",Me(26,Qo,!i.supplier_id)),d(),v("ngIf",!i.supplier_id),d(3),L(" USD: ",V(19,21,i.invoiceTotal.total_dollar)," "),d(3),L(" LBP: ",V(22,23,i.invoiceTotal.total_dollar*i.invoice.exchange_rate)," "),d(4),ft("scrollHeight",i.vh),v("value",i.invoice_items())("scrollable",!0),d(7),A("ngModel",i.search_product),v("suggestions",i.matching_products)("delay",150)("autofocus",!0)}}function mr(e,o){if(e&1){let i=F();a(0,"button",47),b("click",function(){C(i);let n=y();return w(n.deleteInvoice())}),c(),a(1,"button",48),b("click",function(){C(i);let n=y();return w(n.closeEditDialog())}),c(),a(2,"p-button",49),b("click",function(){C(i);let n=y();return w(n.submitEditInvoice())}),c()}if(e&2){let i=y();v("disabled",i.submitted()),d(),v("disabled",i.submitted()),d(),v("loading",i.submitted())("disabled",i.invoice_items().length==0)}}var Gi=(()=>{let o=class o{constructor(){this.visible=!1,this.suppliers=[],this.return_invoice_edit=!1,this.onSubmit=new $e,this.onHide=new $e,this.stockService=S(It),this.editInvoiceService=S(zi),this.authService=S(Ue),this.confirmationService=S(yt),this.notificationsService=S(ue),this.supplyService=S(gi),this.dateService=S(Ct),this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new Dt,this.supplier_id=null,this.invoice_number="123",this.invoice_items=W([]),this.selectedSupplierLatestItems=[],this.productsDialogVisible=!1,this.subscriptions=new me,this.products=this.stockService.products,this.matching_products=[],this.editDialogVisible=!1,this.vh="50vh"}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(t=>{(t==="UPDATE"||t==="DELETE")&&(this.onSubmit.emit({action:t}),this.editInvoiceService.action_status$.next(""),this.visible=!1)})),this.subscriptions.add(this.supplyService.barcodeResponse.subscribe(t=>{t&&(this.addProduct(t),this.supplyService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=this.dateService.formatDate(this.invoice.order_datetime,"YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.invoice_items.set(structuredClone(this.invoice.items)),this.supplier_id=this.invoice.partner_id_fk,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_cost,this.supplierChange(this.invoice.supplier_id))}setPrice(t){t.unit_price?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}setQty(t){t.quantity?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}validateItems(){return this.invoice_items().find(n=>!n.unit_price||!n.quantity)?(this.form_error=!0,!0):(this.form_error=!1,!1)}addProduct(t){let n=this.supplyService.factor(),r=structuredClone(this.invoice_items()),s=r.find(l=>l.product_id===t.product_id);s?s.quantity+=n:r.push({product_id:t.product_id,barcode:t.barcode,product_name:t.product_name,unit_cost:t.unit_cost_usd,unit_price:t.unit_cost_usd,quantity:n,unit_abbreviation:t.unit_abbreviation,product_unit_id:t.unit_id_fk}),this.invoice_items.set(r),this.supplyService.factor.set(1),this.calculateTotal("add")}submitInvoiceInput(t){t.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.supplyService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(t){if(t){let n=-1,r=["*","+"];for(let m=0;m<r.length;m++)if(t.indexOf(r[m])!==-1){n=t.indexOf(r[m]);break}let s=t.substring(0,n)||1,l=parseInt(t.substring(n+1,t.length));n!=-1&&n!=0?(this.supplyService.factor.set(parseInt(s)),this.supplyService.submitBarcode(l)):this.supplyService.submitBarcode(t)}}calculateTotal(t){let n=new Dt,r=this.invoice_items();return r.length>0&&(r.forEach(s=>{n.total_qty+=s.quantity,n.cost_dollar+=s.unit_cost*s.quantity,n.subtotal_dollar+=s.unit_price*s.quantity}),n.total_dollar=n.subtotal_dollar-n.discount_dollar),this.invoiceTotal=n,n}submitEditInvoice(){let t=this.validateItems();!t&&this.supplier_id?this.return_invoice_edit?this.editInvoiceService.returnCheckout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.chcekout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):t&&this.notificationsService.showError("Please enter price for all items","home")}searchItem(t){let n=this.products(),r=[],s=t.query;for(let l=0;l<n.length;l++){let m=n[l];m.product_name.toLowerCase().indexOf(s.toLowerCase())>-1&&r.push(m)}this.matching_products=r}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}supplierChange(t){}removeRow(t){this.invoice_items().splice(t,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.invoice_items.set([]),this.submitted.set(!1),this.invoiceTotal=new Dt}})}deleteInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.return_invoice_edit?this.editInvoiceService.returnDeleteInvoice(this.invoice,this.stockService):this.editInvoiceService.deleteInvoice(this.invoice,this.stockService)}})}closeProductsDialog(){}assignSelectedProducts(t){this.productsDialogVisible=!1,t.forEach(n=>{this.addProduct(n)})}getPriceTypeLabel(t){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[t]}select(t){t.select()}getPriceWarining(t){if(!t.unit_price)return!1;let n=t.unit_cost||0,r=t.unit_price;return typeof n=="string"&&(n=parseFloat(n)),typeof r=="string"&&(r=parseFloat(r)),r<n}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["edit-purchase"]],inputs:{visible:"visible",invoice:"invoice",suppliers:"suppliers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[ht],decls:4,vars:9,consts:[["invoiceTable",""],["barcodeInput",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],["price","cost",3,"onHide","onSubmit","visible","products"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","supplier"],[1,"text-red-500"],["styleClass","p-inputtext-sm","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear","ngClass"],["class","p-error",4,"ngIf"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],[1,"p-error"],["width","20%"],["width","40%"],["width","15%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn","ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["min","0","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash","severity","danger",1,"w-full","mt-4","md:w-auto","md:mt-0",3,"click","disabled"],["pButton","","pRipple","","label","Cancel Edit","icon","pi pi-times",1,"p-button-secondary","w-full","mt-2","md:w-auto","md:ml-2",3,"click","disabled"],["pRipple","","label","Submit Edit","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"click","loading","disabled"]],template:function(n,r){n&1&&(a(0,"p-dialog",2),U("visibleChange",function(l){return $(r.visible,l)||(r.visible=l),l}),b("onHide",function(){return r.closeEditDialog()}),N(1,pr,35,28,"ng-template",3)(2,mr,3,4,"ng-template",4),c(),a(3,"products-dialog",5),b("onHide",function(){return r.productsDialogVisible=!1})("onSubmit",function(l){return r.assignSelectedProducts(l)}),c()),n&2&&(ve(j(8,Yo)),A("visible",r.visible),v("modal",!0)("closable",!0)("maximizable",!0),d(3),v("visible",r.productsDialogVisible)("products",r.products))},dependencies:[vt,ye,ie,bt,ze,ae,te,St,xt,oe,re,ne,Te,le,se,wt,Tt,ee,Pt],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:100%;height:28px}[_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.invalid[_ngcontent-%COMP%]{border-bottom:1px solid var(--red-500)!important}[_nghost-%COMP%]  .p-card-content{padding-top:0!important;padding-bottom:0!important}"]});let e=o;return e})();var dr=()=>[10,25,50],_r=()=>({width:"95vw"});function hr(e,o){e&1&&(a(0,"tr")(1,"th"),_(2,"Invoice #"),c(),a(3,"th"),_(4,"Supplier"),c(),a(5,"th"),_(6,"Datetime"),c(),a(7,"th"),_(8,"total"),c(),a(9,"th",19),_(10,"Options"),c()())}function fr(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),c(),a(7,"td"),_(8),M(9,"currency"),c(),a(10,"td")(11,"button",20),b("click",function(){let n=C(i).$implicit,r=y();return w(r.showInvoiceDialog(n))}),c()(),a(12,"td")(13,"button",21),b("click",function(){let n=C(i).$implicit,r=y();return w(r.openEditDialog(n))}),c()()()}if(e&2){let i=o.$implicit;d(2),T(i.invoice_number),d(2),T(i.supplier_name||"---"),d(2),T(i.order_date),d(2),T(V(9,4,i.total_cost))}}function gr(e,o){e&1&&(a(0,"tr")(1,"td",22),_(2,"No Records Found!"),c()())}function vr(e,o){e&1&&(a(0,"tr")(1,"th",25),_(2,"Barcode"),c(),a(3,"th",26),_(4,"Description"),c(),a(5,"th",25),_(6,"Unit Price"),c(),a(7,"th",27),_(8,"Qty"),c(),a(9,"th",25),_(10,"Total Price"),c()())}function yr(e,o){if(e&1&&(a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),M(7,"currency"),c(),a(8,"td"),_(9),c(),a(10,"td"),_(11),M(12,"currency"),c()()),e&2){let i=o.$implicit;d(2),T(i.barcode||"---"),d(2),T(i.product_name),d(2),L(" ",V(7,5,i.unit_cost)," "),d(3),T(i.quantity),d(2),L(" ",V(12,7,i.unit_cost*i.quantity)," ")}}function br(e,o){if(e&1&&(a(0,"tr"),H(1,"td")(2,"td")(3,"td"),a(4,"td"),_(5),c(),a(6,"td"),_(7),M(8,"currency"),c()()),e&2){let i=y(3);d(5),T(i.selectedInvoiceTotals.totalQty),d(2),L(" ",V(8,2,i.selectedInvoiceTotals.totalCost)," ")}}function Cr(e,o){if(e&1&&(a(0,"p-table",24),N(1,vr,11,0,"ng-template",12)(2,yr,13,9,"ng-template",13)(3,br,9,4,"ng-template",17),c()),e&2){let i=y(2);v("value",i.invoiceItems)}}function wr(e,o){if(e&1&&N(0,Cr,4,1,"p-table",23),e&2){let i=y();v("ngIf",i.invoiceItems.length!=0)}}function Sr(e,o){if(e&1){let i=F();a(0,"button",28),b("click",function(){C(i);let n=y();return w(n.hideInvoiceDialog())}),c()}}var Zi=(()=>{let o=class o{constructor(){this.suppliersService=S(je),this.historyService=S(De),this.decimalService=S(Ze),this.printService=S(Nt),this.suppliers=[],this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0},this.subscriptions=new me,this.purchasesHistory=this.historyService.purchasesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new we({invoice_number:new z(null),supplier_id:new z(null),invoice_date:new z(null)})}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(t=>{this.suppliers=t}))}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,Yi.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchPurchasesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPurchasesHistory(null)}showInvoiceDialog(t){this.invoiceItems=t.items,this.invoiceItems.forEach(n=>{console.log(n),this.selectedInvoiceTotals.totalQty+=n.quantity,this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,n.unit_cost*n.quantity)}),this.detailsDialogVisible=!0}printDelivery(t){}openEditDialog(t){this.selectedInvoice=t,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0}}submitEdit(t){this.historyService.fetchPurchasesHistory(this.searchForm.value)}printInvoice(t){this.printService.print(t,"sale")}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["app-supply-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","supplier_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","suppliers"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","20%"],["width","35%"],["width","5%"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),b("ngSubmit",function(){return r.submitSearch()}),a(5,"div",4)(6,"div",5),H(7,"input",6),c(),a(8,"div",5),H(9,"p-dropdown",7),c(),a(10,"div",5),H(11,"p-calendar",8),c(),a(12,"div",5),H(13,"p-button",9),a(14,"p-button",10),b("onClick",function(){return r.resetSearch()}),c()()()()(),a(15,"p-table",11),N(16,hr,11,0,"ng-template",12)(17,fr,14,6,"ng-template",13)(18,gr,3,0,"ng-template",14),c()()()(),a(19,"p-dialog",15),U("visibleChange",function(l){return $(r.detailsDialogVisible,l)||(r.detailsDialogVisible=l),l}),b("onHide",function(){return r.hideInvoiceDialog()}),N(20,wr,1,1,"ng-template",16)(21,Sr,1,0,"ng-template",17),c(),a(22,"edit-purchase",18),b("onHide",function(){return r.closeEditDialog()})("onSubmit",function(l){return r.submitEdit(l)}),c()),n&2&&(d(3),v("toggleable",!0),d(),v("formGroup",r.searchForm),d(5),v("options",r.suppliers)("filter",!0)("showClear",!0)("autoOptionFocus",!1),d(2),v("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),d(2),v("loading",r.loading()),d(),v("disabled",r.loading()),d(),v("value",r.purchasesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(28,dr))("alwaysShowPaginator",!1)("loading",r.loading()),d(4),ve(j(29,_r)),A("visible",r.detailsDialogVisible),v("modal",!0)("closable",!0)("maximizable",!0),d(3),v("visible",r.editDialogVisible)("invoice",r.selectedInvoice)("suppliers",r.suppliers))},dependencies:[ye,Se,be,ie,Ce,xe,Ee,ae,te,oe,re,ne,Te,Ie,le,se,Pe,Gi,ee]});let e=o;return e})();var xr=()=>[10,25,50];function Er(e,o){e&1&&(a(0,"tr")(1,"th"),_(2,"Payment #"),c(),a(3,"th"),_(4,"Supplier"),c(),a(5,"th"),_(6,"Datetime"),c(),a(7,"th"),_(8,"total"),c(),a(9,"th",16),_(10,"Options"),c()())}function Ir(e,o){if(e&1){let i=F();a(0,"tr")(1,"td"),_(2),c(),a(3,"td"),_(4),c(),a(5,"td"),_(6),c(),a(7,"td"),_(8),M(9,"currency"),c(),a(10,"td")(11,"button",17),b("click",function(){let n=C(i).$implicit,r=y();return w(r.printInvoice(n))}),c()(),a(12,"td")(13,"button",18),b("click",function(){let n=C(i).$implicit,r=y();return w(r.openEditDialog(n))}),c()()()}if(e&2){let i=o.$implicit;d(2),T(i.journal_number),d(2),T(i.partner_name),d(2),T(i.payment_date),d(2),T(V(9,4,i.total_value))}}function Tr(e,o){e&1&&(a(0,"tr")(1,"td",19),_(2,"No Records Found!"),c()())}var Qi=(()=>{let o=class o{constructor(){this.suppliersService=S(je),this.historyService=S(De),this.dateService=S(Ct),this.suppliers=[],this.suppliersLoading=this.suppliersService.suppliersLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.subscriptions=new me,this.receiptsHistory=this.historyService.receiptsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new we({payment_date:new z(null),partner_id:new z(null),payment_number:new z(null)})}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(t=>{this.suppliers=t}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=this.dateService.formatDate(this.searchForm.value.payment_date)),this.historyService.fetchReceiptsHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReceiptsHistory(null)}showInvoiceDialog(t){}printInvoice(t){}openEditDialog(t){this.selectedPayment=t,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(t){this.historyService.fetchReceiptsHistory(this.searchForm.value)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=J({type:o,selectors:[["app-receipts-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(n,r){n&1&&(a(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),b("ngSubmit",function(){return r.submitSearch()}),a(5,"div",4)(6,"div",5),H(7,"input",6),c(),a(8,"div",5),H(9,"p-dropdown",7),c(),a(10,"div",5),H(11,"p-calendar",8),c(),a(12,"div",5),H(13,"p-button",9),a(14,"p-button",10),b("onClick",function(){return r.resetSearch()}),c()()()()(),a(15,"p-table",11),N(16,Er,11,0,"ng-template",12)(17,Ir,14,6,"ng-template",13)(18,Tr,3,0,"ng-template",14),c()()()(),a(19,"supplier-payment-dialog",15),b("onClose",function(){return r.hidePaymentDialog()})("onSubmit",function(l){return r.getPaymentDilogResult(l)}),c()),n&2&&(d(3),v("toggleable",!0),d(),v("formGroup",r.searchForm),d(5),v("options",r.suppliers)("loading",r.suppliersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),d(2),v("showIcon",!1)("showClear",!0)("readonlyInput",!0),d(2),v("loading",r.loading()),d(),v("disabled",r.loading()),d(),v("value",r.receiptsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(22,xr))("alwaysShowPaginator",!1)("loading",r.loading()),d(4),v("visible",r.editDialogVisible)("selected_payment",r.selectedPayment)("accounts",r.suppliers))},dependencies:[Se,be,ie,Ce,xe,Ee,ae,te,oe,re,ne,Ie,le,se,Pe,kt,ee]});let e=o;return e})();var Pr=[{path:"sales-history",data:{breadcrumb:"sales"},component:qi},{path:"payment-history",data:{breadcrumb:"payments"},component:Ai},{path:"return-history",data:{breadcrumb:"returns"},component:Ui},{path:"purchases-history",data:{breadcrumb:"purchases"},component:Zi},{path:"receipts-history",data:{breadcrumb:"receipts"},component:Qi}],Ki=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=_t({type:o}),o.\u0275inj=dt({imports:[Gt.forChild(Pr),Gt]});let e=o;return e})();var ua=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=_t({type:o}),o.\u0275inj=dt({imports:[ei,Ki,ti,ii,ze,pi,oi,ni,ui,ri,si,ai,li,di,vi,ci,yi,fi,mi,Ht,kt]});let e=o;return e})();export{ua as HistoryModule};
