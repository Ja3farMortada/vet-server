import{Cb as h,J as p,N as l,hc as c,ic as u,l as o,oa as a}from"./chunk-TC4DAS4S.js";var L=(()=>{class r{constructor(){this.http=l(h),this.notificationService=l(c),this.api=l(u),this.suppliers$=new o([]),this.supplierDialogVisible$=new o(!1),this.supplierBalance$=new o([]),this.supplierTotalDebts$=new o({id:0,balance:"0"}),this.tableLoading=a(!1),this.suppliersLoading=a(!1),this.signal_balanceLoading=a(!1),this.submitLoading=a(!1),this.host=this.api.host,this.getSuppliers()}getSuppliers(){this.suppliersLoading.set(!0),this.http.get(`${this.host}/suppliers`).subscribe({next:i=>{this.suppliers$.next(i)},error:i=>{this.notificationService.handleError(i.error,"suppliers"),this.suppliersLoading.set(!1)},complete:()=>{this.suppliersLoading.set(!1)}})}createSupplier(i){this.submitLoading.set(!0),this.http.post(`${this.host}/suppliers`,i).subscribe({next:e=>{this.notificationService.showSuccess("Supplier added successfully!","home"),this.suppliers$.next([...this.suppliers$.value,e.supplier]),this.supplierDialogVisible$.next(!1)},error:e=>{this.notificationService.showError(e.error.message,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1)}})}updateSupplier(i){this.submitLoading.set(!0),this.http.put(`${this.host}/suppliers/${i.account_id}`,i).subscribe({next:e=>{let s=this.suppliers$.value.findIndex(n=>n.account_id==e.supplier.account_id),t=this.suppliers$.value;t[s]=e.supplier,this.suppliers$.next(t),this.notificationService.showSuccess("Data updated successfully!","home")},error:e=>{this.notificationService.showError(e,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1),this.supplierDialogVisible$.next(!1)}})}deleteSupplier(i){this.submitLoading.set(!0),this.http.delete(`${this.host}/suppliers/${i.account_id}`).subscribe({next:e=>{let s=this.suppliers$.value,t=s.findIndex(n=>n.account_id==i.account_id);s.splice(t,1),this.suppliers$.next(s),this.notificationService.showSuccess(e.message,"home")},error:e=>{this.notificationService.handleError(e.error,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1)}})}getSupplierTransactions(i,e,s){this.tableLoading.set(!0),this.http.get(`${this.host}/suppliers/transactions/${i}&${e}&${s}`).subscribe({next:t=>{this.supplierBalance$.next(t)},error:t=>{this.notificationService.handleError(t.error,"home"),this.tableLoading.set(!1)},complete:()=>{this.tableLoading.set(!1)}})}getAccountTotalBalance(i){this.signal_balanceLoading.set(!0),this.http.get(`${this.host}/suppliers/${i}/balance`).subscribe({next:e=>{this.supplierTotalDebts$.next(e)},error:e=>{this.notificationService.handleError(e.error,"home"),this.signal_balanceLoading.set(!1)},complete:()=>{this.signal_balanceLoading.set(!1)}})}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{L as a};
