import{a as ye,b as Ue}from"./chunk-APNGSJYW.js";import{a as Ee,b as Te}from"./chunk-AS7BFKTN.js";import"./chunk-2UFRC7H2.js";import{b as Ce}from"./chunk-NEXFYW5Q.js";import"./chunk-6M5CHABF.js";import{b as ge,d as we,g as ve,o as xe}from"./chunk-YXGZ3Y4J.js";import{a as ue,b as _e}from"./chunk-KWHJ4U2D.js";import"./chunk-PTV2L6W6.js";import{i as fe,j as he}from"./chunk-6CJYKBUA.js";import{a as be,b as Se}from"./chunk-KTNSRC6L.js";import"./chunk-THDET7PA.js";import{A as w,Aa as B,Ab as I,B as P,Ba as q,Bb as z,C as V,Ca as D,Da as l,Ea as v,Gb as H,H as u,Ha as A,I as _,Ia as G,Ja as W,Ma as y,Na as F,Pb as J,Sb as X,Ub as Z,V as r,Wb as U,Yb as ee,Zb as te,aa as S,bc as ie,cc as ne,da as g,db as Q,dc as oe,ec as se,fa as p,fb as $,fc as re,gc as le,hc as ae,i as O,ia as k,jb as K,k as R,ka as b,la as o,lb as Y,ma as i,na as m,qc as me,ra as C,sa as h,sc as pe,ta as c,tc as de,uc as ce,w as L,x as T,za as j}from"./chunk-FYHOXPUP.js";var Ve=(()=>{let n=class n{constructor(){this.http=w(Y),this.api=w(z),this.notificationService=w(X),this.host=this.api.host,this.userDialogVisible=S(!1),this.users=S([]),this.usersLoading=S(!1),this.loading=S(!1),this.selectedUser=S(null),this.existedUsernameError=new R,this.getUsers()}getUsers(){this.usersLoading.set(!0),this.http.get(`${this.host}/users`).subscribe({next:a=>{this.users.set(a),this.usersLoading.set(!1)},error:a=>{this.usersLoading.set(!1),this.notificationService.handleError(a.error,"users")}})}createUser(a){this.usersLoading.set(!0),this.http.post(`${this.host}/users`,a).subscribe({next:s=>{this.users.set([...this.users(),s]),this.loading.set(!1),this.usersLoading.set(!1),this.userDialogVisible.set(!1),this.notificationService.showSuccess("User added successfully!","users")},error:s=>{s.status==406?(this.loading.set(!1),this.existedUsernameError.next()):this.notificationService.handleError(s.error,"users"),this.usersLoading.set(!1)}})}updateUser(a){this.http.put(`${this.host}/users`,a).subscribe({next:s=>{this.users.update(d=>{let f=this.users().findIndex(x=>x.user_id===a.user_id);return[...d.slice(0,f),s,...d.slice(f+1)]}),this.userDialogVisible.set(!1),this.selectedUser.set(a),this.loading.set(!1),this.notificationService.showSuccess("User updated successfully!","users")},error:s=>{s.status==406?this.existedUsernameError.next():this.notificationService.handleError(s.error,"users"),this.loading.set(!1)}})}deleteUser(a){this.http.delete(`${this.host}/users/${a.user_id}`).subscribe({next:s=>{this.users.update(d=>{let f=this.users().findIndex(x=>x.user_id===a.user_id);return d.splice(f,1),[...d]}),this.notificationService.showSuccess(s.message,"users")},error:s=>{this.notificationService.handleError(s.error,"users")}})}};n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var De=["name"],Ie=()=>[10,15,50,100],Ne=()=>["username","first_name","last_name"],Fe=()=>({width:"50vw"}),Me=()=>({"1199px":"75vw","575px":"95vw"}),M=t=>({"ng-invalid ng-dirty":t});function Oe(t,n){if(t&1){let e=C();o(0,"div",16)(1,"span",17),m(2,"i",18),o(3,"input",19,1),h("input",function(s){u(e),c();let d=D(6);return _(d.filterGlobal(s.target.value,"contains"))}),i()()(),o(5,"button",20),h("click",function(){u(e);let s=c();return _(s.refresh())}),i(),o(6,"button",21),h("click",function(){u(e);let s=c();return _(s.openUserDialog("add"))}),i()}if(t&2){c();let e=D(6);r(3),p("value",e.filters.global==null?null:e.filters.global.value)}}function Re(t,n){if(t&1){let e=C();o(0,"button",22),h("click",function(){u(e);let s=c();return _(s.openUserDialog("edit"))}),i(),o(1,"button",23),h("click",function(){u(e);let s=c();return _(s.deleteSelectedUser())}),i()}if(t&2){let e=c();p("disabled",!e.selectedUser()),r(),p("disabled",!e.selectedUser())}}function Le(t,n){t&1&&(o(0,"tr")(1,"th",24),l(2,"Username"),i(),o(3,"th",24),l(4,"First Name"),i(),o(5,"th",24),l(6,"Last Name"),i(),o(7,"th",24),l(8,"Last Login"),i(),o(9,"th",25),l(10,"Permissions"),i()(),o(11,"tr")(12,"th"),l(13,"Edit Pets"),i(),o(14,"th"),l(15,"Show Stock"),i(),o(16,"th"),l(17,"Show Cost"),i(),o(18,"th"),l(19,"Edit Invoice"),i(),o(20,"th"),l(21,"Delete Invoice"),i(),o(22,"th"),l(23,"Show Reports"),i()())}function Pe(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function je(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function Be(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function qe(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function Ae(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function Ge(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function We(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function Qe(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function $e(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function Ke(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function Ye(t,n){t&1&&(o(0,"td"),m(1,"i",27),i())}function ze(t,n){t&1&&(o(0,"td"),m(1,"i",28),i())}function Je(t,n){if(t&1&&(o(0,"tr",26)(1,"td"),l(2),i(),o(3,"td"),l(4),i(),o(5,"td"),l(6),i(),o(7,"td"),l(8),i(),g(9,Pe,2,0,"td")(10,je,2,0,"td")(11,Be,2,0,"td")(12,qe,2,0,"td")(13,Ae,2,0,"td")(14,Ge,2,0,"td")(15,We,2,0,"td")(16,Qe,2,0,"td")(17,$e,2,0,"td")(18,Ke,2,0,"td")(19,Ye,2,0,"td")(20,ze,2,0,"td"),i()),t&2){let e=n.$implicit;p("pSelectableRow",e),r(2),v(e.username),r(2),v(e.first_name||" --- "),r(2),v(e.last_name||" --- "),r(2),v(e.last_login||"Never logged in yet!"),r(),b(e.edit_pets?9:10),r(2),b(e.show_stock?11:12),r(2),b(e.show_cost?13:14),r(2),b(e.edit_invoice?15:16),r(2),b(e.delete_invoice?17:18),r(2),b(e.show_reports?19:20)}}function Xe(t,n){t&1&&(o(0,"tr")(1,"td",29),l(2,"No records yet!"),i()())}function Ze(t,n){if(t&1&&(o(0,"small",49),l(1),i()),t&2){let e=c(2);r(),v(e.username.errors.error||"this field is required!")}}function et(t,n){if(t&1&&(o(0,"small",49),l(1),i()),t&2){let e=c(3);r(),v(e.password.errors.error||"this field is required!")}}function tt(t,n){if(t&1&&(o(0,"div",32)(1,"label",50),l(2,"Password*"),i(),m(3,"input",51),g(4,et,2,1,"small",35),i()),t&2){let e=c(2);r(3),p("ngClass",F(2,M,(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.dirty)||(e.password==null?null:e.password.touched)||e.submitted))),r(),p("ngIf",(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.dirty)||(e.password==null?null:e.password.touched)||e.submitted))}}function it(t,n){if(t&1&&(o(0,"small",49),l(1),i()),t&2){let e=c(3);r(),v(e.confirm_password.errors.error||"this field is required!")}}function nt(t,n){if(t&1&&(o(0,"div",32)(1,"label",52),l(2,"Confirm Password*"),i(),m(3,"input",53),g(4,it,2,1,"small",35),i()),t&2){let e=c(2);r(3),p("ngClass",F(2,M,(e.confirm_password==null?null:e.confirm_password.invalid)&&((e.confirm_password==null?null:e.confirm_password.dirty)||(e.confirm_password==null?null:e.confirm_password.touched)||e.submitted))),r(),p("ngIf",(e.confirm_password==null?null:e.confirm_password.invalid)&&((e.confirm_password==null?null:e.confirm_password.dirty)||(e.confirm_password==null?null:e.confirm_password.touched)||e.submitted))}}function ot(t,n){if(t&1){let e=C();o(0,"form",30),h("ngSubmit",function(){u(e);let s=c();return _(s.submitUser())}),o(1,"div",31)(2,"div",32)(3,"label",33),l(4,"Username*"),i(),m(5,"input",34,2),g(7,Ze,2,1,"small",35),i(),g(8,tt,5,4,"div",36)(9,nt,5,4,"div",36),i(),o(10,"div",31)(11,"div",37)(12,"label",38),l(13,"First Name"),i(),m(14,"input",39),i(),o(15,"div",37)(16,"label",40),l(17,"Last Name"),i(),m(18,"input",41),i()(),o(19,"div",31)(20,"div",42)(21,"label"),l(22,"Edit Pets?"),i(),m(23,"p-dropdown",43),i(),o(24,"div",42)(25,"label"),l(26,"Show Stock?"),i(),m(27,"p-dropdown",44),i(),o(28,"div",42)(29,"label"),l(30,"Show Cost?"),i(),m(31,"p-dropdown",45),i(),o(32,"div",42)(33,"label"),l(34,"Edit Invoice?"),i(),m(35,"p-dropdown",46),i(),o(36,"div",42)(37,"label"),l(38,"Delete Invoice?"),i(),m(39,"p-dropdown",47),i(),o(40,"div",42)(41,"label"),l(42,"Show Reports"),i(),m(43,"p-dropdown",48),i()()()}if(t&2){let e=c();p("formGroup",e.userForm),r(5),p("ngClass",F(17,M,(e.username==null?null:e.username.invalid)&&((e.username==null?null:e.username.dirty)||(e.username==null?null:e.username.touched)||e.submitted))),r(2),p("ngIf",(e.username==null?null:e.username.invalid)&&((e.username==null?null:e.username.dirty)||(e.username==null?null:e.username.touched)||e.submitted)),r(),p("ngIf",e.dialogMode=="add"),r(),p("ngIf",e.dialogMode=="add"),r(14),p("options",e.permissionOptions)("autoOptionFocus",!1),r(4),p("options",e.permissionOptions)("autoOptionFocus",!1),r(4),p("options",e.permissionOptions)("autoOptionFocus",!1),r(4),p("options",e.permissionOptions)("autoOptionFocus",!1),r(4),p("options",e.permissionOptions)("autoOptionFocus",!1),r(4),p("options",e.permissionOptions)("autoOptionFocus",!1)}}function st(t,n){if(t&1){let e=C();o(0,"button",54),h("click",function(){u(e);let s=c();return _(s.closeUserDialog())}),i(),o(1,"button",55),h("click",function(){u(e);let s=c();return _(s.submitUser())}),i()}if(t&2){let e=c();r(),p("loading",e.loading())}}var He=(()=>{let n=class n{constructor(){this.usersService=w(Ve),this.confirmationService=w(H),this.fb=w(re),this.subscriptions=new O,this.usersLoading=this.usersService.usersLoading,this.users=this.usersService.users,this.userDialogVisible=this.usersService.userDialogVisible,this.loading=this.usersService.loading,this.selectedUser=this.usersService.selectedUser,this.submitted=!1,this.permissionOptions=[{name:"Yes",value:1},{name:"No",value:0}],this.userForm=this.fb.group({user_id:[null],username:[null,U.required],password:[null],confirm_password:[null],first_name:[null],last_name:[null],edit_pets:[0],show_stock:[0],show_cost:[0],edit_invoice:[0],delete_invoice:[0],show_reports:[0]})}ngOnInit(){this.usersService.selectedUser.set(null),this.subscriptions.add(this.usersService.existedUsernameError.subscribe(()=>{this.name.nativeElement.select(),this.userForm.controls.username.setErrors({error:"Username already exists"})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}refresh(){this.usersService.getUsers()}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get confirm_password(){return this.userForm.get("confirm_password")}openUserDialog(a){this.dialogMode=a,this.dialogMode=="add"?this.usersService.userDialogVisible.set(!0):this.dialogMode=="edit"&&(this.userForm.patchValue(this.selectedUser()),this.usersService.userDialogVisible.set(!0))}submitUser(){this.submitted=!0,this.dialogMode=="add"?(this.userForm.controls.password.addValidators([U.required]),this.userForm.controls.confirm_password.addValidators([U.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.userForm.value.password===this.userForm.value.confirm_password?this.confirmationService.confirm({key:"users",message:"Are you sure that you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.usersService.loading.set(!0),this.usersService.createUser(this.userForm.value)},reject:()=>{this.submitted=!1}}):(this.userForm.controls.password.setErrors({error:"password didnt match!"}),this.userForm.controls.confirm_password.setErrors({error:"password didnt match!"})))):(this.userForm.controls.password.removeValidators([U.required]),this.userForm.controls.confirm_password.removeValidators([U.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.usersService.loading.set(!0),this.usersService.updateUser(this.userForm.value)))}deleteSelectedUser(){this.confirmationService.confirm({key:"users",message:"Are you sure that you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.usersService.deleteUser(this.selectedUser())}})}closeUserDialog(){this.usersService.userDialogVisible.set(!1)}resetDialog(){this.submitted=!1,this.usersService.userDialogVisible.set(!1),this.userForm.reset({edit_pets:0,show_stock:0,show_cost:0,edit_invoice:0,delete_invoice:0,show_reports:0})}selectUser(a){this.usersService.selectedUser.set(a.data)}unselectUser(){this.usersService.selectedUser.set(null)}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=P({type:n,selectors:[["app-users-home"]],viewQuery:function(s,d){if(s&1&&j(De,5),s&2){let f;B(f=q())&&(d.name=f.first)}},decls:15,vars:21,consts:[["dt",""],["tableSearch",""],["name",""],[1,"grid","m-1"],[1,"col-12"],["styleClass","p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single","dataKey","user_id",3,"onRowSelect","onRowUnselect","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","top","header","User","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],["key","users"],[1,"flex"],[1,"p-input-icon-left","mr-auto"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["pButton","","pRipple","","label","Refresh","icon","pi pi-refresh",1,"p-button-primary","ml-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","New User","icon","pi pi-plus",1,"p-button-success","ml-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],["rowspan","2"],["colspan","6"],[3,"pSelectableRow"],[1,"pi","pi-check-circle","text-green-600"],[1,"pi","pi-times-circle","text-red-600"],["colspan","4"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],["for","name"],["type","text","pInputText","","formControlName","username","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],["class","field col-12 md:col-4",4,"ngIf"],[1,"field","col-12","md:col-6"],["for","first_name"],["id","first_name","type","text","pInputText","","formControlName","first_name","spellcheck","false"],["for","last_name"],["id","last_name","type","text","pInputText","","formControlName","last_name","spellcheck","false"],[1,"field","col-12","md:col-3"],["appendTo","body","formControlName","edit_pets","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],["appendTo","body","formControlName","show_stock","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],["appendTo","body","formControlName","show_cost","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],["appendTo","body","formControlName","edit_invoice","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],["appendTo","body","formControlName","delete_invoice","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],["appendTo","body","formControlName","show_reports","optionLabel","name","optionValue","value",3,"options","autoOptionFocus"],[1,"p-error"],["for","password"],["id","password","type","password","pInputText","","formControlName","password","required","","spellcheck","false",3,"ngClass"],["for","confirm_password"],["id","confirm_password","type","password","pInputText","","formControlName","confirm_password","required","","spellcheck","false",3,"ngClass"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click","loading"]],template:function(s,d){if(s&1){let f=C();o(0,"div",3)(1,"div",4)(2,"p-toolbar",5),g(3,Oe,7,1,"ng-template",6)(4,Re,2,2,"ng-template",7),i(),o(5,"p-table",8,0),h("onRowSelect",function(E){return u(f),_(d.selectUser(E))})("onRowUnselect",function(){return u(f),_(d.unselectUser())}),g(7,Le,24,0,"ng-template",9)(8,Je,21,11,"ng-template",10)(9,Xe,3,0,"ng-template",11),i()()(),o(10,"p-dialog",12),W("visibleChange",function(E){return u(f),G(d.userDialogVisible,E)||(d.userDialogVisible=E),_(E)}),h("onHide",function(){return u(f),_(d.resetDialog())}),g(11,ot,44,19,"ng-template",13)(12,st,2,1,"ng-template",14),i(),m(13,"p-toast",15)(14,"p-confirmDialog",15)}s&2&&(r(5),p("value",d.users())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",y(16,Ie))("alwaysShowPaginator",!1)("globalFilterFields",y(17,Ne))("filterDelay",0)("loading",d.usersLoading()),r(5),k(y(18,Fe)),A("visible",d.userDialogVisible),p("modal",!0)("breakpoints",y(19,Me)),r(4),k(y(20,Fe)))},dependencies:[Q,$,ie,Z,ee,te,se,ne,oe,we,J,ve,me,ue,de,Ee,ye,be,fe]});let t=n;return t})();var rt=[{path:"",component:He}],ke=(()=>{let n=class n{};n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=V({type:n}),n.\u0275inj=T({imports:[I.forChild(rt),I]});let t=n;return t})();var Zt=(()=>{let n=class n{};n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=V({type:n}),n.\u0275inj=T({providers:[H],imports:[K,le,ae,ke,xe,pe,_e,ce,Te,Ue,Se,ge,he,Ce]});let t=n;return t})();export{Zt as UsersModule};
