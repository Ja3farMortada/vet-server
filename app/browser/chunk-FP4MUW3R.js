import{a as p,b as u}from"./chunk-IX4GZOPW.js";import{Cb as h,G as n,J as a,Lb as m,N as s,Sb as g,hc as c,oa as i}from"./chunk-LELVKHSM.js";var P=(()=>{let t=class t{constructor(){this.notificationService=s(c),this.http=s(h),this.tokenStorage=s(p),this.router=s(m),this.api=s(g),this.userService=s(u),this.host=this.api.host,this.isLoggedIn=i(this.tokenStorage.getToken()!==null),this.isAdmin=i(this.tokenStorage.getType()==="admin"),this.userPermissions=i(this.tokenStorage.getPermissions())}login(r){return this.http.post(`${this.host}/auth/login`,{username:r.username,password:r.password}).pipe(n(e=>{this.tokenStorage.saveUser(e.username),this.tokenStorage.saveType(e.user_type),this.tokenStorage.saveToken(e.token),this.tokenStorage.saveName(e.first_name),this.tokenStorage.savePermissions(e.permissions),this.userService.loggedInUser.set(e.username),this.userService.loggedInName.set(e.first_name),this.userService.userType.set(e.user_type),this.isLoggedIn.set(!0),this.isAdmin.set(e.user_type==="admin"),this.userPermissions.set(e.permissions),this.router.navigate(["/home"])}))}logout(){this.userService.resetUser(),window.sessionStorage.clear(),this.isLoggedIn.set(!1),this.isAdmin.set(!1),this.userPermissions.set(null),this.router.navigate(["/login"])}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();export{P as a};
