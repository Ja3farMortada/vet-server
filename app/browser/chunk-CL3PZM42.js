import{a as rt}from"./chunk-HIGUTSEH.js";import{b as dt}from"./chunk-I3T3FLNS.js";import{a as tt,b as xt,c as wt}from"./chunk-O5PG2LU7.js";import{a as ot,c as Tt}from"./chunk-GYAL3TIA.js";import{a as we}from"./chunk-BIRBFVEA.js";import{a as it,b as Et,d as xe}from"./chunk-XTTBN5M2.js";import{b as It,d as Dt}from"./chunk-GWYW22Z3.js";import{a as Ee}from"./chunk-RTGN4KEU.js";import{a as nt}from"./chunk-VVB47BQR.js";import{a as Je}from"./chunk-M2SC5N44.js";import{a as pe}from"./chunk-GP6B5D5B.js";import{a as Xe}from"./chunk-WEDDWWHJ.js";import{a as ie,b as et}from"./chunk-S3UYYJDN.js";import{a as se}from"./chunk-3U4LVYM6.js";import{c as te}from"./chunk-M6PPFD3I.js";import"./chunk-P6HEUOS7.js";import{a as bt,b as Ze}from"./chunk-OZP7HNKL.js";import{b as je,c as yt,f as O,j as Ct,k as Ke,l as Qe,q as Ue}from"./chunk-O7Y33RWW.js";import{b as St}from"./chunk-WLZVRSNO.js";import"./chunk-RWK74YMD.js";import{a as De,b as le}from"./chunk-JLYTJQKU.js";import"./chunk-O2Z7APEW.js";import{a as B,b as qe}from"./chunk-3SSLHLWI.js";import{i as L,j as Ye,m as R,n as Ge}from"./chunk-SOXUPN2Q.js";import{$a as re,Aa as o,Ab as Re,Ba as y,C as He,Cb as ae,Fa as x,Ga as d,Ha as p,Ic as Y,J as oe,Jc as N,K as Me,Ka as Be,Kc as Ae,Lc as j,Mc as $e,N as h,O as V,P as Fe,Ra as l,Rb as mt,Sa as g,Ta as S,U as ke,V as _,Va as w,W as u,Wa as E,Xa as T,Xb as Oe,Za as ut,_ as ye,_a as I,a as pt,ab as Ce,b as ct,bb as ht,bd as ee,cd as vt,ec as F,g as Ie,ha as a,hb as C,hc as q,i as G,ib as b,ic as A,kc as $,l as ve,oa as D,oc as k,pc as Q,qc as U,ra as v,rc as P,sb as gt,sc as Se,ta as c,tc as J,ub as be,uc as X,va as _t,vb as Ne,vc as Z,wa as W,wb as K,wc as We,xc as Le,yc as ze,za as n,zb as M,zc as ft}from"./chunk-TC4DAS4S.js";var ne=(()=>{class t{constructor(){this.http=h(ae),this.apiService=h(A),this.notificationService=h(q),this.salesHistory=D([]),this.deletedHistory=D([]),this.paymentsHistory=D([]),this.signal_loading=D(!1),this.moneyTransfersHistory=D([]),this.returnHistory=D([]),this.receiptsHistory=D([]),this.purchasesHistory=D([])}fetchSalesHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/sales/search`,e).subscribe({next:r=>{this.salesHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchDeletedHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/deleted/search`,e).subscribe({next:r=>{this.deletedHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchPaymentHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/payment/search`,e).subscribe({next:r=>{this.paymentsHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchMoneyTransferHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/money-transfer/search`,e).subscribe({next:r=>{this.moneyTransfersHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchReturnHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/return/search`,e).subscribe({next:r=>{this.returnHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchPurchasesHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/purchase/search`,e).subscribe({next:r=>{this.purchasesHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}fetchReceiptsHistory(e){this.signal_loading.set(!0),this.http.post(`${this.apiService.host}/history/receipt/search`,e).subscribe({next:r=>{this.receiptsHistory.set(r),this.signal_loading.set(!1)},error:r=>{this.signal_loading.set(!1),this.notificationService.handleError(r.error,"home")}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ft=Ie(De());var at=(()=>{class t{constructor(){this.http=h(ae),this.api=h(A),this.notificationService=h(q),this.whatsappLoading=D(!1)}sendMessage(e){this.whatsappLoading.set(!0),this.http.post(`${this.api.host}/send-whatsapp`,e).subscribe({next:r=>{this.notificationService.showInfo(r.message,"home",!1),this.whatsappLoading.set(!1)},error:r=>{this.whatsappLoading.set(!1),this.notificationService.showError("Error sending whatsapp!","home")}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Pt=(()=>{class t{constructor(){this.apiService=h(A),this.http=h(ae),this.notificationService=h(q),this.customersService=h(te),this.host=this.apiService.host,this.currentInvoice=D({}),this.signal_submited=D(!1),this.signal_submit_loading=D(!1),this.action_status$=new ve(""),this.selectedCustomerLatestItems=new ve([])}checkout(e,r){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/sell-orders`,e).subscribe({next:i=>{this.notificationService.showSuccess("Invoice Updated","home")},error:i=>{this.notificationService.showError(i.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(e.customer_id)}})}returnCheckout(e,r){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,e).subscribe({next:i=>{this.notificationService.showSuccess("Invoice Updated","home")},error:i=>{this.notificationService.showError(i.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.customersService.getCustomerTotalBalance(e.customer_id)}})}deleteInvoice(e,r){let i=e.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/sell-orders/${i}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(e.customer_id)}})}returnDeleteInvoice(e,r){let i=e.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${i}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.customersService.getCustomerTotalBalance(e.customer_id)}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Vt=Ie(De());var Zt=()=>({width:"95vw",height:"75vh"}),ei=()=>({width:"65vw"}),ti=()=>({"1199px":"75vw","575px":"95vw"}),ii=()=>({width:"35vw"}),ni=()=>({standalone:!0}),oi=t=>({invalid:t}),ri=t=>({"text-orange-500":t}),ai=t=>({selected:t});function li(t,m){t&1&&(n(0,"tr")(1,"th",31),l(2,"Barcode"),o(),n(3,"th",32),l(4,"Description"),o(),n(5,"th",33),l(6,"Unit"),o(),n(7,"th",33),l(8,"Discount"),o(),n(9,"th",34),l(10,"Qty"),o(),n(11,"th",33),l(12,"Total"),o(),n(13,"th",34),l(14,"Del?"),o()())}function si(t,m){if(t&1){let e=x();n(0,"p-inputNumber",42),T("ngModelChange",function(i){_(e);let s=p().$implicit;return E(s.unit_price,i)||(s.unit_price=i),u(i)}),d("ngModelChange",function(){_(e);let i=p().$implicit,s=p(2);return u(s.setPrice(i))})("onFocus",function(i){_(e);let s=p(3);return u(s.select(i.target))}),o()}if(t&2){let e=p().$implicit;w("ngModel",e.unit_price),c("maxFractionDigits",2)("min",0)}}function pi(t,m){t&1&&y(0,"i",45)}function ci(t,m){if(t&1&&(n(0,"span",43),l(1),C(2,"currency"),n(3,"span"),v(4,pi,1,0,"i",44),o()()),t&2){let e=p().$implicit,r=p(2);c("ngClass",re(5,ri,r.getPriceWarining(e))),a(),g(b(2,3,e.unit_price)),a(3),c("ngIf",r.getPriceWarining(e))}}function mi(t,m){if(t&1){let e=x();n(0,"p-inputNumber",46,2),T("ngModelChange",function(i){_(e);let s=p().$implicit;return E(s.discount_percentage,i)||(s.discount_percentage=i),u(i)}),d("ngModelChange",function(){_(e);let i=p().rowIndex,s=p(2);return u(s.onDiscountChange(i))})("onFocus",function(i){_(e);let s=p(3);return u(s.select(i.target))}),o()}if(t&2){let e=p().$implicit;w("ngModel",e.discount_percentage),c("maxFractionDigits",2)("min",0)}}function di(t,m){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=p().$implicit;a(),S("",e.discount_percentage,"%")}}function _i(t,m){if(t&1){let e=x();n(0,"p-inputNumber",47),T("ngModelChange",function(i){_(e);let s=p().$implicit;return E(s.quantity,i)||(s.quantity=i),u(i)}),d("onFocus",function(i){_(e);let s=p(3);return u(s.select(i.target))})("ngModelChange",function(){_(e);let i=p().$implicit,s=p(2);return u(s.setQty(i))}),o()}if(t&2){let e=p().$implicit;w("ngModel",e.quantity),c("maxFractionDigits",2)("minFractionDigits",0)}}function ui(t,m){if(t&1&&(n(0,"span"),l(1),o()),t&2){let e=p().$implicit;a(),g(e.quantity)}}function hi(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),y(5,"br"),n(6,"small"),l(7),o()(),n(8,"td",35)(9,"p-cellEditor"),v(10,si,1,3,"ng-template",36)(11,ci,5,7,"ng-template",37),o()(),n(12,"td",38)(13,"p-cellEditor"),v(14,mi,2,3,"ng-template",36)(15,di,2,1,"ng-template",37),o()(),n(16,"td",39)(17,"p-cellEditor"),v(18,_i,1,3,"ng-template",36)(19,ui,2,1,"ng-template",37),o()(),n(20,"td"),l(21),C(22,"currency"),o(),n(23,"td",40),d("click",function(){let i=_(e).rowIndex,s=p(2);return u(s.removeRow(i))}),y(24,"i",41),o()()}if(t&2){let e=m.$implicit;a(2),g(e.barcode||"---"),a(2),S(" ",e.product_name," "),a(3),g(e.expiry_date),a(),c("pEditableColumn",e.unit_price),a(4),c("pEditableColumn",e.discount_percentage),a(4),c("pEditableColumn",e.quantity)("ngClass",re(10,oi,!e.quantity)),a(5),S(" ",b(22,8,e.unit_price*e.quantity)," ")}}function gi(t,m){if(t&1&&(n(0,"h4",49),l(1),o()),t&2){let e=p(3);a(),S(" Total units: ",e.invoiceTotal.total_qty," ")}}function fi(t,m){if(t&1&&v(0,gi,2,1,"h4",48),t&2){let e=p(2);c("ngIf",e.invoiceTotal.total_qty)}}function vi(t,m){t&1&&(n(0,"tr",50)(1,"td",51),l(2,"No data yet!"),o()())}function yi(t,m){if(t&1){let e=x();n(0,"p-card",10)(1,"div",11)(2,"div",12)(3,"div",13),y(4,"div",14),n(5,"label"),l(6,"Invoice Date"),o(),n(7,"p-calendar",15),T("ngModelChange",function(i){_(e);let s=p();return E(s.invoice_date,i)||(s.invoice_date=i),u(i)}),o()()(),n(8,"div",12)(9,"div",14)(10,"label",16),l(11,"Customer"),o(),n(12,"p-dropdown",17),T("ngModelChange",function(i){_(e);let s=p();return E(s.customer_id,i)||(s.customer_id=i),u(i)}),d("onChange",function(i){_(e);let s=p();return u(s.customerChange(i.value))}),o()()(),n(13,"div",18)(14,"h3",19),l(15),C(16,"currency"),o(),n(17,"h3",20),l(18),C(19,"lira"),o()()(),n(20,"div",11)(21,"div",21)(22,"p-table",22,0),d("onEditComplete",function(i){_(e);let s=p();return u(s.onEditComplete(i))}),v(24,li,15,0,"ng-template",23)(25,hi,25,12,"ng-template",4)(26,fi,1,1,"ng-template",24)(27,vi,3,0,"ng-template",25),o()(),n(28,"div",26)(29,"p-autoComplete",27,1),T("ngModelChange",function(i){_(e);let s=p();return E(s.search_product,i)||(s.search_product=i),u(i)}),d("completeMethod",function(i){_(e);let s=p();return u(s.searchItem(i))})("onKeyUp",function(i){_(e);let s=p();return u(s.submitInvoiceInput(i))}),o(),n(31,"button",28),d("click",function(){_(e);let i=p();return u(i.openProductsDialog())}),o()(),y(32,"div",26),n(33,"div",26)(34,"label",29),l(35,"Reason:"),o(),n(36,"input",30),T("ngModelChange",function(i){_(e);let s=p();return E(s.update_reason,i)||(s.update_reason=i),u(i)}),o()()()()}if(t&2){let e=p();a(7),w("ngModel",e.invoice_date),c("ngModelOptions",I(26,ni))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),a(5),w("ngModel",e.customer_id),c("options",e.customers)("filter",!0)("showClear",!0),a(3),S(" USD: ",b(16,22,e.invoiceTotal.total_dollar)," "),a(3),S(" LBP: ",b(19,24,e.invoiceTotal.total_dollar*e.invoice.exchange_rate)," "),a(4),Be("scrollHeight",e.vh),c("value",e.order_items)("scrollable",!0),a(7),w("ngModel",e.search_product),c("suggestions",e.matching_products)("delay",150)("autofocus",!0),a(7),_t("invalid",!e.update_reason),w("ngModel",e.update_reason)}}function Ci(t,m){if(t&1){let e=x();n(0,"p-button",55),d("onClick",function(){_(e);let i=p(2);return u(i.deleteDialogVisible=!0)}),o()}if(t&2){let e=p(2);c("disabled",e.submitted())}}function bi(t,m){if(t&1){let e=x();v(0,Ci,1,1,"p-button",52),n(1,"p-button",53),d("onClick",function(){_(e);let i=p();return u(i.closeEditDialog())}),o(),n(2,"p-button",54),d("onClick",function(){_(e);let i=p();return u(i.submitEditInvoice())}),o()}if(t&2){let e=p();c("ngIf",e.userPermissions().delete_invoice),a(),c("disabled",e.submitted()),a(),c("loading",e.submitted())("disabled",e.order_items.length==0||!e.update_reason)}}function Si(t,m){if(t&1){let e=x();n(0,"div",57)(1,"div",58),d("click",function(){let i=_(e).$implicit,s=p(2);return u(s.selectedVariant=i)}),n(2,"p"),l(3),y(4,"br"),n(5,"small"),l(6),o()()()()}if(t&2){let e=m.$implicit,r=p(2);a(),c("ngClass",re(3,ai,r.selectedVariant==e)),a(2),S(" ",e.expiry_date," "),a(3),S("Current qty: ",e.variant_quantity,"")}}function xi(t,m){if(t&1&&(n(0,"div",11),v(1,Si,7,5,"div",56),o()),t&2){let e=p();a(),c("ngForOf",e.productToAdd==null?null:e.productToAdd.variants_records)}}function wi(t,m){if(t&1){let e=x();n(0,"p-button",59),d("onClick",function(){_(e);let i=p();return u(i.variantDialogVisible=!1)}),o(),n(1,"p-button",60),d("onClick",function(){_(e);let i=p();return u(i.submitVariant())}),o()}}function Ei(t,m){if(t&1){let e=x();n(0,"div",61)(1,"div",62)(2,"label",63),l(3,"Delete Reason"),o(),n(4,"input",64),T("ngModelChange",function(i){_(e);let s=p();return E(s.deleteNote,i)||(s.deleteNote=i),u(i)}),o()()()}if(t&2){let e=p();a(4),w("ngModel",e.deleteNote)}}function Ti(t,m){if(t&1){let e=x();n(0,"p-button",65),d("onClick",function(){_(e);let i=p();return u(i.deleteDialogVisible=!1)}),o(),n(1,"p-button",66),d("onClick",function(){_(e);let i=p();return u(i.confirmDelete())}),o()}if(t&2){let e=p();a(),c("disabled",!e.deleteNote)("loading",e.loadingSubmitDelete)}}var lt=(()=>{class t{constructor(){this.visible=!1,this.customers=[],this.return_invoice_edit=!1,this.onSubmit=new ye,this.onHide=new ye,this.stockService=h(Je),this.editInvoiceService=h(Pt),this.authService=h(pe),this.confirmationService=h(Oe),this.notificationsService=h(q),this.sellService=h(wt),this.fb=h(Le),this.api=h(A),this.notification=h(q),this.customersService=h(te),this.userPermissions=this.authService.userPermissions,this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new tt,this.order_items=[],this.customer_id=null,this.invoice_number="123",this.selected_price_type="latest",this.selectedCustomerLatestItems=[],this.update_reason=null,this.productsDialogVisible=!1,this.subscriptions=new G,this.products=this.stockService.products,this.matching_products=[],this.priceTypes=Object.keys(xt),this.editDialogVisible=!1,this.vh="50vh",this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null,this.deleteDialogVisible=!1,this.deleteNote=null,this.loadingSubmitDelete=!1}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(e=>{(e==="UPDATE"||e==="DELETE")&&(this.onSubmit.emit({action:e}),this.editInvoiceService.action_status$.next(""),this.visible=!1,this.update_reason=null)})),this.subscriptions.add(this.editInvoiceService.selectedCustomerLatestItems.subscribe(e=>{this.selectedCustomerLatestItems=e})),this.subscriptions.add(this.sellService.barcodeResponse.subscribe(e=>{e&&(this.addProduct(e),this.sellService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=(0,Vt.default)(this.invoice.order_date).format("YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.order_items=structuredClone(this.invoice.items),this.customer_id=this.invoice.customer_id,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_amount,this.customerChange(this.invoice.customer_id))}setPrice(e){this.updatedRowIndex=e}onDiscountChange(e){this.updatedRowIndex=e}onEditComplete(e){e.field=="discount_percentage"?this.order_items=this.order_items.map((r,i)=>this.updatedRowIndex===i?ct(pt({},r),{unit_price:parseFloat((r.original_price*(1-r.discount_percentage/100)).toFixed(2))}):r):e.field=="unit_price"&&(this.order_items=this.order_items.map((r,i)=>this.updatedRowIndex===i?ct(pt({},r),{discount_percentage:parseFloat((100*(1-r.unit_price/r.original_price)).toFixed(2))}):r)),this.calculateTotal("edit")}setQty(e){this.calculateTotal("edit")}validateItems(){return!1}addProduct(e){this.productToAdd=e,e.has_variants?this.variantDialogVisible=!0:this.addProductToInvoice(e)}addProductToInvoice(e,r=null){let i=this.order_items.find(s=>s.product_id===e.product_id&&s.variant_id===r?.variant_id);i?(i.quantity+=1,this.calculateTotal("edit")):(this.order_items.push({product_id:e.product_id,barcode:e.barcode,product_name:e.product_name,original_price:e.unit_price_usd,unit_cost:e.unit_cost_usd,unit_price:e.unit_price_usd,quantity:1,variant_id:r?.variant_id,expiry_date:r?.expiry_date,stock_management:e.stock_management}),this.calculateTotal("add"))}submitVariant(){this.addProductToInvoice(this.productToAdd,this.selectedVariant),this.variantDialogVisible=!1}resetVariantsDialog(){this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}submitInvoiceInput(e){e.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.sellService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(e){if(e){let r=-1,i=["*","+"];for(let H=0;H<i.length;H++)if(e.indexOf(i[H])!==-1){r=e.indexOf(i[H]);break}let s=e.substring(0,r)||1,f=parseInt(e.substring(r+1,e.length));r!=-1&&r!=0?(this.sellService.factor.set(parseInt(s)),this.sellService.submitBarcode(f)):this.sellService.submitBarcode(e)}}calculateTotal(e){let r=new tt,i=this.order_items;return i.length>0&&(i.forEach(s=>{r.total_qty+=s.quantity,r.cost_dollar+=s.unit_cost*s.quantity,r.subtotal_dollar+=s.unit_price*s.quantity}),r.total_dollar=r.subtotal_dollar-r.discount_dollar),this.invoiceTotal=r,r}submitEditInvoice(){let e=this.validateItems();e?e&&this.notificationsService.showError("Please enter price for all items","home"):this.return_invoice_edit?this.editInvoiceService.returnCheckout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.checkout({customer_id:this.customer_id,order_id:this.invoice.order_id,items:this.order_items,total_cost:this.invoiceTotal.cost_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number,update_reason:this.update_reason},this.stockService)}searchItem(e){let r=this.products(),i=[],s=e.query;for(let f=0;f<r.length;f++){let H=r[f];H.product_name.toLowerCase().indexOf(s.toLowerCase())>-1&&i.push(H)}this.matching_products=i}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}customerChange(e){}removeRow(e){this.order_items.splice(e,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.order_items=[],this.submitted.set(!1),this.invoiceTotal=new tt}})}assignSelectedProducts(e){this.productsDialogVisible=!1,e.forEach(r=>{this.addProduct(r)})}getPriceTypeLabel(e){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[e]}select(e){e.select()}getPriceWarining(e){if(!e.unit_price)return!1;let r=e.unit_cost||0,i=e.unit_price;return typeof r=="string"&&(r=parseFloat(r)),typeof i=="string"&&(i=parseFloat(i)),i<r}deleteInvoice(){this.deleteDialogVisible=!0}hideDeleteDialog(){this.deleteNote=null,this.deleteDialogVisible=!1}confirmDelete(){this.deleteNote&&(this.loadingSubmitDelete=!0,this.api.delete(`sell-orders/${this.invoice.order_id}?message=${this.deleteNote}`).pipe(He(()=>{this.loadingSubmitDelete=!1,this.stockService.getItems(),this.customersService.getCustomerTotalBalance(this.invoice.customer_id),this.deleteDialogVisible=!1,this.visible=!1})).subscribe({next:e=>{this.notification.showSuccess(e.message,"home")}}))}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["edit-invoice"]],inputs:{visible:"visible",invoice:"invoice",customers:"customers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[ke],decls:10,vars:24,consts:[["invoiceTable",""],["barcodeInput",""],["editPrice",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","products"],["position","top","header","Choose Variant","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints","closeOnEscape","closable"],["pTemplate","content"],["header","Confirm","position","center",3,"visibleChange","onHide","visible","modal","closable"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","customer"],["styleClass","p-inputtext-sm","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"onEditComplete","value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],["for",""],["type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["width","20%"],["width","40%"],["width","10%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","discount_percentage",3,"pEditableColumn"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","priceEditable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],["min","0.1","step","0.1",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","minFractionDigits"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["label","Delete","icon","pi pi-trash","severity","danger","size","small","class","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["label","Cancel Edit","icon","pi pi-times","severity","secondary","size","small",1,"w-full","mt-2","md:w-auto","md:ml-2",3,"onClick","disabled"],["size","small","label","Submit Edit","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2","size","small",3,"onClick","loading","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",1,"w-full","mt-4","md:w-auto","md:mt-0",3,"onClick","disabled"],["class","col-12 md:col-3",4,"ngFor","ngForOf"],[1,"col-12","md:col-3"],[1,"dark-hover","shadow-2","p-3","text-center","border-round",3,"click","ngClass"],["pRipple","","size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],["pRipple","","size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],[1,"formgrid","grid"],[1,"field","col-12"],["for","note"],["type","text","id","note","name","note","required","","pInputText","","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngModelChange","ngModel"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Proceed","icon","pi pi-check","severity","danger","size","small",3,"onClick","disabled","loading"]],template:function(r,i){r&1&&(n(0,"p-dialog",3),T("visibleChange",function(f){return E(i.visible,f)||(i.visible=f),f}),d("onHide",function(){return i.closeEditDialog()}),v(1,yi,37,27,"ng-template",4)(2,bi,3,4,"ng-template",5),o(),n(3,"products-dialog",6),d("onHide",function(){return i.productsDialogVisible=!1})("onSubmit",function(f){return i.assignSelectedProducts(f)}),o(),n(4,"p-dialog",7),T("visibleChange",function(f){return E(i.variantDialogVisible,f)||(i.variantDialogVisible=f),f}),d("onHide",function(){return i.resetVariantsDialog()}),v(5,xi,2,1,"ng-template",8)(6,wi,2,0,"ng-template",5),o(),n(7,"p-dialog",9),T("visibleChange",function(f){return E(i.deleteDialogVisible,f)||(i.deleteDialogVisible=f),f}),d("onHide",function(){return i.hideDeleteDialog()}),v(8,Ei,5,1,"ng-template",8)(9,Ti,2,2,"ng-template",5),o()),r&2&&(W(I(20,Zt)),w("visible",i.visible),c("modal",!0)("closable",!0)("maximizable",!0),a(3),c("visible",i.productsDialogVisible)("products",i.products),a(),W(I(21,ei)),w("visible",i.variantDialogVisible),c("modal",!0)("breakpoints",I(22,ti))("closeOnEscape",!1)("closable",!0),a(3),W(I(23,ii)),w("visible",i.deleteDialogVisible),c("modal",!0)("closable",!0))},dependencies:[be,Ne,K,$,k,We,Se,xe,O,F,Ke,Qe,Y,N,B,ee,j,L,R,je,it,M,nt],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:40px;height:28px}.priceEditable[_ngcontent-%COMP%]{width:60px;height:28px;text-align:center}[_nghost-%COMP%]  .p-inputnumber-input{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}[_nghost-%COMP%]  .small-button{font-size:.5rem!important;padding:.2rem .4rem!important;width:2rem!important}[_nghost-%COMP%]  .small-input>span>input{padding:.3rem!important;width:2rem!important;text-align:center}[_nghost-%COMP%]  .invoice-body>div>div{padding:0!important}[_nghost-%COMP%]  .p-dataview-emptymessage{display:none}[_nghost-%COMP%]  .p-card-content{padding:0!important}.invalid[_ngcontent-%COMP%]{border-color:var(--red-500)!important}.category-cards[_ngcontent-%COMP%]{border-radius:6px;color:#343a40;text-align:center;padding:.8rem;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.selected[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}[_nghost-%COMP%]  .p-datatable{font-size:13px!important}[_nghost-%COMP%]  .p-card-body{padding:.8rem!important}[_nghost-%COMP%]  .maxHeight{height:100%!important}[_nghost-%COMP%]  .small-table{font-size:12px!important}"]})}}return t})();var Ii=()=>[10,25,50],Mt=()=>({width:"95vw"});function Di(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Invoice #"),o(),n(3,"th"),l(4,"Customer"),o(),n(5,"th"),l(6,"Datetime"),o(),n(7,"th"),l(8,"total"),o(),n(9,"th",20),l(10,"Options"),o()())}function Pi(t,m){if(t&1){let e=x();n(0,"p-button",25),d("onClick",function(){_(e);let i=p().$implicit,s=p();return u(s.openEditDialog(i))}),o()}}function Vi(t,m){if(t&1){let e=x();n(0,"p-button",26),d("onClick",function(){_(e);let i=p().$implicit,s=p();return u(s.openEditHistoryDialog(i))}),o()}if(t&2){let e=p(2);c("loading",e.loadingEditHistory)}}function Hi(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td")(11,"p-button",21),d("onClick",function(){let i=_(e).$implicit,s=p();return u(s.showInvoiceDialog(i))}),o()(),n(12,"td")(13,"p-button",22),d("onClick",function(){let i=_(e).$implicit,s=p();return u(s.printInvoice(i))}),o()(),n(14,"td"),v(15,Pi,1,0,"p-button",23),o(),n(16,"td"),v(17,Vi,1,1,"p-button",24),o()()}if(t&2){let e=m.$implicit,r=p();a(2),g(e.invoice_number),a(2),g(e.customer_name||"---"),a(2),g(e.order_date),a(2),g(b(9,6,e.total_amount)),a(7),c("ngIf",r.userPermissions().edit_invoice),a(2),c("ngIf",e.update_reason)}}function Mi(t,m){t&1&&(n(0,"tr")(1,"td",27),l(2,"No Records Found!"),o()())}function Fi(t,m){t&1&&(n(0,"th",35),l(1," Unit Cost "),o())}function ki(t,m){t&1&&(n(0,"th"),l(1,"Total Cost"),o())}function Bi(t,m){if(t&1&&(n(0,"tr")(1,"th",30),l(2,"Barcode"),o(),n(3,"th",31),l(4,"Description"),o(),n(5,"th"),l(6,"Expiry Date"),o(),n(7,"th"),l(8,"Original Price"),o(),n(9,"th"),l(10,"Sold Price"),o(),n(11,"th"),l(12,"Discount %"),o(),n(13,"th",32),l(14,"Qty"),o(),n(15,"th"),l(16,"Total Price"),o(),v(17,Fi,2,0,"th",33)(18,ki,2,0,"th",34),o()),t&2){let e=p(3);a(17),c("ngIf",e.userPermissions().show_cost),a(),c("ngIf",e.userPermissions().show_cost)}}function Ni(t,m){if(t&1&&(n(0,"td",35),l(1),C(2,"currency"),o()),t&2){let e=p().$implicit;a(),S(" ",b(2,1,e.unit_cost)," ")}}function Ri(t,m){if(t&1&&(n(0,"td"),l(1),C(2,"currency"),o()),t&2){let e=p().$implicit;a(),S(" ",b(2,1,e.unit_cost*e.quantity)," ")}}function Oi(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td"),l(11),C(12,"currency"),o(),n(13,"td"),l(14),o(),n(15,"td"),l(16),o(),n(17,"td"),l(18),C(19,"currency"),o(),v(20,Ni,3,3,"td",33)(21,Ri,3,3,"td",34),o()),t&2){let e=m.$implicit,r=p(3);a(2),g(e.barcode||"---"),a(2),g(e.product_name),a(2),g(e.expiry_date||"---"),a(2),g(b(9,10,e.original_price)),a(3),S(" ",b(12,12,e.unit_price)," "),a(3),S("",e.discount_percentage,"%"),a(2),g(e.quantity),a(2),S(" ",b(19,14,e.total_price)," "),a(2),c("ngIf",r.userPermissions().show_cost),a(),c("ngIf",r.userPermissions().show_cost)}}function Wi(t,m){t&1&&y(0,"td",35)}function Li(t,m){if(t&1&&(n(0,"td"),l(1),C(2,"currency"),o()),t&2){let e=p(4);a(),S(" ",b(2,1,e.selectedInvoiceTotals.totalCost)," ")}}function zi(t,m){if(t&1&&(n(0,"tr"),y(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td"),n(7,"td"),l(8),o(),n(9,"td"),l(10),C(11,"currency"),o(),v(12,Wi,1,0,"td",33)(13,Li,3,3,"td",34),o()),t&2){let e=p(3);a(8),g(e.selectedInvoiceTotals.totalQty),a(2),S(" ",b(11,4,e.selectedInvoiceTotals.totalPrice)," "),a(2),c("ngIf",e.userPermissions().show_cost),a(),c("ngIf",e.userPermissions().show_cost)}}function qi(t,m){if(t&1&&(n(0,"p-table",29),v(1,Bi,19,2,"ng-template",12)(2,Oi,22,16,"ng-template",13)(3,zi,14,6,"ng-template",17),o()),t&2){let e=p(2);c("value",e.invoiceItems)}}function Ai(t,m){if(t&1&&v(0,qi,4,1,"p-table",28),t&2){let e=p();c("ngIf",e.invoiceItems.length!=0)}}function $i(t,m){if(t&1){let e=x();n(0,"p-button",36),d("onClick",function(){_(e);let i=p();return u(i.hideInvoiceDialog())}),o()}}function Yi(t,m){t&1&&(n(0,"tr"),y(1,"th",39),n(2,"th"),l(3,"Created At"),o(),n(4,"th"),l(5,"Updated At"),o(),n(6,"th"),l(7,"Update Reason"),o(),n(8,"th"),l(9,"Total Price"),o()())}function ji(t,m){if(t&1&&(n(0,"tr")(1,"td"),y(2,"p-button",40),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),o(),n(9,"td"),l(10),C(11,"currency"),o()()),t&2){let e=m.$implicit,r=m.expanded;a(2),c("pRowToggler",e)("text",!0)("rounded",!0)("plain",!0)("icon",r?"pi pi-chevron-down":"pi pi-chevron-right"),a(2),g(e.order_datetime),a(2),g(e.updated_at),a(2),g(e.update_reason),a(2),S(" ",b(11,9,e.total_amount)," ")}}function Gi(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Description"),o(),y(3,"th")(4,"th")(5,"th"),o())}function Ki(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),C(5,"currency"),o(),n(6,"td"),l(7),o(),n(8,"td"),l(9),C(10,"currency"),o()()),t&2){let e=m.$implicit;a(2),g(e.product_name),a(2),S(" ",b(5,4,e.unit_price)," "),a(3),g(e.quantity),a(2),S(" ",b(10,6,e.total_price)," ")}}function Qi(t,m){if(t&1&&(n(0,"tr")(1,"td",41)(2,"div",42)(3,"p-table",43),v(4,Gi,6,0,"ng-template",12)(5,Ki,11,8,"ng-template",13),o()()()()),t&2){let e=m.$implicit;a(3),c("value",e.items)}}function Ui(t,m){if(t&1&&(n(0,"p-table",37),v(1,Yi,10,0,"ng-template",12)(2,ji,12,11,"ng-template",13)(3,Qi,6,1,"ng-template",38),o()),t&2){let e=p();c("value",e.editHistory)("expandedRowKeys",e.expandedRows)}}function Ji(t,m){if(t&1){let e=x();n(0,"p-button",36),d("onClick",function(){_(e);let i=p();return u(i.editHistoryDialogVisible=!1)}),o()}}var kt=(()=>{class t{constructor(){this.customerService=h(te),this.historyService=h(ne),this.decimalService=h(se),this.printService=h(Ee),this.authService=h(pe),this.whatsappService=h(at),this.api=h(A),this.userPermissions=this.authService.userPermissions,this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new G,this.salesHistory=this.historyService.salesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({invoice_number:new P(null),customer_id:new P(null),invoice_date:new P(null)}),this.whatsappLoading=this.whatsappService.whatsappLoading,this.editHistoryDialogVisible=!1,this.loadingEditHistory=!1,this.expandedRows={},this.submitSearch()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,Ft.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchSalesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchSalesHistory(null)}showInvoiceDialog(e){this.invoiceItems=e.items,this.invoiceItems.forEach(r=>{this.selectedInvoiceTotals.totalQty+=r.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,r.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,r.unit_cost*r.quantity)}),this.detailsDialogVisible=!0}openEditDialog(e){this.selectedInvoice=e,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(e){this.historyService.fetchSalesHistory(this.searchForm.value)}printInvoice(e){this.printService.print(e,"sale")}sendWhatsapp(e){this.whatsappLoading.set(!0);let r={to:e.customer_phone,messageContents:[e.invoice_number,e.order_datetime,`${e.total_amount}$`]};this.whatsappService.sendMessage(r)}openEditHistoryDialog(e){this.loadingEditHistory=!0,this.api.get(`history/edits/${e.order_id}`).pipe(He(()=>{this.loadingEditHistory=!1})).subscribe({next:r=>{console.log(r),this.editHistoryDialogVisible=!0,this.editHistory=r}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-sell-history"]],decls:26,vars:37,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers"],["header","Edit History","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["colspan","4","width","10%"],["size","small","severity","info","icon","fas fa-eye",3,"onClick"],["size","small","severity","secondary","icon","pi pi-print",3,"onClick"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick",4,"ngIf"],["size","small","severity","help","icon","pi pi-history",3,"loading","onClick",4,"ngIf"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["size","small","severity","help","icon","pi pi-history",3,"onClick","loading"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","15%"],["width","30%"],["width","5%"],["style","border-left: 1px #e5e7eb solid",4,"ngIf"],[4,"ngIf"],[2,"border-left","1px #e5e7eb solid"],["label","Close","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value","expandedRowKeys"],["pTemplate","rowexpansion"],[2,"width","5rem"],["type","button",3,"pRowToggler","text","rounded","plain","icon"],["colspan","7"],[1,"p-3"],["dataKey","id",3,"value"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"input",6),o(),n(8,"div",5),y(9,"p-dropdown",7),o(),n(10,"div",5),y(11,"p-calendar",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,Di,11,0,"ng-template",12)(17,Hi,18,8,"ng-template",13)(18,Mi,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),T("visibleChange",function(f){return E(i.detailsDialogVisible,f)||(i.detailsDialogVisible=f),f}),d("onHide",function(){return i.hideInvoiceDialog()}),v(20,Ai,1,1,"ng-template",16)(21,$i,1,0,"ng-template",17),o(),n(22,"edit-invoice",18),d("onHide",function(){return i.closeEditDialog()})("onSubmit",function(f){return i.submitEdit(f)}),o(),n(23,"p-dialog",19),T("visibleChange",function(f){return E(i.editHistoryDialogVisible,f)||(i.editHistoryDialogVisible=f),f}),d("onHide",function(){return i.editHistory=null}),v(24,Ui,4,2,"ng-template",16)(25,Ji,1,0,"ng-template",17),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(5),c("options",i.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),a(2),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.salesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(34,Ii))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),W(I(35,Mt)),w("visible",i.detailsDialogVisible),c("modal",!0)("closable",!0)("maximizable",!0),a(3),c("visible",i.editDialogVisible)("invoice",i.selectedInvoice)("customers",i.customers()),a(),W(I(36,Mt)),w("visible",i.editHistoryDialogVisible),c("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[K,J,$,k,Q,X,Z,O,F,Ct,N,B,ee,j,L,R,ie,lt,M]})}}return t})();var Bt=Ie(De());var Xi=()=>[10,25,50];function Zi(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Payment #"),o(),n(3,"th"),l(4,"Customer"),o(),n(5,"th"),l(6,"Datetime"),o(),n(7,"th"),l(8,"total"),o(),n(9,"th",16),l(10,"Options"),o()())}function en(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td")(11,"button",17),d("click",function(){let i=_(e).$implicit,s=p();return u(s.printInvoice(i))}),o()(),n(12,"td")(13,"button",18),d("click",function(){let i=_(e).$implicit,s=p();return u(s.openEditDialog(i))}),o()()()}if(t&2){let e=m.$implicit;a(2),g(e.journal_number),a(2),g(e.partner_name),a(2),g(e.payment_date),a(2),g(b(9,4,e.total_value))}}function tn(t,m){t&1&&(n(0,"tr")(1,"td",19),l(2,"No Records Found!"),o()())}var Nt=(()=>{class t{constructor(){this.customerService=h(te),this.historyService=h(ne),this.customers=this.customerService.customers,this.customersLoading=this.customerService.signal_tableLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.paymentsHistory=this.historyService.paymentsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({payment_date:new P(null),partner_id:new P(null),payment_number:new P(null)}),this.submitSearch()}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=(0,Bt.default)(this.searchForm.value.payment_date).format("YYYY-MM-DD")),this.historyService.fetchPaymentHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPaymentHistory(null)}showInvoiceDialog(e){}printInvoice(e){}openEditDialog(e){this.selectedPayment=e,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(e){this.historyService.fetchPaymentHistory(this.searchForm.value)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-payment-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"input",6),o(),n(8,"div",5),y(9,"p-dropdown",7),o(),n(10,"div",5),y(11,"p-calendar",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,Zi,11,0,"ng-template",12)(17,en,14,6,"ng-template",13)(18,tn,3,0,"ng-template",14),o()()()(),n(19,"payment-dialog",15),d("onClose",function(){return i.hidePaymentDialog()})("onSubmit",function(f){return i.getPaymentDilogResult(f)}),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(5),c("options",i.customers())("loading",i.customersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0),a(2),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.paymentsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(22,Xi))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),c("visible",i.editDialogVisible)("selected_payment",i.selectedPayment)("accounts",i.customers()))},dependencies:[J,$,k,Q,X,Z,O,F,Y,N,B,j,L,R,ie,Xe,M]})}}return t})();var Rt=Ie(De());var nn=()=>[10,25,50],on=()=>({width:"95vw"});function rn(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Invoice #"),o(),n(3,"th"),l(4,"Customer"),o(),n(5,"th"),l(6,"Datetime"),o(),n(7,"th"),l(8,"total"),o(),n(9,"th",19),l(10,"Options"),o()())}function an(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td")(11,"button",20),d("click",function(){let i=_(e).$implicit,s=p();return u(s.showInvoiceDialog(i))}),o()(),n(12,"td")(13,"button",21),d("click",function(){let i=_(e).$implicit,s=p();return u(s.printInvoice(i))}),o()(),n(14,"td")(15,"button",22),d("click",function(){let i=_(e).$implicit,s=p();return u(s.openEditDialog(i))}),o()()()}if(t&2){let e=m.$implicit;a(2),g(e.invoice_number),a(2),g(e.customer_name),a(2),g(e.order_date),a(2),g(b(9,4,e.total_amount))}}function ln(t,m){t&1&&(n(0,"tr")(1,"td",23),l(2,"No Records Found!"),o()())}function sn(t,m){t&1&&(n(0,"tr")(1,"th",26),l(2,"Description"),o(),n(3,"th",27),l(4,"Unit Price"),o(),n(5,"th",28),l(6,"Qty"),o(),n(7,"th",27),l(8,"Total Price"),o()())}function pn(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),C(5,"currency"),o(),n(6,"td"),l(7),o(),n(8,"td"),l(9),C(10,"currency"),o()()),t&2){let e=m.$implicit;a(2),g(e.product_name),a(2),S(" ",b(5,4,e.unit_price)," "),a(3),g(e.quantity),a(2),S(" ",b(10,6,e.total_price)," ")}}function cn(t,m){if(t&1&&(n(0,"tr"),y(1,"td")(2,"td"),n(3,"td"),l(4),o(),n(5,"td"),l(6),C(7,"currency"),o()()),t&2){let e=p(3);a(4),g(e.selectedInvoiceTotals.totalQty),a(2),S(" Total: ",b(7,2,e.selectedInvoiceTotals.totalPrice)," ")}}function mn(t,m){if(t&1&&(n(0,"p-table",25),v(1,sn,9,0,"ng-template",12)(2,pn,11,8,"ng-template",13)(3,cn,8,4,"ng-template",17),o()),t&2){let e=p(2);c("value",e.invoiceItems)}}function dn(t,m){if(t&1&&v(0,mn,4,1,"p-table",24),t&2){let e=p();c("ngIf",e.invoiceItems.length!=0)}}function _n(t,m){if(t&1){let e=x();n(0,"button",29),d("click",function(){_(e);let i=p();return u(i.hideInvoiceDialog())}),o()}}var Ot=(()=>{class t{constructor(){this.customerService=h(te),this.historyService=h(ne),this.decimalService=h(se),this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.subscriptions=new G,this.returnHistory=this.historyService.returnHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({invoice_number:new P(null),customer_id:new P(null),invoice_date:new P(null)})}ngOnInit(){}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,Rt.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchReturnHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReturnHistory(null)}showInvoiceDialog(e){this.invoiceItems=e.items,this.invoiceItems.forEach(r=>{this.selectedInvoiceTotals.totalQty+=r.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,r.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,r.unit_cost)}),this.detailsDialogVisible=!0}printInvoice(e){}printDelivery(e){}openEditDialog(e){console.log(e),this.selectedInvoice=e,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}submitEdit(e){this.historyService.fetchReturnHistory(this.searchForm.value)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-sell-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","customers","return_invoice_edit"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","pi pi-print",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","50%"],["width","20%"],["width","10%"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"p-dropdown",6),o(),n(8,"div",5),y(9,"p-calendar",7),o(),n(10,"div",5),y(11,"input",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,rn,11,0,"ng-template",12)(17,an,16,6,"ng-template",13)(18,ln,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),T("visibleChange",function(f){return E(i.detailsDialogVisible,f)||(i.detailsDialogVisible=f),f}),d("onHide",function(){return i.hideInvoiceDialog()}),v(20,dn,1,1,"ng-template",16)(21,_n,1,0,"ng-template",17),o(),n(22,"edit-invoice",18),d("onHide",function(){return i.closeEditDialog()})("onSubmit",function(f){return i.submitEdit(f)}),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(3),c("options",i.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0),a(4),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.returnHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(28,nn))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),W(I(29,on)),w("visible",i.detailsDialogVisible),c("modal",!0)("closable",!0)("maximizable",!0),a(3),c("visible",i.editDialogVisible)("invoice",i.selectedInvoice)("customers",i.customers())("return_invoice_edit",!0))},dependencies:[K,J,$,k,Q,X,Z,O,F,Y,N,B,ee,j,L,R,ie,lt,M]})}}return t})();var qt=Ie(De());var Wt=(()=>{class t{constructor(){this.apiService=h(A),this.http=h(ae),this.notificationService=h(q),this.suppliersService=h(we),this.host=this.apiService.host,this.currentInvoice=D({}),this.signal_submited=D(!1),this.signal_submit_loading=D(!1),this.action_status$=new ve(""),this.selectedSupplierLatestItems=new ve([])}chcekout(e,r){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/supply`,e).subscribe({next:i=>{this.notificationService.showSuccess("Invoice Updated","home")},error:i=>{this.notificationService.showError(i.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(e.partner_id_fk)}})}returnCheckout(e,r){this.signal_submited.set(!0),this.signal_submit_loading.set(!0),this.http.put(`${this.apiService.host}/return`,e).subscribe({next:i=>{this.notificationService.showSuccess("Invoice Updated","home")},error:i=>{this.notificationService.showError(i.error.message,"home"),this.signal_submited.set(!1),this.signal_submit_loading.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.signal_submit_loading.set(!1),this.action_status$.next("UPDATE"),this.suppliersService.getAccountTotalBalance(e.partner_id_fk)}})}deleteInvoice(e,r){let i=e.order_id;console.log(i),this.signal_submited.set(!0),this.http.delete(`${this.host}/supply/${i}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(e.partner_id_fk)}})}returnDeleteInvoice(e,r){let i=e.order_id;this.signal_submited.set(!0),this.http.delete(`${this.host}/return/${i}`).subscribe({next:s=>{this.notificationService.showSuccess(s.message,"home")},error:s=>{this.notificationService.handleError(s.error,"home"),this.signal_submited.set(!1)},complete:()=>{r.getItems(),this.signal_submited.set(!1),this.action_status$.next("DELETE"),this.suppliersService.getAccountTotalBalance(e.partner_id_fk)}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var un=()=>({width:"95vw",height:"75vh"}),hn=()=>({width:"65vw"}),gn=()=>({"1199px":"75vw","575px":"95vw"}),fn=()=>({standalone:!0}),vn=t=>({"ng-invalid ng-dirty":t}),Lt=t=>({invalid:t}),yn=(t,m)=>({"text-red-500":t,"text-orange-500":m}),Cn=t=>({"text-red-500":t}),bn=t=>({selected:t});function Sn(t,m){t&1&&(n(0,"small",29),l(1,"Supplier is required."),o())}function xn(t,m){t&1&&(n(0,"tr")(1,"th",30),l(2,"Barcode"),o(),n(3,"th",31),l(4,"Description"),o(),n(5,"th",32),l(6,"Expiry Date"),o(),n(7,"th",33),l(8,"Unit"),o(),n(9,"th",34),l(10,"Qty"),o(),n(11,"th",33),l(12,"Total"),o(),n(13,"th",34),l(14,"Del?"),o()())}function wn(t,m){if(t&1){let e=x();n(0,"p-inputNumber",41),T("ngModelChange",function(i){_(e);let s=p().$implicit;return E(s.unit_price,i)||(s.unit_price=i),u(i)}),d("ngModelChange",function(){_(e);let i=p().$implicit,s=p(2);return u(s.setPrice(i))})("onFocus",function(i){_(e);let s=p(3);return u(s.select(i.target))}),o()}if(t&2){let e=p().$implicit;w("ngModel",e.unit_price),c("maxFractionDigits",2)("min",0)}}function En(t,m){t&1&&y(0,"i",44)}function Tn(t,m){if(t&1&&(n(0,"span",42),l(1),C(2,"currency"),n(3,"span"),v(4,En,1,0,"i",43),o()()),t&2){let e=p().$implicit,r=p(2);c("ngClass",Ce(5,yn,!e.unit_price,r.getPriceWarining(e))),a(),g(b(2,3,e.unit_price)),a(3),c("ngIf",r.getPriceWarining(e))}}function In(t,m){if(t&1){let e=x();n(0,"p-inputNumber",45),T("ngModelChange",function(i){_(e);let s=p().$implicit;return E(s.quantity,i)||(s.quantity=i),u(i)}),d("onFocus",function(i){_(e);let s=p(3);return u(s.select(i.target))})("ngModelChange",function(){_(e);let i=p().$implicit,s=p(2);return u(s.setQty(i))}),o()}if(t&2){let e=p().$implicit;w("ngModel",e.quantity)}}function Dn(t,m){if(t&1&&(n(0,"span",42),l(1),o()),t&2){let e=p().$implicit;c("ngClass",re(2,Cn,!e.quantity)),a(),g(e.quantity)}}function Pn(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td",35)(8,"p-cellEditor"),v(9,wn,1,3,"ng-template",36)(10,Tn,5,8,"ng-template",37),o()(),n(11,"td",38)(12,"p-cellEditor"),v(13,In,1,1,"ng-template",36)(14,Dn,2,4,"ng-template",37),o()(),n(15,"td"),l(16),C(17,"currency"),o(),n(18,"td",39),d("click",function(){let i=_(e).rowIndex,s=p(2);return u(s.removeRow(i))}),y(19,"i",40),o()()}if(t&2){let e=m.$implicit;a(2),g(e.barcode||"---"),a(2),g(e.product_name),a(2),g(e.expiry_date||"---"),a(),c("pEditableColumn",e.unit_price)("ngClass",re(10,Lt,!e.unit_price)),a(4),c("pEditableColumn",e.quantity)("ngClass",re(12,Lt,!e.quantity)),a(5),S(" ",b(17,8,e.unit_price*e.quantity)," ")}}function Vn(t,m){if(t&1&&(n(0,"h4",47),l(1),o()),t&2){let e=p(3);a(),S(" Total units: ",e.invoiceTotal.total_qty," ")}}function Hn(t,m){if(t&1&&v(0,Vn,2,1,"h4",46),t&2){let e=p(2);c("ngIf",e.invoiceTotal.total_qty)}}function Mn(t,m){t&1&&(n(0,"tr",48)(1,"td",49),l(2,"No data yet!"),o()())}function Fn(t,m){if(t&1){let e=x();n(0,"p-card",8)(1,"div",9)(2,"div",10)(3,"div",11),y(4,"div",12),n(5,"label"),l(6,"Invoice Date"),o(),n(7,"p-calendar",13),T("ngModelChange",function(i){_(e);let s=p();return E(s.invoice_date,i)||(s.invoice_date=i),u(i)}),o()()(),n(8,"div",10)(9,"div",12)(10,"label",14),l(11,"Supplier"),n(12,"span",15),l(13," *"),o()(),n(14,"p-dropdown",16),T("ngModelChange",function(i){_(e);let s=p();return E(s.supplier_id,i)||(s.supplier_id=i),u(i)}),d("onChange",function(i){_(e);let s=p();return u(s.supplierChange(i.value))}),o(),v(15,Sn,2,0,"small",17),o()(),n(16,"div",18)(17,"h3",19),l(18),C(19,"currency"),o(),n(20,"h3",20),l(21),C(22,"lira"),o()()(),n(23,"div",9)(24,"div",21)(25,"p-table",22,0),v(27,xn,15,0,"ng-template",23)(28,Pn,20,14,"ng-template",3)(29,Hn,1,1,"ng-template",24)(30,Mn,3,0,"ng-template",25),o()(),n(31,"div",26)(32,"p-autoComplete",27,1),T("ngModelChange",function(i){_(e);let s=p();return E(s.search_product,i)||(s.search_product=i),u(i)}),d("completeMethod",function(i){_(e);let s=p();return u(s.searchItem(i))})("onKeyUp",function(i){_(e);let s=p();return u(s.submitInvoiceInput(i))}),o(),n(34,"button",28),d("click",function(){_(e);let i=p();return u(i.openProductsDialog())}),o()()()()}if(t&2){let e=p();a(7),w("ngModel",e.invoice_date),c("ngModelOptions",I(25,fn))("readonlyInput",!0)("showIcon",!0)("iconDisplay","input")("showTime",!0),a(7),w("ngModel",e.supplier_id),c("options",e.suppliers)("filter",!0)("showClear",!0)("ngClass",re(26,vn,!e.supplier_id)),a(),c("ngIf",!e.supplier_id),a(3),S(" USD: ",b(19,21,e.invoiceTotal.total_dollar)," "),a(3),S(" LBP: ",b(22,23,e.invoiceTotal.total_dollar*e.invoice.exchange_rate)," "),a(4),Be("scrollHeight",e.vh),c("value",e.invoice_items())("scrollable",!0),a(7),w("ngModel",e.search_product),c("suggestions",e.matching_products)("delay",150)("autofocus",!0)}}function kn(t,m){if(t&1){let e=x();n(0,"p-button",50),d("onClick",function(){_(e);let i=p();return u(i.deleteInvoice())}),o(),n(1,"p-button",51),d("onClick",function(){_(e);let i=p();return u(i.closeEditDialog())}),o(),n(2,"p-button",52),d("onClick",function(){_(e);let i=p();return u(i.submitEditInvoice())}),o()}if(t&2){let e=p();c("disabled",e.submitted()),a(),c("disabled",e.submitted()),a(),c("loading",e.submitted())("disabled",e.invoice_items().length==0)}}function Bn(t,m){if(t&1){let e=x();n(0,"div",54)(1,"div",55),d("click",function(){let i=_(e).$implicit,s=p(2);return u(s.selectedVariant=i)}),n(2,"p"),l(3),y(4,"br"),n(5,"small"),l(6),o()()()()}if(t&2){let e=m.$implicit,r=p(2);a(),c("ngClass",re(3,bn,r.selectedVariant==e)),a(2),S(" ",e.expiry_date," "),a(3),S("Current qty: ",e.variant_quantity,"")}}function Nn(t,m){if(t&1&&(n(0,"div",9),v(1,Bn,7,5,"div",53),o()),t&2){let e=p();a(),c("ngForOf",e.productToAdd==null?null:e.productToAdd.variants_records)}}function Rn(t,m){if(t&1){let e=x();n(0,"p-button",56),d("onClick",function(){_(e);let i=p();return u(i.variantDialogVisible=!1)}),o(),n(1,"p-button",57),d("onClick",function(){_(e);let i=p();return u(i.submitVariant())}),o()}}var zt=(()=>{class t{constructor(){this.visible=!1,this.suppliers=[],this.return_invoice_edit=!1,this.onSubmit=new ye,this.onHide=new ye,this.stockService=h(Je),this.editInvoiceService=h(Wt),this.authService=h(pe),this.confirmationService=h(Oe),this.notificationsService=h(q),this.supplyService=h(Tt),this.dateService=h(le),this.submitted=this.editInvoiceService.signal_submited,this.form_error=!1,this.invoiceTotal=new ot,this.supplier_id=null,this.invoice_number="123",this.invoice_items=D([]),this.selectedSupplierLatestItems=[],this.productsDialogVisible=!1,this.subscriptions=new G,this.products=this.stockService.products,this.matching_products=[],this.editDialogVisible=!1,this.vh="50vh",this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}ngOnInit(){this.subscriptions.add(this.editInvoiceService.action_status$.subscribe(e=>{(e==="UPDATE"||e==="DELETE")&&(this.onSubmit.emit({action:e}),this.editInvoiceService.action_status$.next(""),this.visible=!1)})),this.subscriptions.add(this.supplyService.barcodeResponse.subscribe(e=>{e&&(this.addProduct(e),this.supplyService.barcodeResponse.next(null))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.invoice&&(this.invoice_date=this.dateService.formatDate(this.invoice.order_datetime,"YYYY-MM-DD HH:mm"),this.invoice_number=this.invoice.invoice_number.substring(3,this.invoice.invoice_number.length),this.invoice_items.set(structuredClone(this.invoice.items)),this.supplier_id=this.invoice.partner_id_fk,this.invoiceTotal.cost_dollar=this.invoice.total_cost,this.invoiceTotal.total_dollar=this.invoice.total_cost,this.supplierChange(this.invoice.supplier_id))}setPrice(e){e.unit_price?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}setQty(e){e.quantity?this.validateItems():this.form_error=!0,this.calculateTotal("edit")}validateItems(){return this.invoice_items().find(r=>!r.unit_price||!r.quantity)?(this.form_error=!0,!0):(this.form_error=!1,!1)}addProduct(e){this.productToAdd=e,e.has_variants?this.variantDialogVisible=!0:this.addProductToInvoice(e)}addProductToInvoice(e,r=null){let i=this.supplyService.factor(),s=structuredClone(this.invoice_items()),f=s.find(H=>H.product_id===e.product_id&&H.variant_id===r?.variant_id);f?f.quantity+=i:s.push({product_id:e.product_id,variant_id:r?.variant_id,expiry_date:r?.expiry_date,barcode:e.barcode,product_name:e.product_name,unit_cost:e.unit_cost_usd,unit_price:e.unit_cost_usd,quantity:i,unit_abbreviation:e.unit_abbreviation,product_unit_id:e.unit_id_fk}),this.invoice_items.set(s),this.supplyService.factor.set(1),this.calculateTotal("add")}submitVariant(){this.addProductToInvoice(this.productToAdd,this.selectedVariant),this.variantDialogVisible=!1}resetVariantsDialog(){this.variantDialogVisible=!1,this.productToAdd=null,this.selectedVariant=null}submitInvoiceInput(e){e.key==="Enter"&&this.search_product&&(typeof this.search_product=="string"?this.submitBarcode(this.search_product):this.supplyService.barcodeResponse.next(this.search_product),this.search_product=null)}submitBarcode(e){if(e){let r=-1,i=["*","+"];for(let H=0;H<i.length;H++)if(e.indexOf(i[H])!==-1){r=e.indexOf(i[H]);break}let s=e.substring(0,r)||1,f=parseInt(e.substring(r+1,e.length));r!=-1&&r!=0?(this.supplyService.factor.set(parseInt(s)),this.supplyService.submitBarcode(f)):this.supplyService.submitBarcode(e)}}calculateTotal(e){let r=new ot,i=this.invoice_items();return i.length>0&&(i.forEach(s=>{r.total_qty+=s.quantity,r.cost_dollar+=s.unit_cost*s.quantity,r.subtotal_dollar+=s.unit_price*s.quantity}),r.total_dollar=r.subtotal_dollar-r.discount_dollar),this.invoiceTotal=r,r}submitEditInvoice(){let e=this.validateItems();!e&&this.supplier_id?this.return_invoice_edit?this.editInvoiceService.returnCheckout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,total_amount:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):this.editInvoiceService.chcekout({partner_id_fk:this.supplier_id,order_id:this.invoice.order_id,items:this.invoice_items(),total_cost:this.invoiceTotal.total_dollar,order_datetime:this.invoice_date,invoice_number:this.invoice_number},this.stockService):e&&this.notificationsService.showError("Please enter price for all items","home")}searchItem(e){let r=this.products(),i=[],s=e.query;for(let f=0;f<r.length;f++){let H=r[f];H.product_name.toLowerCase().indexOf(s.toLowerCase())>-1&&i.push(H)}this.matching_products=i}closeEditDialog(){this.visible=!1,this.onHide.emit(!1)}supplierChange(e){}removeRow(e){this.invoice_items().splice(e,1),this.calculateTotal("remove")}openProductsDialog(){this.productsDialogVisible=!0}clearInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to clear invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.invoice_items.set([]),this.submitted.set(!1),this.invoiceTotal=new ot}})}deleteInvoice(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.return_invoice_edit?this.editInvoiceService.returnDeleteInvoice(this.invoice,this.stockService):this.editInvoiceService.deleteInvoice(this.invoice,this.stockService)}})}closeProductsDialog(){}assignSelectedProducts(e){this.productsDialogVisible=!1,e.forEach(r=>{this.addProduct(r)})}getPriceTypeLabel(e){return{unit_price_usd:"\u0645\u0641\u0631\u0642",whole_price_usd:"\u062C\u0645\u0644\u0629",grandwhole_price_usd:"\u062C\u0645\u0644\u0629 \u0627\u0644\u062C\u0645\u0644\u0629",latest:"\u0622\u062E\u0631 \u0633\u0639\u0631"}[e]}select(e){e.select()}getPriceWarining(e){if(!e.unit_price)return!1;let r=e.unit_cost||0,i=e.unit_price;return typeof r=="string"&&(r=parseFloat(r)),typeof i=="string"&&(i=parseFloat(i)),i<r}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["edit-purchase"]],inputs:{visible:"visible",invoice:"invoice",suppliers:"suppliers",return_invoice_edit:"return_invoice_edit"},outputs:{onSubmit:"onSubmit",onHide:"onHide"},features:[ke],decls:7,vars:18,consts:[["invoiceTable",""],["barcodeInput",""],["header","Edit Invoice","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","body"],["pTemplate","footer"],["price","cost",3,"onHide","onSubmit","visible","products"],["position","top","header","Choose Variant","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints","closeOnEscape","closable"],["pTemplate","content"],["styleClass","mt-2"],[1,"grid"],[1,"col-12","md:col-3","pt-0","pb-0"],[1,"field","mb-0"],[1,"flex","flex-column","gap-2"],["inputId","order_datetime","name","order_datetime","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","size","small","appendTo","body",3,"ngModelChange","ngModel","ngModelOptions","readonlyInput","showIcon","iconDisplay","showTime"],["for","supplier"],[1,"text-red-500"],["styleClass","p-inputtext-sm","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"ngModelChange","onChange","ngModel","options","filter","showClear","ngClass"],["class","p-error",4,"ngIf"],[1,"col-12","md:col-3","md:col-offset-3","text-center"],[1,"text-green-600","m-2"],[1,"text-primary","m-2"],[1,"col-12"],["dataKey","product_id","styleClass","p-datatable-sm p-datatable-gridlines","editMode","cell",3,"value","scrollable","scrollHeight"],["pTemplate","header"],["pTemplate","summary"],["pTemplate","emptymessage"],[1,"col-12","md:col-4"],["field","product_name","name","barcodeInput","placeholder","scan or search ...","spellcheck","false",1,"p-inputtext-sm",3,"ngModelChange","completeMethod","onKeyUp","ngModel","suggestions","delay","autofocus"],["pButton","","pRipple","","label","Multi Select","severity","warning","icon","pi pi-list",1,"p-button-sm","ml-2",3,"click"],[1,"p-error"],["width","20%"],["width","35%"],["width","15%"],["width","10%"],["width","5%"],["pEditableColumnField","unit_price",3,"pEditableColumn","ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","quantity",3,"pEditableColumn","ngClass"],[1,"danger-hover",3,"click"],[1,"pi","pi-trash"],["styleClass","input-align-center","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel","maxFractionDigits","min"],[3,"ngClass"],["class","pi pi-exclamation-triangle ml-2",4,"ngIf"],[1,"pi","pi-exclamation-triangle","ml-2"],["min","0","step","0",1,"p-inputtext-sm","editable",3,"ngModelChange","onFocus","ngModel"],["class","text-center m-0",4,"ngIf"],[1,"text-center","m-0"],[1,"surface-300"],["colspan","9"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",3,"onClick","disabled"],["label","Cancel Edit","icon","pi pi-times","severity","secondary","size","small",3,"onClick","disabled"],["label","Submit Edit","icon","pi pi-check","severity","success","size","small",3,"onClick","loading","disabled"],["class","col-12 md:col-3",4,"ngFor","ngForOf"],[1,"col-12","md:col-3"],[1,"dark-hover","shadow-2","p-3","text-center","border-round",3,"click","ngClass"],["size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"],["size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"]],template:function(r,i){r&1&&(n(0,"p-dialog",2),T("visibleChange",function(f){return E(i.visible,f)||(i.visible=f),f}),d("onHide",function(){return i.closeEditDialog()}),v(1,Fn,35,28,"ng-template",3)(2,kn,3,4,"ng-template",4),o(),n(3,"products-dialog",5),d("onHide",function(){return i.productsDialogVisible=!1})("onSubmit",function(f){return i.assignSelectedProducts(f)}),o(),n(4,"p-dialog",6),T("visibleChange",function(f){return E(i.variantDialogVisible,f)||(i.variantDialogVisible=f),f}),d("onHide",function(){return i.resetVariantsDialog()}),v(5,Nn,2,1,"ng-template",7)(6,Rn,2,0,"ng-template",4),o()),r&2&&(W(I(15,un)),w("visible",i.visible),c("modal",!0)("closable",!0)("maximizable",!0),a(3),c("visible",i.productsDialogVisible)("products",i.products),a(),W(I(16,hn)),w("visible",i.variantDialogVisible),c("modal",!0)("breakpoints",I(17,gn))("closeOnEscape",!1)("closable",!0))},dependencies:[be,Ne,K,k,Se,xe,O,F,Ke,Qe,Y,N,B,ee,L,R,je,it,M,nt],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding:.5rem}.editable[_ngcontent-%COMP%]{width:100%;height:28px}[_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component{width:100%}td[_ngcontent-%COMP%]:has(span.p-inputnumber.p-component){padding:0}td[_ngcontent-%COMP%]:has(.no-padding){padding:0}.input-align-center[_ngcontent-%COMP%], [_nghost-%COMP%]   .editable[_ngcontent-%COMP%]     span.p-inputnumber.p-component .p-inputnumber-input{text-align:center}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.invalid[_ngcontent-%COMP%]{border-bottom:1px solid var(--red-500)!important}[_nghost-%COMP%]  .p-card-content{padding-top:0!important;padding-bottom:0!important}.selected[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}"]})}}return t})();var Wn=()=>[10,25,50],Ln=()=>({width:"95vw"});function zn(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Invoice #"),o(),n(3,"th"),l(4,"Supplier"),o(),n(5,"th"),l(6,"Datetime"),o(),n(7,"th"),l(8,"total"),o(),n(9,"th",19),l(10,"Options"),o()())}function qn(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td")(11,"button",20),d("click",function(){let i=_(e).$implicit,s=p();return u(s.showInvoiceDialog(i))}),o()(),n(12,"td")(13,"button",21),d("click",function(){let i=_(e).$implicit,s=p();return u(s.openEditDialog(i))}),o()()()}if(t&2){let e=m.$implicit;a(2),g(e.invoice_number),a(2),g(e.supplier_name||"---"),a(2),g(e.order_date),a(2),g(b(9,4,e.total_cost))}}function An(t,m){t&1&&(n(0,"tr")(1,"td",22),l(2,"No Records Found!"),o()())}function $n(t,m){t&1&&(n(0,"tr")(1,"th",25),l(2,"Barcode"),o(),n(3,"th",26),l(4,"Description"),o(),n(5,"th",25),l(6,"Expiry Date"),o(),n(7,"th",27),l(8,"Unit Price"),o(),n(9,"th",28),l(10,"Qty"),o(),n(11,"th",27),l(12,"Total Price"),o()())}function Yn(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td"),l(11),o(),n(12,"td"),l(13),C(14,"currency"),o()()),t&2){let e=m.$implicit;a(2),g(e.barcode||"---"),a(2),g(e.product_name),a(2),g(e.expiry_date||"---"),a(2),S(" ",b(9,6,e.unit_cost)," "),a(3),g(e.quantity),a(2),S(" ",b(14,8,e.unit_cost*e.quantity)," ")}}function jn(t,m){if(t&1&&(n(0,"tr"),y(1,"td")(2,"td")(3,"td")(4,"td"),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o()()),t&2){let e=p(3);a(6),g(e.selectedInvoiceTotals.totalQty),a(2),S(" ",b(9,2,e.selectedInvoiceTotals.totalCost)," ")}}function Gn(t,m){if(t&1&&(n(0,"p-table",24),v(1,$n,13,0,"ng-template",12)(2,Yn,15,10,"ng-template",13)(3,jn,10,4,"ng-template",17),o()),t&2){let e=p(2);c("value",e.invoiceItems)}}function Kn(t,m){if(t&1&&v(0,Gn,4,1,"p-table",23),t&2){let e=p();c("ngIf",e.invoiceItems.length!=0)}}function Qn(t,m){if(t&1){let e=x();n(0,"p-button",29),d("onClick",function(){_(e);let i=p();return u(i.hideInvoiceDialog())}),o()}}var At=(()=>{class t{constructor(){this.suppliersService=h(we),this.historyService=h(ne),this.decimalService=h(se),this.printService=h(Ee),this.suppliers=[],this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0},this.subscriptions=new G,this.purchasesHistory=this.historyService.purchasesHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({invoice_number:new P(null),supplier_id:new P(null),invoice_date:new P(null)}),this.submitSearch()}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(e=>{this.suppliers=e}))}ngOnDestroy(){this.subscriptions.unsubscribe()}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=(0,qt.default)(this.searchForm.value.invoice_date).format("YYYY-MM-DD")),this.historyService.fetchPurchasesHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchPurchasesHistory(null)}showInvoiceDialog(e){this.invoiceItems=e.items,this.invoiceItems.forEach(r=>{console.log(r),this.selectedInvoiceTotals.totalQty+=r.quantity,this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,r.unit_cost*r.quantity)}),this.detailsDialogVisible=!0}printDelivery(e){}openEditDialog(e){this.selectedInvoice=e,this.editDialogVisible=!0}closeEditDialog(){this.selectedInvoice=null,this.editDialogVisible=!1}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalCost:0}}submitEdit(e){this.historyService.fetchPurchasesHistory(this.searchForm.value)}printInvoice(e){this.printService.print(e,"sale")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-supply-history"]],decls:23,vars:30,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","supplier_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[3,"onHide","onSubmit","visible","invoice","suppliers"],["colspan","3","width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","20%"],["width","35%"],["width","10%"],["width","5%"],["size","small","label","Close","icon","pi pi-times","severity","secondary",3,"onClick"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"input",6),o(),n(8,"div",5),y(9,"p-dropdown",7),o(),n(10,"div",5),y(11,"p-calendar",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,zn,11,0,"ng-template",12)(17,qn,14,6,"ng-template",13)(18,An,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),T("visibleChange",function(f){return E(i.detailsDialogVisible,f)||(i.detailsDialogVisible=f),f}),d("onHide",function(){return i.hideInvoiceDialog()}),v(20,Kn,1,1,"ng-template",16)(21,Qn,1,0,"ng-template",17),o(),n(22,"edit-purchase",18),d("onHide",function(){return i.closeEditDialog()})("onSubmit",function(f){return i.submitEdit(f)}),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(5),c("options",i.suppliers)("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),a(2),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.purchasesHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(28,Wn))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),W(I(29,Ln)),w("visible",i.detailsDialogVisible),c("modal",!0)("closable",!0)("maximizable",!0),a(3),c("visible",i.editDialogVisible)("invoice",i.selectedInvoice)("suppliers",i.suppliers))},dependencies:[K,J,$,k,Q,X,Z,O,F,Y,N,B,ee,j,L,R,ie,zt,M]})}}return t})();var Un=()=>[10,25,50];function Jn(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Payment #"),o(),n(3,"th"),l(4,"Supplier"),o(),n(5,"th"),l(6,"Datetime"),o(),n(7,"th"),l(8,"total"),o(),n(9,"th",16),l(10,"Options"),o()())}function Xn(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td")(11,"button",17),d("click",function(){let i=_(e).$implicit,s=p();return u(s.printInvoice(i))}),o()(),n(12,"td")(13,"button",18),d("click",function(){let i=_(e).$implicit,s=p();return u(s.openEditDialog(i))}),o()()()}if(t&2){let e=m.$implicit;a(2),g(e.journal_number),a(2),g(e.partner_name),a(2),g(e.payment_date),a(2),g(b(9,4,e.total_value))}}function Zn(t,m){t&1&&(n(0,"tr")(1,"td",19),l(2,"No Records Found!"),o()())}var $t=(()=>{class t{constructor(){this.suppliersService=h(we),this.historyService=h(ne),this.dateService=h(le),this.suppliers=[],this.suppliersLoading=this.suppliersService.suppliersLoading,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.subscriptions=new G,this.receiptsHistory=this.historyService.receiptsHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({payment_date:new P(null),partner_id:new P(null),payment_number:new P(null)}),this.submitSearch()}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(e=>{this.suppliers=e}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get partner_id(){return this.searchForm.get("partner_id")}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=this.dateService.formatDate(this.searchForm.value.payment_date)),this.historyService.fetchReceiptsHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchReceiptsHistory(null)}showInvoiceDialog(e){}printInvoice(e){}openEditDialog(e){this.selectedPayment=e,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(e){this.historyService.fetchReceiptsHistory(this.searchForm.value)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-receipts-history"]],decls:20,vars:23,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_number","type","search","placeholder","Payment #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","partner_id","styleClass","p-inputtext-sm w-full","id","supplier","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Supplier","filterBy","name",3,"options","loading","filter","showClear","autoOptionFocus"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"onClose","onSubmit","visible","selected_payment","accounts"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print","disabled","",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"input",6),o(),n(8,"div",5),y(9,"p-dropdown",7),o(),n(10,"div",5),y(11,"p-calendar",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,Jn,11,0,"ng-template",12)(17,Xn,14,6,"ng-template",13)(18,Zn,3,0,"ng-template",14),o()()()(),n(19,"supplier-payment-dialog",15),d("onClose",function(){return i.hidePaymentDialog()})("onSubmit",function(f){return i.getPaymentDilogResult(f)}),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(5),c("options",i.suppliers)("loading",i.suppliersLoading())("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0),a(2),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.receiptsHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(22,Un))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),c("visible",i.editDialogVisible)("selected_payment",i.selectedPayment)("accounts",i.suppliers))},dependencies:[J,$,k,Q,X,Z,O,F,Y,N,B,j,L,R,ie,rt,M]})}}return t})();var Yt=(()=>{class t{constructor(){this.api=h(A),this.notificationService=h(q),this.http=h(ae),this.dateService=h(le),this.startDate=D(this.dateService.getStartOfMonth()),this.endDate=D(this.dateService.getCurrentDate()),this.loadingTransactions=D(!1),this.cashTransactions=D([])}startDateChanged(){this.startDate.set(this.dateService.formatDate(this.startDate(),"YYYY-MM-DD"))}getCashTransactions(e,r){this.loadingTransactions.set(!0),e=this.dateService.formatDate(e,"YYYY-MM-DD"),r=this.dateService.formatDate(r,"YYYY-MM-DD"),this.http.get(`${this.api.host}/balance/transactions/${e}&${r}`).subscribe({next:i=>{this.cashTransactions.set(i),this.loadingTransactions.set(!1)},error:i=>{this.notificationService.handleError(i.error,"home"),this.loadingTransactions.set(!1)}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=oe({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var eo=(t,m)=>({"text-300":t,"text-green-600":m}),to=(t,m)=>({"text-300":t,"text-red-600":m}),io=(t,m,e)=>({"text-red-600":t,"text-green-600":m,"font-bold":e}),no=(t,m)=>({"text-red-600":t,"text-green-600":m});function oo(t,m){if(t&1){let e=x();n(0,"label",9),l(1,"Start Date:"),o(),n(2,"p-calendar",10),T("ngModelChange",function(i){_(e);let s=p();return E(s.startDate,i)||(s.startDate=i),u(i)}),d("onSelect",function(){_(e);let i=p();return u(i.startDateChanged())}),o()}if(t&2){let e=p();a(2),w("ngModel",e.startDate),c("showIcon",!0)("readonlyInput",!0)("showButtonBar",!0)("required",!0)("iconDisplay","input")}}function ro(t,m){if(t&1){let e=x();n(0,"label",9),l(1,"End Date:"),o(),n(2,"p-calendar",10),T("ngModelChange",function(i){_(e);let s=p();return E(s.endDate,i)||(s.endDate=i),u(i)}),d("onSelect",function(){_(e);let i=p();return u(i.endDateChanged())}),o()}if(t&2){let e=p();a(2),w("ngModel",e.endDate),c("showIcon",!0)("readonlyInput",!0)("showButtonBar",!0)("required",!0)("iconDisplay","input")}}function ao(t,m){if(t&1){let e=x();n(0,"p-button",11),d("onClick",function(){_(e);let i=p();return u(i.selectToday())}),o(),n(1,"p-button",12),d("onClick",function(){_(e);let i=p();return u(i.selectThisMonth())}),o(),n(2,"p-button",13),d("onClick",function(){_(e);let i=p();return u(i.selectThisYear())}),o()}t&2&&(c("size","small"),a(),c("size","small"),a(),c("size","small"))}function lo(t,m){t&1&&(n(0,"tr")(1,"th",14),l(2,"Date"),o(),n(3,"th",14),l(4,"Transaction"),o(),n(5,"th",15),l(6,"Description"),o(),n(7,"th",15),l(8,"Debit"),o(),n(9,"th",15),l(10,"Credit"),o(),n(11,"th",15),l(12,"Balance"),o()())}function so(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td",16),l(8),C(9,"currency"),o(),n(10,"td",16),l(11),C(12,"currency"),o(),n(13,"td",16),l(14),C(15,"currency"),o()()),t&2){let e=m.$implicit,r=m.rowIndex,i=p();a(2),S(" ",e.journal_date||"Before "+i.startDate()," "),a(2),g(e.journal_number||"---"),a(2),g(e.journal_description||"---"),a(),c("ngClass",Ce(15,eo,e.debit==0,e.debit!=0)),a(),S(" ",b(9,9,e.debit)," "),a(2),c("ngClass",Ce(18,to,e.credit==0,e.credit!=0)),a(),S(" ",b(12,11,e.credit)," "),a(2),c("ngClass",ht(21,io,i.balances[r]<0,i.balances[r]>0,i.balances[r]==0)),a(),S(" ",b(15,13,i.balances[r])," ")}}function po(t,m){if(t&1&&(n(0,"tr"),y(1,"td",17),n(2,"td"),l(3,"Balance Due"),o(),n(4,"td",16),l(5),C(6,"currency"),o()()),t&2){let e=p();a(4),c("ngClass",Ce(4,no,e.balances[e.balances.length-1]<0,e.balances[e.balances.length-1]>0)),a(),S(" ",b(6,2,e.balances[e.balances.length-1])," ")}}var st=(()=>{class t{constructor(){this.transactionService=h(Yt),this.fb=h(Le),this.dateService=h(le),this.decimalService=h(se),this.loadingTransactions=this.transactionService.loadingTransactions,this.cashTransactions=this.transactionService.cashTransactions,this.startDate=this.transactionService.startDate,this.endDate=this.transactionService.endDate,this.balances=[],this.submitSearch(),gt(()=>{let e=this.cashTransactions();if(console.log(e),e.length>0){this.balances=[],this.balances[0]=parseFloat(e[0].balance);for(let r=1;r<e.length;r++)this.balances[r]=this.decimalService.add(this.balances[r-1],this.decimalService.subtract(e[r].debit,e[r].credit))}else this.balances=[]})}submitSearch(){this.transactionService.getCashTransactions(this.startDate(),this.endDate())}startDateChanged(){this.transactionService.startDateChanged(),this.submitSearch()}endDateChanged(){this.submitSearch()}selectToday(){this.transactionService.startDate.set(this.dateService.getCurrentDate()),this.transactionService.endDate.set(this.dateService.getCurrentDate()),this.submitSearch()}selectThisMonth(){this.transactionService.startDate.set(this.dateService.getStartOfMonth()),this.transactionService.endDate.set(this.dateService.getEndOfMonth()),this.submitSearch()}selectThisYear(){this.transactionService.startDate.set(this.dateService.getStartOfYear()),this.transactionService.endDate.set(this.dateService.getEndOfYear()),this.submitSearch()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["cash-transactions"]],standalone:!0,features:[ut],decls:11,vars:2,consts:[[1,"grid","m-1"],[1,"col-12"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["dataKey","account_number","styleClass","p-datatable-sm","scrollHeight","68vh",1,"ledger_table",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"mr-2"],["styleClass","p-inputtext-sm","dateFormat","yy-mm-dd",3,"ngModelChange","onSelect","ngModel","showIcon","readonlyInput","showButtonBar","required","iconDisplay"],["label","Today","severity","secondary",3,"onClick","size"],["styleClass","mx-2","label","This Month","severity","secondary",3,"onClick","size"],["label","This Year","severity","secondary",3,"onClick","size"],["width","20%"],["width","15%"],[3,"ngClass"],["colspan","4"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-toolbar"),v(4,oo,3,6,"ng-template",2)(5,ro,3,6,"ng-template",3)(6,ao,3,3,"ng-template",4),o(),n(7,"p-table",5),v(8,lo,13,0,"ng-template",6)(9,so,16,25,"ng-template",7)(10,po,7,7,"ng-template",8),o()()()()),r&2&&(a(7),c("value",i.cashTransactions())("scrollable",!0))},dependencies:[qe,B,F,et,$e,Ge,R,N,Ue,O,Ae,M,Ye,ze,k,We,Se,Re,be,Ze,bt]})}}return t})();var jt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-cash-history"]],decls:1,vars:0,template:function(r,i){r&1&&y(0,"cash-transactions")},dependencies:[st]})}}return t})();var mo=()=>[10,25,50],_o=()=>({width:"95vw"});function uo(t,m){t&1&&(n(0,"tr")(1,"th"),l(2,"Invoice #"),o(),n(3,"th"),l(4,"Customer"),o(),n(5,"th"),l(6,"Created at"),o(),n(7,"th"),l(8,"Deleted at"),o(),n(9,"th"),l(10,"Notes"),o(),n(11,"th"),l(12,"Total"),o(),n(13,"th"),l(14,"Options"),o()())}function ho(t,m){if(t&1){let e=x();n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),o(),n(9,"td"),l(10),o(),n(11,"td"),l(12),C(13,"currency"),o(),n(14,"td")(15,"p-button",18),d("onClick",function(){let i=_(e).$implicit,s=p();return u(s.showInvoiceDialog(i))}),o()()()}if(t&2){let e=m.$implicit;a(2),g(e.invoice_number),a(2),g(e.customer_name||"---"),a(2),g(e.order_date),a(2),g(e.deleted_at),a(2),g(e.delete_reason||"---"),a(2),g(b(13,6,e.total_amount))}}function go(t,m){t&1&&(n(0,"tr")(1,"td",19),l(2,"No Records Found!"),o()())}function fo(t,m){t&1&&(n(0,"th",27),l(1," Unit Cost "),o())}function vo(t,m){t&1&&(n(0,"th"),l(1,"Total Cost"),o())}function yo(t,m){if(t&1&&(n(0,"tr")(1,"th",22),l(2,"Barcode"),o(),n(3,"th",23),l(4,"Description"),o(),n(5,"th"),l(6,"Expiry Date"),o(),n(7,"th"),l(8,"Original Price"),o(),n(9,"th"),l(10,"Sold Price"),o(),n(11,"th"),l(12,"Discount %"),o(),n(13,"th",24),l(14,"Qty"),o(),n(15,"th"),l(16,"Total Price"),o(),v(17,fo,2,0,"th",25)(18,vo,2,0,"th",26),o()),t&2){let e=p(3);a(17),c("ngIf",e.userPermissions().show_cost),a(),c("ngIf",e.userPermissions().show_cost)}}function Co(t,m){if(t&1&&(n(0,"td",27),l(1),C(2,"currency"),o()),t&2){let e=p().$implicit;a(),S(" ",b(2,1,e.unit_cost)," ")}}function bo(t,m){if(t&1&&(n(0,"td"),l(1),C(2,"currency"),o()),t&2){let e=p().$implicit;a(),S(" ",b(2,1,e.unit_cost*e.quantity)," ")}}function So(t,m){if(t&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),C(9,"currency"),o(),n(10,"td"),l(11),C(12,"currency"),o(),n(13,"td"),l(14),o(),n(15,"td"),l(16),o(),n(17,"td"),l(18),C(19,"currency"),o(),v(20,Co,3,3,"td",25)(21,bo,3,3,"td",26),o()),t&2){let e=m.$implicit,r=p(3);a(2),g(e.barcode||"---"),a(2),g(e.product_name),a(2),g(e.expiry_date||"---"),a(2),g(b(9,10,e.original_price)),a(3),S(" ",b(12,12,e.unit_price)," "),a(3),S("",e.discount_percentage,"%"),a(2),g(e.quantity),a(2),S(" ",b(19,14,e.total_price)," "),a(2),c("ngIf",r.userPermissions().show_cost),a(),c("ngIf",r.userPermissions().show_cost)}}function xo(t,m){t&1&&y(0,"td",27)}function wo(t,m){if(t&1&&(n(0,"td"),l(1),C(2,"currency"),o()),t&2){let e=p(4);a(),S(" ",b(2,1,e.selectedInvoiceTotals.totalCost)," ")}}function Eo(t,m){if(t&1&&(n(0,"tr"),y(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td"),n(7,"td"),l(8),o(),n(9,"td"),l(10),C(11,"currency"),o(),v(12,xo,1,0,"td",25)(13,wo,3,3,"td",26),o()),t&2){let e=p(3);a(8),g(e.selectedInvoiceTotals.totalQty),a(2),S(" ",b(11,4,e.selectedInvoiceTotals.totalPrice)," "),a(2),c("ngIf",e.userPermissions().show_cost),a(),c("ngIf",e.userPermissions().show_cost)}}function To(t,m){if(t&1&&(n(0,"p-table",21),v(1,yo,19,2,"ng-template",12)(2,So,22,16,"ng-template",13)(3,Eo,14,6,"ng-template",17),o()),t&2){let e=p(2);c("value",e.invoiceItems)}}function Io(t,m){if(t&1&&v(0,To,4,1,"p-table",20),t&2){let e=p();c("ngIf",e.invoiceItems.length!=0)}}function Do(t,m){if(t&1){let e=x();n(0,"button",28),d("click",function(){_(e);let i=p();return u(i.hideInvoiceDialog())}),o()}}var Gt=(()=>{class t{constructor(){this.customerService=h(te),this.historyService=h(ne),this.decimalService=h(se),this.printService=h(Ee),this.authService=h(pe),this.whatsappService=h(at),this.dateService=h(le),this.userPermissions=this.authService.userPermissions,this.customers=this.customerService.customers,this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0},this.deletedHistory=this.historyService.deletedHistory,this.loading=this.historyService.signal_loading,this.searchForm=new U({invoice_number:new P(null),customer_id:new P(null),invoice_date:new P(null)})}submitSearch(){this.searchForm.value.invoice_date&&(this.searchForm.value.invoice_date=this.dateService.formatDate(this.searchForm.value.invoice_date,"YYYY-MM-DD")),this.historyService.fetchDeletedHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchDeletedHistory(null)}showInvoiceDialog(e){this.invoiceItems=e.items,this.invoiceItems.forEach(r=>{this.selectedInvoiceTotals.totalQty+=r.quantity,this.selectedInvoiceTotals.totalPrice=this.decimalService.add(this.selectedInvoiceTotals.totalPrice,r.total_price),this.selectedInvoiceTotals.totalCost=this.decimalService.add(this.selectedInvoiceTotals.totalCost,r.unit_cost*r.quantity)}),this.detailsDialogVisible=!0}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0,totalPrice:0,totalCost:0}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=V({type:t,selectors:[["app-delete-history"]],decls:22,vars:27,consts:[[1,"grid","m-1"],[1,"col-12"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["formControlName","customer_id","styleClass","p-inputtext-sm w-full","id","customer","appendTo","body","optionLabel","name","optionValue","account_id","placeholder","Select Customer","filterBy","name",3,"options","filter","showClear","autoOptionFocus"],["formControlName","invoice_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput","showButtonBar"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["size","small","severity","info","icon","fas fa-eye",3,"onClick"],["colspan","11"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","order_item_id","styleClass","p-datatable-sm",3,"value"],["width","15%"],["width","30%"],["width","5%"],["style","border-left: 1px #e5e7eb solid",4,"ngIf"],[4,"ngIf"],[2,"border-left","1px #e5e7eb solid"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),d("ngSubmit",function(){return i.submitSearch()}),n(5,"div",4)(6,"div",5),y(7,"input",6),o(),n(8,"div",5),y(9,"p-dropdown",7),o(),n(10,"div",5),y(11,"p-calendar",8),o(),n(12,"div",5),y(13,"p-button",9),n(14,"p-button",10),d("onClick",function(){return i.resetSearch()}),o()()()()(),n(15,"p-table",11),v(16,uo,15,0,"ng-template",12)(17,ho,16,8,"ng-template",13)(18,go,3,0,"ng-template",14),o()()()(),n(19,"p-dialog",15),T("visibleChange",function(f){return E(i.detailsDialogVisible,f)||(i.detailsDialogVisible=f),f}),d("onHide",function(){return i.hideInvoiceDialog()}),v(20,Io,1,1,"ng-template",16)(21,Do,1,0,"ng-template",17),o()),r&2&&(a(3),c("toggleable",!0),a(),c("formGroup",i.searchForm),a(5),c("options",i.customers())("filter",!0)("showClear",!0)("autoOptionFocus",!1),a(2),c("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showButtonBar",!0),a(2),c("loading",i.loading()),a(),c("disabled",i.loading()),a(),c("value",i.deletedHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",I(25,mo))("alwaysShowPaginator",!1)("loading",i.loading()),a(4),W(I(26,_o)),w("visible",i.detailsDialogVisible),c("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[K,J,$,k,Q,X,Z,O,F,Y,N,B,ee,j,L,R,ie,M]})}}return t})();var Po=[{path:"sales-history",data:{breadcrumb:"sales"},component:kt},{path:"payment-history",data:{breadcrumb:"payments"},component:Nt},{path:"return-history",data:{breadcrumb:"returns"},component:Ot},{path:"purchases-history",data:{breadcrumb:"purchases"},component:At},{path:"receipts-history",data:{breadcrumb:"receipts"},component:$t},{path:"cash-history",data:{breadcrumb:"Cash"},component:jt,canActivate:[dt]},{path:"deleted-history",data:{breadcrumb:"deleted invoices"},component:Gt,canActivate:[dt]}],Kt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Fe({type:t})}static{this.\u0275inj=Me({imports:[mt.forChild(Po),mt]})}}return t})();var os=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Fe({type:t})}static{this.\u0275inj=Me({imports:[Re,Kt,ze,ft,xe,Ue,Ae,qe,vt,$e,Ze,Ye,Ge,et,It,yt,Dt,Et,St,Xe,rt,st]})}}return t})();export{os as HistoryModule};
