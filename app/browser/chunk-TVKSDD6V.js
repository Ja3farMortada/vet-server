import{a as q}from"./chunk-P4XVUZNK.js";import{a as H}from"./chunk-6SPTK7QA.js";import{a as ze}from"./chunk-2GGW4UQB.js";import{a as He,b as qe}from"./chunk-6VIVHFH4.js";import{a as Ne,b as Pe,d as Qe}from"./chunk-NIY2QWE7.js";import"./chunk-2UFRC7H2.js";import{b as Ke}from"./chunk-IVGK5S3B.js";import{a as Re,b as We}from"./chunk-R52AXQF7.js";import{b as Ae}from"./chunk-NEXFYW5Q.js";import{b as we}from"./chunk-W62V2T36.js";import{b as Ge}from"./chunk-YYILVVI3.js";import{a as xe}from"./chunk-7OIYUPV4.js";import"./chunk-HUT5LNQK.js";import"./chunk-6M5CHABF.js";import{b as Ie,d as V,g as ke,o as Be}from"./chunk-76SN6DIJ.js";import{a as De,b as Te}from"./chunk-KWHJ4U2D.js";import"./chunk-PTV2L6W6.js";import{b as Le}from"./chunk-I3ZYYSXS.js";import{c as Me,d as Ee,i as Ve,j as Fe}from"./chunk-7RM63TIB.js";import{a as je,b as Oe}from"./chunk-KTNSRC6L.js";import"./chunk-VVJEHS3M.js";import{a as ue,b as ge}from"./chunk-2WM322QF.js";import"./chunk-DSRCPEU4.js";import{$b as E,A as w,Aa as Q,Ab as z,B as N,Ba as A,C as P,Ca as K,Da as p,Ea as D,Fa as T,Gb as te,H as _,Ha as C,I as f,Ia as y,Ja as v,Ma as M,Na as Z,Oa as L,Pb as j,U as X,Ub as ie,V as s,Va as F,Wa as I,Wb as ne,Yb as O,Zb as re,_b as le,ac as oe,bc as ae,cc as se,da as h,db as R,dc as pe,ec as me,fa as m,fb as W,gc as de,h as U,hc as ce,i as k,ia as Y,ib as $,jb as ee,la as i,lc as _e,ma as r,na as S,oc as fe,pc as he,qc as Se,ra as x,rc as be,sa as c,sc as Ce,ta as u,tc as ye,uc as ve,x as B,za as G}from"./chunk-FYHOXPUP.js";var it=()=>({"min-width":"45rem"}),nt=(t,l)=>({"text-300":t,"text-red-600":l}),rt=(t,l)=>({"text-300":t,"text-green-600":l}),lt=(t,l)=>({"text-green-600":t,"text-red-600":l});function ot(t,l){t&1&&(i(0,"tr")(1,"th"),p(2,"Date"),r(),i(3,"th"),p(4,"#"),r(),i(5,"th"),p(6,"Description"),r(),i(7,"th"),p(8,"Debit"),r(),i(9,"th"),p(10,"Credit"),r(),i(11,"th"),p(12,"Balance"),r()())}function at(t,l){if(t&1&&(i(0,"tr")(1,"td"),p(2),r(),i(3,"td"),p(4),r(),i(5,"td"),S(6,"p-tag",16),r(),i(7,"td",17),p(8),F(9,"currency"),r(),i(10,"td",17),p(11),F(12,"currency"),r(),i(13,"td"),p(14),F(15,"currency"),r()()),t&2){let e=l.$implicit,a=l.rowIndex,n=u(2);s(2),T(" ",e.journal_date||"Before "+n.startDate," "),s(2),D(e.journal_number),s(2),m("value",e.journal_description)("severity",n.getSeverity(e.journal_description)),s(),m("ngClass",L(15,nt,e.debit==0,e.debit!=0)),s(),T(" ",I(9,9,e.debit)," "),s(2),m("ngClass",L(18,rt,e.credit==0,e.credit!=0)),s(),T(" ",I(12,11,e.credit)," "),s(3),T(" ",I(15,13,n.balances[a])," ")}}function st(t,l){if(t&1&&(i(0,"tr"),S(1,"td",18),i(2,"td"),p(3,"Balance Due"),r(),i(4,"td",19),p(5),F(6,"currency"),r()()),t&2){let e=u(2);s(4),m("ngClass",L(4,lt,e.balances[e.balances.length-1]<0,e.balances[e.balances.length-1]>0)),s(),T(" ",I(6,2,e.balances[e.balances.length-1])," ")}}function pt(t,l){if(t&1&&(i(0,"div",1),S(1,"p-divider"),i(2,"p-table",12),h(3,ot,13,0,"ng-template",13)(4,at,16,21,"ng-template",14)(5,st,7,7,"ng-template",15),r()()),t&2){let e=u();s(2),m("value",e.data)("tableStyle",M(3,it))("loading",e.tableLoading())}}var Je=(()=>{let l=class l{constructor(){this.suppliersService=w(H),this.dateService=w(xe),this.subscriptions=new k,this.suppliers=[],this.startDate=this.dateService.getStartOfMonth(),this.endDate=this.dateService.getCurrentDate(),this.balances=[],this.balances_lbp=[],this.show_dollar=!0,this.data=[],this.paymentDialogVisible=!1,this.suppliersLoading=this.suppliersService.suppliersLoading,this.tableLoading=this.suppliersService.tableLoading}ngOnInit(){this.subscriptions.add(this.suppliersService.suppliers$.subscribe(a=>{this.suppliers=a})),this.subscriptions.add(this.suppliersService.supplierBalance$.subscribe(a=>{if(this.data=a,a.length>0){this.balances=[],this.balances_lbp=[],this.balances[0]=parseFloat(a[0].balance),this.balances_lbp[0]=parseFloat(a[0].debit_lbp)-parseFloat(a[0].credit_lbp);for(let n=1;n<a.length;n++)this.balances[n]=this.balances[n-1]+parseFloat(a[n].debit)-parseFloat(a[n].credit),this.balances_lbp[n]=this.balances_lbp[n-1]+parseFloat(a[n].debit_lbp)-parseFloat(a[n].credit_lbp)}else this.balances=[],this.balances_lbp=[]}))}ngOnDestroy(){this.subscriptions.unsubscribe(),this.suppliersService.supplierBalance$.next([])}startDateChanged(){this.startDate=this.dateService.formatDate(this.startDate),this.resetTable()}endDateChanged(){this.endDate=this.dateService.formatDate(this.endDate),this.resetTable()}accountChanged(){this.resetTable()}getStatements(){this.selectedSupplier&&this.startDate&&this.endDate&&this.suppliersService.getSupplierTransactions(this.selectedSupplier,this.startDate,this.endDate)}resetTable(){this.data=[],this.balances=[],this.balances_lbp=[]}getSeverity(a){switch(a){case"Supplier Payment":return"danger";case"Supply":return"success";default:return"contrast"}}};l.\u0275fac=function(n){return new(n||l)},l.\u0275cmp=N({type:l,selectors:[["app-statements"]],decls:22,vars:20,consts:[[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","md:col-3"],["optionLabel","name","optionValue","account_id","placeholder","Select Supplier","styleClass","p-inputtext-sm",3,"ngModelChange","onChange","options","ngModel","showClear","loading","autoOptionFocus"],[1,"col-12","md:col-2"],["styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd",3,"ngModelChange","onSelect","ngModel","showIcon","iconDisplay","readonlyInput"],[1,"col-6","md:col-2","mt-auto"],["label","Payment","size","small","icon","pi pi-dollar","severity","success","styleClass","w-full",3,"onClick","disabled"],["label","Search","size","small","icon","pi pi-search","styleClass","w-full",3,"onClick","loading","disabled"],["class","col-12",4,"ngIf"],["type","supplier",3,"onClose","visible","accounts","selected_account"],["dataKey","account_number","styleClass","p-datatable-sm",1,"ledger_table",3,"value","tableStyle","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"value","severity"],[3,"ngClass"],["colspan","4"],[1,"font-bold",3,"ngClass"]],template:function(n,o){n&1&&(i(0,"div",0)(1,"div",1)(2,"p-card")(3,"div",2)(4,"div",3)(5,"label"),p(6,"Select Supplier:"),r(),i(7,"p-dropdown",4),v("ngModelChange",function(g){return y(o.selectedSupplier,g)||(o.selectedSupplier=g),g}),c("onChange",function(){return o.accountChanged()}),r()(),i(8,"div",5)(9,"label"),p(10,"Start Date:"),r(),i(11,"p-calendar",6),v("ngModelChange",function(g){return y(o.startDate,g)||(o.startDate=g),g}),c("onSelect",function(){return o.startDateChanged()}),r()(),i(12,"div",5)(13,"label"),p(14,"End Date:"),r(),i(15,"p-calendar",6),v("ngModelChange",function(g){return y(o.endDate,g)||(o.endDate=g),g}),c("onSelect",function(){return o.endDateChanged()}),r()(),i(16,"div",7)(17,"p-button",8),c("onClick",function(){return o.paymentDialogVisible=!0}),r()(),i(18,"div",7)(19,"p-button",9),c("onClick",function(){return o.getStatements()}),r()(),h(20,pt,6,4,"div",10),r()()(),i(21,"supplier-payment-dialog",11),c("onClose",function(){return o.paymentDialogVisible=!1}),r()()),n&2&&(s(7),m("options",o.suppliers),C("ngModel",o.selectedSupplier),m("showClear",!0)("loading",o.suppliersLoading())("autoOptionFocus",!1),s(4),C("ngModel",o.startDate),m("showIcon",!0)("iconDisplay","input")("readonlyInput",!0),s(4),C("ngModel",o.endDate),m("showIcon",!0)("iconDisplay","input")("readonlyInput",!0),s(2),m("disabled",!o.selectedSupplier),s(2),m("loading",o.tableLoading())("disabled",!o.selectedSupplier),s(),m("ngIf",o.data.length>0),s(),m("visible",o.paymentDialogVisible)("accounts",o.suppliers)("selected_account",o.selectedSupplier))},dependencies:[R,W,O,oe,j,V,be,Ve,ue,Re,Ne,Me,q,$],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}"]});let t=l;return t})();var mt=["tableSearch"],dt=()=>[10,15,50,100],ct=()=>["name","phone","address"],ut=()=>({width:"55vw"}),gt=t=>({"ng-invalid ng-dirty":t});function _t(t,l){if(t&1){let e=x();i(0,"div",14)(1,"span",15),S(2,"i",16),i(3,"input",17,1),c("input",function(n){_(e),u();let o=K(6);return f(o.filterGlobal(n.target.value,"contains"))}),r()()(),i(5,"button",18),c("click",function(){_(e);let n=u();return f(n.resetTable())}),r(),i(6,"button",19),c("click",function(){_(e);let n=u();return f(n.openSupplierDialog("add"))}),r()}if(t&2){u();let e=K(6);s(3),m("value",e.filters.global==null?null:e.filters.global.value)}}function ft(t,l){if(t&1){let e=x();i(0,"button",20),c("click",function(){_(e);let n=u();return f(n.openSupplierDialog("edit"))}),r(),i(1,"button",21),c("click",function(){_(e);let n=u();return f(n.deleteSelectedSupplier())}),r()}if(t&2){let e=u();m("disabled",!e.selectedSupplier),s(),m("disabled",!e.selectedSupplier)}}function ht(t,l){t&1&&(i(0,"tr")(1,"th",22),p(2,"Supplier Name"),r(),i(3,"th",23),p(4,"Phone Number"),r(),i(5,"th",24),p(6,"Address"),r()())}function St(t,l){if(t&1&&(i(0,"tr",25)(1,"td"),p(2),r(),i(3,"td"),p(4),r(),i(5,"td"),p(6),r()()),t&2){let e=l.$implicit;m("pSelectableRow",e),s(2),D(e.name),s(2),D(e.phone||" --- "),s(2),D(e.address||" --- ")}}function bt(t,l){t&1&&(i(0,"tr")(1,"td",26),p(2,"No suppliers yet!"),r()())}function Ct(t,l){t&1&&(i(0,"small",38),p(1,"Name is required."),r())}function yt(t,l){if(t&1){let e=x();i(0,"form",27),c("ngSubmit",function(){_(e);let n=u();return f(n.submitSupplier())}),i(1,"div",28)(2,"div",29)(3,"label",30),p(4,"Supplier Name"),r(),S(5,"input",31),h(6,Ct,2,0,"small",32),r(),i(7,"div",29)(8,"label",33),p(9,"Supplier Phone"),r(),S(10,"input",34),r(),i(11,"div",35)(12,"label",36),p(13,"Address"),r(),i(14,"textarea",37),p(15,"                    "),r()()()()}if(t&2){let e=u();m("formGroup",e.supplierForm),s(5),m("ngClass",Z(3,gt,e.submitted&&(e.name==null?null:e.name.invalid)&&((e.name==null?null:e.name.dirty)||(e.name==null?null:e.name.touched)))),s(),m("ngIf",e.submitted&&(e.name==null?null:e.name.invalid)&&((e.name==null?null:e.name.dirty)||(e.name==null?null:e.name.touched)))}}function vt(t,l){if(t&1){let e=x();i(0,"button",39),c("click",function(){_(e);let n=u();return f(n.supplierDialogVisible=!1)}),r(),i(1,"button",40),c("click",function(){_(e);let n=u();return f(n.submitSupplier())}),r()}if(t&2){let e=u();s(),m("loading",e.submitLoading())}}var Ue=(()=>{let l=class l{constructor(){this.supplierService=w(H),this.confirmationService=w(te),this.subscriptions=new k,this.suppliers=[],this.supplierDialogVisible=!1,this.submitted=!1,this.submitLoading=this.supplierService.submitLoading,this.suppliersLoading=this.supplierService.suppliersLoading,this.supplierForm=new le({account_id:new E(null),name:new E("",ne.required),phone:new E(""),address:new E(""),financial_number:new E("")})}onKeyDown(a){this.supplierDialogVisible||this.tableSearch.nativeElement.focus()}ngOnInit(){this.subscriptions.add(this.supplierService.suppliers$.subscribe(a=>{this.suppliers=a,this.selectedSupplier&&(this.selectedSupplier=this.suppliers.find(n=>n.account_id===this.selectedSupplier.account_id))})),this.subscriptions.add(this.supplierService.supplierDialogVisible$.subscribe(a=>{this.supplierDialogVisible=a}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get name(){return this.supplierForm.get("name")}openSupplierDialog(a){this.dialogMode=a,this.dialogMode=="add"?this.supplierDialogVisible=!0:this.dialogMode=="edit"&&(this.supplierForm.patchValue(this.selectedSupplier),this.supplierDialogVisible=!0)}resetDialog(){this.submitted=!1,this.supplierForm.reset({})}submitSupplier(){return U(this,null,function*(){this.submitted=!0,this.dialogMode=="add"?this.supplierForm.valid&&(yield this.supplierService.createSupplier(this.supplierForm.value)):this.supplierForm.valid&&(yield this.supplierService.updateSupplier(this.supplierForm.value))})}deleteSelectedSupplier(){this.confirmationService.confirm({key:"home",message:`Are you sure that you want to delete "${this.selectedSupplier.name}"?`,header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.supplierService.deleteSupplier(this.selectedSupplier),this.selectedSupplier=null}})}resetTable(){this.selectedSupplier=null,this.ct.reset(),this.ct.sortField="account_id",this.ct.sortOrder=1,this.ct.sortSingle(),this.supplierService.getSuppliers()}};l.\u0275fac=function(n){return new(n||l)},l.\u0275cmp=N({type:l,selectors:[["app-settings"]],viewQuery:function(n,o){if(n&1&&(G(V,5),G(mt,5)),n&2){let d;Q(d=A())&&(o.ct=d.first),Q(d=A())&&(o.tableSearch=d.first)}},hostBindings:function(n,o){n&1&&c("keydown",function(g){return o.onKeyDown(g)},!1,X)},decls:13,vars:17,consts:[["ct",""],["tableSearch",""],[1,"grid","mr-8","ml-8","mt-1"],[1,"col-12"],["styleClass","p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single","dataKey","account_id",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Suppliers","styleClass","p-fluid","position","top",3,"visibleChange","onHide","visible","modal"],["pTemplate","content"],["pTemplate","footer"],[1,"flex"],[1,"p-input-icon-left","mr-auto"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["pButton","","pRipple","","label","Reset Table","icon","pi pi-refresh",1,"p-button-primary","p-button-sm","mx-2",3,"click"],["pButton","","pRipple","","label","New Supplier","icon","pi pi-plus",1,"p-button-success","mr-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],["width","55%"],["width","%20"],["width","%25"],[3,"pSelectableRow"],["colspan","3"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-6"],["for","name"],["id","name","type","text","pInputText","","formControlName","name","autocomplete","off","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],["for","phone"],["id","phone","type","text","autocomplete","on","pInputText","","formControlName","phone","spellcheck","false"],[1,"field","col-12","md:col-12"],["for","address"],["id","address","name","address","rows","3","pInputTextarea","","formControlName","address","spellcheck","false"],[1,"p-error"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click","loading"]],template:function(n,o){if(n&1){let d=x();i(0,"div",2)(1,"div",3)(2,"p-toolbar",4),h(3,_t,7,1,"ng-template",5)(4,ft,2,2,"ng-template",6),r(),i(5,"p-table",7,0),v("selectionChange",function(b){return _(d),y(o.selectedSupplier,b)||(o.selectedSupplier=b),f(b)}),h(7,ht,7,0,"ng-template",8)(8,St,7,4,"ng-template",9)(9,bt,3,0,"ng-template",10),r()()(),i(10,"p-dialog",11),v("visibleChange",function(b){return _(d),y(o.supplierDialogVisible,b)||(o.supplierDialogVisible=b),f(b)}),c("onHide",function(){return _(d),f(o.resetDialog())}),h(11,yt,16,5,"ng-template",12)(12,vt,2,1,"ng-template",13),r()}n&2&&(s(5),m("value",o.suppliers),C("selection",o.selectedSupplier),m("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",M(14,dt))("alwaysShowPaginator",!0)("globalFilterFields",M(15,ct))("filterDelay",0)("loading",o.suppliersLoading()),s(5),Y(M(16,ut)),C("visible",o.supplierDialogVisible),m("modal",!0))},dependencies:[R,W,ae,ie,O,re,me,se,pe,j,V,ke,Se,je,De,fe,ye,He]});let t=l;return t})();var wt=[{path:"statements",data:{breadcrumb:"Statements"},component:Je},{path:"settings",data:{breadcrumb:"Settings"},component:Ue},{path:"**",redirectTo:"/suppliers/statements"}],Xe=(()=>{let l=class l{};l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=P({type:l}),l.\u0275inj=B({imports:[z.forChild(wt),z]});let t=l;return t})();var ki=(()=>{let l=class l{};l.\u0275fac=function(n){return new(n||l)},l.\u0275mod=P({type:l}),l.\u0275inj=B({imports:[ee,Xe,de,ce,ze,we,Be,Ge,Ce,Oe,Te,he,ve,Ae,Ke,Fe,Le,Ie,qe,ge,We,_e,Qe,Pe,Ee,q]});let t=l;return t})();export{ki as SuppliersModule};
