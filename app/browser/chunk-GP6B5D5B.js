import{a as m,b as u}from"./chunk-O2Z7APEW.js";import{Cb as a,G as r,J as n,Lb as h,N as t,hc as g,ic as p,oa as i}from"./chunk-TC4DAS4S.js";var w=(()=>{class s{constructor(){this.notificationService=t(g),this.http=t(a),this.tokenStorage=t(m),this.router=t(h),this.api=t(p),this.userService=t(u),this.host=this.api.host,this.isLoggedIn=i(this.tokenStorage.getToken()!==null),this.isAdmin=i(this.tokenStorage.getType()==="admin"),this.userPermissions=i(this.tokenStorage.getPermissions())}login(o){return this.http.post(`${this.host}/auth/login`,{username:o.username,password:o.password}).pipe(r(e=>{this.tokenStorage.saveUser(e.username),this.tokenStorage.saveType(e.user_type),this.tokenStorage.saveToken(e.token),this.tokenStorage.saveName(e.first_name),this.tokenStorage.saveSocketId(e.socket_id),this.tokenStorage.savePermissions(e.permissions),this.userService.loggedInUser.set(e.username),this.userService.loggedInName.set(e.first_name),this.userService.userType.set(e.user_type),this.userService.socketId.set(e.socket_id),this.isLoggedIn.set(!0),this.isAdmin.set(e.user_type==="admin"),this.userPermissions.set(e.permissions),this.router.navigate(["/home"])}))}logout(){this.userService.resetUser(),window.sessionStorage.clear(),this.isLoggedIn.set(!1),this.isAdmin.set(!1),this.userPermissions.set(null),this.router.navigate(["/login"])}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{w as a};
