import{b as Ie,c as je}from"./chunk-D7T2LM47.js";import"./chunk-SJOBI5EF.js";import{b as ce}from"./chunk-QEEBQYAT.js";import{b as Me}from"./chunk-WFY3F6FL.js";import{a as we,b as Se,d as L,o as Ee}from"./chunk-SW5CXPYQ.js";import"./chunk-4UGCOW2V.js";import{c as ve,d as Y,j as q}from"./chunk-P3OYWVPG.js";import{a as De,b as Te}from"./chunk-GRPO54WU.js";import"./chunk-V7SUP5NO.js";import{a as Ae,b as Ce}from"./chunk-EVKGT6TP.js";import{a as xe,b as be}from"./chunk-VRTFVVJY.js";import"./chunk-ULBQ4ARH.js";import{$a as se,Aa as a,Ab as O,Ba as X,Cb as H,Fa as y,Ga as h,Ha as _,Hc as ye,Ic as W,J as T,Jc as R,K as M,Kc as z,Lc as Q,M as I,N as f,Na as P,O as j,Oa as k,P as V,Pa as F,Qa as Z,Ra as l,Rb as $,Sa as v,Sb as N,U as ie,V as d,Va as w,W as u,Wa as S,Xa as E,Xb as de,Za as oe,_ as K,_a as C,ec as A,g as Ne,ha as p,hb as ae,hc as B,i as ee,ia as J,ib as re,jc as ue,l as te,nc as _e,oa as x,ra as b,rc as he,ta as c,ub as le,vc as fe,wa as ne,wb as pe,xc as ge,za as s,zb as me}from"./chunk-UKD27P7M.js";var Ve=(()=>{let t=class t{constructor(){this.http=f(H),this.api=f(N),this.notificationService=f(B),this.host=this.api.host,this.expenses=x([]),this.loading_table=x(!1),this.user_balance=x({}),this.laoding_balance=x(!1),this.getExpenses()}getExpenses(){this.loading_table.set(!0),this.http.get(this.host+"/expense").subscribe({next:n=>{this.expenses.set(n)},error:n=>{console.log(n),this.notificationService.showError(n.error,"home"),this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=T({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var ke=Ne(Ae());var Pe=(()=>{let t=class t{constructor(n,e,o){this.http=n,this.api=e,this.notificationService=o,this.host=this.api.host,this.expensesAccounts=x([]),this.loading_table=x(!1),this.status_action$=new te({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(this.host+"/expense/accounts").subscribe({next:n=>{this.expensesAccounts.set(n)},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(n){this.loading_table.set(!0),this.http.post(this.host+"/expense",n).subscribe({next:e=>{this.notificationService.showSuccess("Payment added successfully","home"),this.status_action$.next({action:"ADD"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(n){this.loading_table.set(!0),this.http.put(this.host+"/expense",n).subscribe({next:e=>{this.notificationService.showSuccess("Payment updated successfully","home"),this.status_action$.next({action:"UPDATE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(n){this.loading_table.set(!0),this.http.delete(this.host+"/expense/"+n).subscribe({next:e=>{this.notificationService.showSuccess("Payment deleted successfully","home"),this.status_action$.next({action:"DELETE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}};t.\u0275fac=function(e){return new(e||t)(I(H),I(N),I(B))},t.\u0275prov=T({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var Ye=["amountInput"],qe=()=>({width:"75vw"}),Le=()=>({"1199px":"85vw","575px":"95vw"}),Ue=i=>({"ng-invalid ng-dirty":i});function Ge(i,t){i&1&&(s(0,"small",15),l(1,"Date is required."),a())}function Ke(i,t){i&1&&(s(0,"small",15),l(1,"Ammount is required."),a())}function Je(i,t){if(i&1){let r=y();s(0,"div",4)(1,"div",5)(2,"div",6)(3,"label",7),l(4,"Description"),s(5,"span",8),l(6," *"),a()(),s(7,"input",9),E("ngModelChange",function(e){d(r);let o=_();return S(o.journal_description,e)||(o.journal_description=e),u(e)}),a()()(),s(8,"div",5)(9,"label",10),l(10,"Payment Date"),s(11,"span",8),l(12," *"),a()(),s(13,"p-calendar",11),E("ngModelChange",function(e){d(r);let o=_();return S(o.payment_date,e)||(o.payment_date=e),u(e)}),a(),b(14,Ge,2,0,"small",12),a(),s(15,"div",5)(16,"div",6)(17,"label",13),l(18,"Amount"),s(19,"span",8),l(20," *"),a()(),s(21,"p-inputNumber",14,0),E("ngModelChange",function(e){d(r);let o=_();return S(o.amount,e)||(o.amount=e),u(e)}),h("onFocus",function(e){d(r);let o=_();return u(o.selectInput(e))}),a(),b(23,Ke,2,0,"small",12),a()()()}if(i&2){let r=_();p(7),w("ngModel",r.journal_description),p(6),w("ngModel",r.payment_date),c("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),p(),c("ngIf",r.submitted&&!r.payment_date),p(7),w("ngModel",r.amount),c("required",!0)("ngClass",se(11,Ue,r.submitted&&!r.amount)),p(2),c("ngIf",r.submitted&&!r.amount)}}function Xe(i,t){if(i&1){let r=y();s(0,"p-button",19),h("onClick",function(){d(r);let e=_(2);return u(e.deletePayment())}),a()}if(i&2){let r=_(2);c("disabled",r.loading())}}function Ze(i,t){if(i&1){let r=y();b(0,Xe,1,1,"p-button",16),s(1,"p-button",17),h("onClick",function(){d(r);let e=_();return u(e.closeDialog())}),a(),s(2,"p-button",18),h("onClick",function(){d(r);let e=_();return u(e.submitPayment())}),a()}if(i&2){let r=_();c("ngIf",r.dialog_mode==="edit"),p(),c("disabled",r.loading()),p(),c("loading",r.loading())}}var U=(()=>{let t=class t{constructor(n,e){this.expensesService=n,this.confirmationService=e,this.visible=!1,this.dialog_mode="add",this.OnClose=new K,this.OnSubmit=new K,this.dateService=f(Ce),this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.submitted=!1,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null,this.subscriptions=new ee}initDialog(){this.submitted=!1,this.amount=null,this.journal_description=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(n=>{n.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"YYYY-MM-DD HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}deletePayment(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.expensesService.deletePayment(this.selected_payment.journal_id)}})}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=(0,ke.default)(this.payment_date).format("YYYY-MM-DD HH:mm:ss"),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id}))}selectInput(n){n.target.select()}};t.\u0275fac=function(e){return new(e||t)(J(Pe),J(de))},t.\u0275cmp=j({type:t,selectors:[["expenses-dialog"]],viewQuery:function(e,o){if(e&1&&P(Ye,5),e&2){let m;k(m=F())&&(o.amountInput=m.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[ie,oe],decls:3,vars:10,consts:[["amountInput",""],["position","top","header","Submit Expense","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],[1,"flex","flex-column","gap-2"],["for","Type"],[1,"text-red-500"],["type","text","pInputText","",3,"ngModelChange","ngModel"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["class","p-error",4,"ngIf"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","ngClass"],[1,"p-error"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["pRipple","","size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","disabled"],["pRipple","","size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","disabled"]],template:function(e,o){e&1&&(s(0,"p-dialog",1),E("visibleChange",function(g){return S(o.visible,g)||(o.visible=g),g}),h("onHide",function(){return o.closeDialog()}),b(1,Je,24,13,"ng-template",2)(2,Ze,3,3,"ng-template",3),a()),e&2&&(ne(C(8,qe)),c("modal",!0),w("visible",o.visible),c("breakpoints",C(9,Le))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[Te,De,A,R,W,q,Y,ve,Se,we,ge,ue,_e,fe,he,O,le,pe,Q,z]});let i=t;return i})();var et=()=>[10,25,50],tt=()=>["journal_number","journal_description","payment_date"];function it(i,t){i&1&&(s(0,"tr")(1,"th"),l(2,"Expense #"),a(),s(3,"th"),l(4,"Description"),a(),s(5,"th"),l(6,"Datetime"),a(),s(7,"th"),l(8,"total"),a(),s(9,"th",19),l(10,"Options"),a()())}function nt(i,t){if(i&1){let r=y();s(0,"tr")(1,"td"),l(2),a(),s(3,"td"),l(4),a(),s(5,"td"),l(6),a(),s(7,"td"),l(8),ae(9,"currency"),a(),s(10,"td")(11,"button",20),h("click",function(){let e=d(r).$implicit,o=_();return u(o.openEditDialog(e))}),a()()()}if(i&2){let r=t.$implicit;p(2),v(r.journal_number),p(2),v(r.journal_description),p(2),v(r.payment_date),p(2),v(re(9,4,r.total_value))}}function ot(i,t){i&1&&(s(0,"tr")(1,"td",21),l(2,"No Records Found!"),a()())}var Fe=(()=>{let t=class t{constructor(){this.userService=f(ce),this.expensesService=f(Ve),this.expenses=this.expensesService.expenses,this.expenses_dialog_visible=!1,this.loading=this.expensesService.loading_table,this.loading_balance=this.expensesService.laoding_balance,this.dialog_mode="add",this.balance=this.expensesService.user_balance,this.userType=this.userService.userType}addExpense(){this.dialog_mode="add",this.expenses_dialog_visible=!0}openEditDialog(n){this.dialog_mode="edit",this.selected_payment=n,this.expenses_dialog_visible=!0}onExpenseSumbitted(n){this.refetchExpenses()}closeDialog(){this.expenses_dialog_visible=!1}refetchExpenses(){this.expensesService.getExpenses()}refreshBalance(){}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=j({type:t,selectors:[["app-expenses-home"]],viewQuery:function(e,o){if(e&1&&P(L,5),e&2){let m;k(m=F())&&(o.ct=m.first)}},decls:20,vars:16,consts:[["tableSearch",""],["ct",""],[1,"grid","m-1"],[1,"col-12"],[1,"col-12","grid"],[1,"col-7","md:col-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["id","globalFilter","pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm","w-full",3,"input","value"],[1,"col-5","md:col-2"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","w-full",3,"onClick","loading"],[1,"col-6","md:col-2"],["label","Add Expense","severity","success","icon","pi pi-plus","size","small","styleClass","w-full",3,"onClick"],[1,"col-1","hidden","lg:block","md:col-2"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"OnClose","OnSubmit","visible","selected_payment","dialog_mode"],["width","10%"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(e,o){if(e&1){let m=y();s(0,"div",2)(1,"div",3)(2,"p-card")(3,"div",4)(4,"div",5)(5,"span",6),X(6,"i",7),s(7,"input",8,0),h("input",function(G){d(m);let He=Z(15);return u(He.filterGlobal(G.target.value,"contains"))}),a()()(),s(9,"div",9)(10,"p-button",10),h("onClick",function(){return d(m),u(o.refetchExpenses())}),a()(),s(11,"div",11)(12,"p-button",12),h("onClick",function(){return d(m),u(o.addExpense())}),a()(),X(13,"div",13),a(),s(14,"p-table",14,1),b(16,it,11,0,"ng-template",15)(17,nt,12,6,"ng-template",16)(18,ot,3,0,"ng-template",17),a()()()(),s(19,"expenses-dialog",18),h("OnClose",function(){return d(m),u(o.closeDialog())})("OnSubmit",function(G){return d(m),u(o.onExpenseSumbitted(G))}),a()}if(e&2){let m=Z(15);p(7),c("value",m.filters.global==null?null:m.filters.global.value),p(3),c("loading",o.loading()),p(4),c("value",o.expenses())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",C(14,et))("alwaysShowPaginator",!0)("loading",o.loading())("globalFilterFields",C(15,tt))("filterDelay",0),p(5),c("visible",o.expenses_dialog_visible)("selected_payment",o.selected_payment)("dialog_mode",o.dialog_mode)}},dependencies:[ye,W,A,U,xe,L,z,me]});let i=t;return i})();var st=[{path:"",component:Fe}],Oe=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=V({type:t}),t.\u0275inj=M({imports:[$.forChild(st),$]});let i=t;return i})();var pi=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=V({type:t}),t.\u0275inj=M({imports:[O,Oe,R,U,be,Ee,Y,q,Me,Q,Ie,je]});let i=t;return i})();export{pi as ExpensesModule};
