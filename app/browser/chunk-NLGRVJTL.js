import{a as je,b as Ae}from"./chunk-VNQ7N5IC.js";import{a as Ze,b as $e,c as et,d as tt}from"./chunk-OQ73NTVM.js";import{a as Xe}from"./chunk-DKBJHHEA.js";import{a as N}from"./chunk-GLAC23CS.js";import{a as Ee}from"./chunk-OUZXLSMN.js";import"./chunk-5Y4A7MAH.js";import{a as it,b as nt}from"./chunk-IVGK5S3B.js";import{a as Ue,b as Ke}from"./chunk-R52AXQF7.js";import{a as Ye,b as Je}from"./chunk-NEXFYW5Q.js";import{a as Be,b as He}from"./chunk-565XE5Q6.js";import{a as se,b as Ge,d as Q,g as j,m as We,n as Qe,o as ce}from"./chunk-YXGZ3Y4J.js";import{a as W,b as qe}from"./chunk-KWHJ4U2D.js";import"./chunk-PTV2L6W6.js";import{b as ze}from"./chunk-I3ZYYSXS.js";import{i as Le,j as Oe}from"./chunk-6CJYKBUA.js";import{a as R,b as me}from"./chunk-KTNSRC6L.js";import"./chunk-VVJEHS3M.js";import{a as Ne,b as Me}from"./chunk-2WM322QF.js";import"./chunk-THDET7PA.js";import{$b as oe,A as S,Aa as X,Ab as de,B as w,Ba as Z,C as Y,Ca as ue,Da as l,Ea as v,Fa as $,Gb as ie,H as d,Ha as x,I as _,Ia as k,Ja as I,La as ve,M as he,Ma as C,Na as T,Oa as Se,Pb as V,Sb as Te,U as be,Ub as ne,V as m,Va as z,Wa as U,Wb as D,Yb as B,Zb as H,_b as Ve,bb as we,bc as q,cc as L,da as f,db as ee,dc as O,ec as De,fa as c,fb as te,fc as re,gc as Fe,hc as Re,i as ye,ia as E,ib as xe,jb as ke,ka as Ce,la as n,ma as i,na as g,qc as G,ra as b,rc as F,sa as u,sc as ae,ta as p,tb as Ie,tc as le,uc as Pe,x as K,za as J}from"./chunk-FYHOXPUP.js";var dt=()=>({width:"75vw"}),_t=()=>({"1199px":"85vw","575px":"95vw"}),gt=()=>[10,15,50,100],ft=()=>["product_name","barcode"];function yt(t,o){t&1&&(n(0,"tr")(1,"th"),l(2,"Transaction #"),i(),n(3,"th"),l(4,"Datetime"),i(),n(5,"th"),l(6,"Type"),i(),n(7,"th"),l(8,"Quantity"),i(),n(9,"th"),l(10,"Notes"),i()())}function ht(t,o){if(t&1&&(n(0,"tr",8)(1,"td"),l(2),i(),n(3,"td"),l(4),i(),n(5,"td"),g(6,"p-tag",9),i(),n(7,"td"),l(8),i(),n(9,"td"),l(10),i()()),t&2){let e=o.$implicit,s=p(2);c("pSelectableRow",e),m(2),v(e.transaction_id),m(2),v(e.transaction_datetime),m(2),c("value",e.transaction_type)("severity",s.getSeverity(e.transaction_type)),m(2),v(e.quantity),m(2),v(e.transaction_notes||"---")}}function bt(t,o){t&1&&(n(0,"tr")(1,"td",10),l(2,"No items yet!"),i()())}function Ct(t,o){if(t&1&&(n(0,"p-table",4,0),f(2,yt,11,0,"ng-template",5)(3,ht,11,7,"ng-template",6)(4,bt,3,0,"ng-template",7),i()),t&2){let e=p();c("value",e.stockHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",C(8,gt))("alwaysShowPaginator",!0)("globalFilterFields",C(9,ft))("filterDelay",0)}}function vt(t,o){if(t&1){let e=b();n(0,"p-button",11),u("onClick",function(){d(e);let r=p();return _(r.closeDialog())}),i()}}var pe=(()=>{let o=class o{constructor(){this.visible=!1,this.onClose=new he,this.stockService=S(N),this.stockHistory=this.stockService.stockHistory}closeDialog(){this.visible=!1,this.onClose.emit()}fetchProductHistory(){this.stockService.fetchStockHistory(this.product_id)}getSeverity(s){switch(s){case"SALE":return"danger";case"SUPPLY":return"success";case"RETURN":return"success";case"DELETE":return"success";case"DISPOSE":return"danger";case"ADD":return"success";case"REMOVE":return"danger";default:return"contrast"}}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["stock-transactions"]],inputs:{product_id:"product_id",visible:"visible"},outputs:{onClose:"onClose"},standalone:!0,features:[ve],decls:3,vars:10,consts:[["dt2",""],["position","top","header","Transaction History","styleClass","p-fluid",3,"visibleChange","onHide","onShow","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["styleClass","p-datatable-sm","dataKey","transaction_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"pSelectableRow"],[3,"value","severity"],["colspan","7"],["pRipple","","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"]],template:function(r,a){r&1&&(n(0,"p-dialog",1),I("visibleChange",function(h){return k(a.visible,h)||(a.visible=h),h}),u("onHide",function(){return a.closeDialog()})("onShow",function(){return a.fetchProductHistory()}),f(1,Ct,5,10,"ng-template",2)(2,vt,1,0,"ng-template",3),i()),r&2&&(E(C(8,dt)),c("modal",!0),x("visible",a.visible),c("breakpoints",C(9,_t))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[me,R,V,ae,F,ce,Q,j,Ke,Ue]});let t=o;return t})();var It=["tableSearch"],Tt=["barcodeInput"],Et=["itemName"],Vt=()=>[10,15,50,100],Dt=()=>["product_name","barcode"],A=t=>({"ng-invalid ng-dirty":t}),Ft=()=>({width:"65vw"});function Rt(t,o){if(t&1){let e=b();n(0,"span",39),g(1,"i",40),n(2,"input",41,3),u("input",function(r){d(e),p();let a=ue(8);return _(a.filterGlobal(r.target.value,"contains"))}),i()(),n(4,"p-button",42),u("click",function(){d(e);let r=p();return _(r.refreshTable())}),i(),n(5,"p-button",43),u("click",function(){d(e);let r=p();return _(r.openItemDialog("add"))}),i()}if(t&2){let e=p(),s=ue(8);m(2),c("value",s.filters.global==null?null:s.filters.global.value),m(2),c("loading",e.tableLoading())}}function Nt(t,o){if(t&1){let e=b();n(0,"p-button",44),u("onClick",function(){d(e);let r=p();return _(r.openStockDialog())}),i(),n(1,"p-button",45),u("onClick",function(){d(e);let r=p();return _(r.fetchHistory())}),i()}if(t&2){let e=p();c("disabled",!e.selectedItem||e.selectedItem.stock_management==0),m(),c("disabled",!e.selectedItem)("loading",e.historyLoading())}}function Mt(t,o){if(t&1){let e=b();n(0,"p-button",46),u("click",function(){d(e);let r=p();return _(r.openItemDialog("edit"))}),i(),n(1,"p-button",47),u("click",function(){d(e);let r=p();return _(r.deleteSelectedItem())}),i()}if(t&2){let e=p();c("disabled",!e.selectedItem),m(),c("disabled",!e.selectedItem)}}function Pt(t,o){t&1&&(n(0,"th",48),l(1," Cost "),i())}function Bt(t,o){if(t&1&&(n(0,"tr")(1,"th",48),l(2,"Barcode"),i(),n(3,"th",49),l(4,"Description"),i(),n(5,"th",50),l(6,"Category"),i(),n(7,"th",51),l(8,"Qty"),i(),f(9,Pt,2,0,"th",52),n(10,"th",48),l(11,"Price"),i(),n(12,"th",50),l(13,"Notes"),i()()),t&2){let e=p();m(9),c("ngIf",e.userPermissions().show_cost)}}function Ht(t,o){if(t&1&&(n(0,"td"),l(1),z(2,"currency"),i()),t&2){let e=p().$implicit;m(),$(" ",U(2,1,e.unit_cost_usd)," ")}}function qt(t,o){if(t&1&&(n(0,"tr",53)(1,"td"),l(2),i(),n(3,"td"),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),f(9,Ht,3,3,"td",54),n(10,"td"),l(11),z(12,"currency"),i(),n(13,"td"),l(14),i()()),t&2){let e=o.$implicit,s=p();c("pSelectableRow",e),m(2),v(e.barcode||"---"),m(2),v(e.product_name),m(2),v(e.category_name||"---"),m(2),$(" ",e.stock_management?e.quantity:"--"," "),m(),c("ngIf",s.userPermissions().show_cost),m(2),v(U(12,8,e.unit_price_usd)),m(3),v(e.item_notes||"---")}}function Lt(t,o){t&1&&(n(0,"tr")(1,"td",55),l(2,"No items yet!"),i()())}function Ot(t,o){if(t&1&&(n(0,"h3"),l(1),i()),t&2){let e=p();m(),$("",e.dialogMode," Items")}}function Gt(t,o){t&1&&(n(0,"small",56),l(1,"Barcode already exists!"),i())}function Wt(t,o){t&1&&(n(0,"small",56),l(1,"Name is required."),i())}function Qt(t,o){t&1&&(n(0,"div",24)(1,"label",57),l(2,"Initial Qty"),i(),g(3,"p-inputNumber",59),i())}function jt(t,o){if(t&1&&(f(0,Qt,4,0,"div",30),n(1,"div",24)(2,"label",57),l(3,"Low Stock Threshold"),i(),g(4,"p-inputNumber",58),i()),t&2){let e=p();c("ngIf",e.dialogMode=="add")}}function At(t,o){t&1&&(n(0,"small",56),l(1,"Cost is required."),i())}function zt(t,o){if(t&1&&(n(0,"div",24)(1,"label",60),l(2,"Unit Cost"),n(3,"span",22),l(4,"*"),i()(),g(5,"p-inputNumber",61),f(6,At,2,0,"small",20),i()),t&2){let e=p();m(5),c("ngClass",T(2,A,e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))),m(),c("ngIf",e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))}}function Ut(t,o){t&1&&(n(0,"small",56),l(1,"Price is required."),i())}function Kt(t,o){if(t&1){let e=b();n(0,"button",62),u("click",function(){d(e);let r=p();return _(r.submitItem())}),i(),n(1,"button",63),u("click",function(){d(e);let r=p();return _(r.closeItemDialog())}),i()}if(t&2){let e=p();c("loading",e.submitItemLoading())}}function Yt(t,o){t&1&&(n(0,"small",56),l(1,"Option is required."),i())}function Jt(t,o){t&1&&(n(0,"small",56),l(1,"Quantity is required."),i())}function Xt(t,o){if(t&1){let e=b();n(0,"form",14),u("ngSubmit",function(){d(e);let r=p();return _(r.submitStock())}),n(1,"div",15)(2,"div",64)(3,"label"),l(4,"Option"),n(5,"span",22),l(6,"*"),i()(),g(7,"p-dropdown",65),f(8,Yt,2,0,"small",20),i(),n(9,"div",64)(10,"label"),l(11,"Quantity"),n(12,"span",22),l(13,"*"),i()(),g(14,"p-inputNumber",66),f(15,Jt,2,0,"small",20),i(),n(16,"div",67)(17,"label"),l(18,"Notes"),i(),g(19,"input",68),i()()()}if(t&2){let e=p();c("formGroup",e.stockForm),m(7),c("autoOptionFocus",!1)("options",e.transactionOptions)("ngClass",T(7,A,(e.transaction_type==null?null:e.transaction_type.invalid)&&((e.transaction_type==null?null:e.transaction_type.dirty)||(e.transaction_type==null?null:e.transaction_type.touched)||e.submitted))),m(),c("ngIf",(e.transaction_type==null?null:e.transaction_type.invalid)&&((e.transaction_type==null?null:e.transaction_type.dirty)||(e.transaction_type==null?null:e.transaction_type.touched)||e.submitted)),m(6),c("ngClass",T(9,A,(e.quantity==null?null:e.quantity.invalid)&&((e.quantity==null?null:e.quantity.dirty)||(e.quantity==null?null:e.quantity.touched)||e.submitted))),m(),c("ngIf",(e.quantity==null?null:e.quantity.invalid)&&((e.quantity==null?null:e.quantity.dirty)||(e.quantity==null?null:e.quantity.touched)||e.submitted))}}function Zt(t,o){if(t&1){let e=b();n(0,"button",69),u("click",function(){d(e);let r=p();return _(r.toggleStockDialog())}),i(),n(1,"button",70),u("click",function(){d(e);let r=p();return _(r.submitStock())}),i()}}var lt=(()=>{let o=class o{constructor(){this.subscriptions=new ye,this.barcodeError=!1,this.stockService=S(N),this.fb=S(re),this.confirmationService=S(ie),this.authService=S(Ee),this.products=this.stockService.products,this.itemSidebarVisible=this.stockService.itemSidebarVisible,this.tableLoading=this.stockService.tableLoading,this.submitItemLoading=this.stockService.submitItemLoading,this.categories=this.stockService.categories,this.submitted=!1,this.userPermissions=this.authService.userPermissions,this.itemForm=this.fb.group({product_id:[null],category_id_fk:[{value:null,disabled:!1}],product_name:[null,D.required],barcode:[null],unit_cost_usd:[null,D.required],unit_price_usd:[null,D.required],quantity:[null],product_notes:[null],low_stock_threshold:[null],stock_management:[!0]}),this.stockDialogVisible=this.stockService.stockDialogVisible,this.transactionOptions=[{name:"Add",value:"ADD"},{name:"Remove",value:"REMOVE"}],this.stockForm=this.fb.group({product_id_fk:[null],transaction_type:[{value:null,disabled:!1},D.required],quantity:[null,D.required],transaction_notes:[null]}),this.historyDialogVisible=this.stockService.historyDialogVisible,this.historyLoading=this.stockService.historyLoading}onKeyDown(s){!this.itemSidebarVisible()&&!this.stockDialogVisible()&&this.tableSearch.nativeElement.focus()}ngOnInit(){this.subscriptions.add(this.stockService.barcodeError.subscribe(()=>{this.barcodeInput.nativeElement.select(),this.barcodeError=!0})),this.subscriptions.add(this.stockService.itemCreated.subscribe(()=>{this.resetDialog()}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get category_id_fk(){return this.itemForm.get("category_id_fk")}get product_name(){return this.itemForm.get("product_name")}get unit_cost_usd(){return this.itemForm.get("unit_cost_usd")}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get stock_management(){return this.itemForm.get("stock_management")}focusInput(){this.barcodeInput.nativeElement.focus()}clearBarcode(){this.itemForm.patchValue({barcode:null})}openItemDialog(s){this.dialogMode=s,this.dialogMode=="add"?this.stockService.itemSidebarVisible.set(!0):this.dialogMode=="edit"&&(this.selectedItem.stock_management=this.selectedItem.stock_management==1,this.itemForm.patchValue(this.selectedItem),this.stockService.itemSidebarVisible.set(!0))}closeItemDialog(){this.stockService.itemSidebarVisible.set(!1)}resetDialog(){this.submitted=!1,this.itemForm.reset({stock_management:!0})}submitItem(){this.submitted=!0,this.dialogMode=="add"?this.itemForm.valid&&(this.stockService.createItem(this.itemForm.value),this.submitted=!1,this.focusInput()):this.itemForm.valid&&(this.stockService.updateItem(this.itemForm.value),this.selectedItem=null)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to delete selected item?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedItem),this.selectedItem=null}})}refreshTable(){this.stockService.getItems()}clearBarcodeError(){this.barcodeError=!1}get transaction_type(){return this.stockForm.get("transaction_type")}get quantity(){return this.stockForm.get("quantity")}openStockDialog(){this.stockService.stockDialogVisible.set(!0)}toggleStockDialog(){this.stockService.stockDialogVisible.set(!1)}submitStock(){this.submitted=!0,this.stockForm.valid&&(this.stockForm.patchValue({product_id_fk:this.selectedItem?.product_id}),this.stockService.submitStock(this.stockForm.value))}resetStockDialog(){this.submitted=!1,this.stockForm.reset(),this.stockService.stockDialogVisible.set(!1)}fetchHistory(){this.stockService.fetchStockHistory(this.selectedItem.product_id)}closeHistoryDialog(){this.stockService.historyDialogVisible.set(!1)}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["app-inventory"]],viewQuery:function(r,a){if(r&1&&(J(It,5),J(Tt,5),J(Et,5)),r&2){let y;X(y=Z())&&(a.tableSearch=y.first),X(y=Z())&&(a.barcodeInput=y.first),X(y=Z())&&(a.itemName=y.first)}},hostBindings:function(r,a){r&1&&u("keydown",function(h){return a.onKeyDown(h)},!1,be)},decls:64,vars:41,consts:[["dt2",""],["barcodeInput",""],["itemName",""],["tableSearch",""],[1,"grid","m-1"],[1,"col-12"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","65vh",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","right","styleClass","w-30rem",3,"visibleChange","onShow","onHide","visible"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12"],["for","barcode"],[1,"pi","pi-barcode"],["placeholder","Barcode ...","pInputText","","spellcheck","false","formControlName","barcode",1,"w-full","p-inputtext-sm",3,"input","ngClass"],["class","p-error",4,"ngIf"],["for","name"],[1,"text-red-600"],["placeholder","Product Name","id","name","pInputText","","formControlName","product_name","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngClass"],[1,"field","col-6"],["for","Category"],["styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","formControlName","category_id_fk","optionLabel","category_name","optionValue","category_id","placeholder","Select Category ...","filterBy","category_name",3,"autoOptionFocus","showClear","options","filter"],[1,"flex","align-items-center","gap-1"],["formControlName","stock_management","inputId","stock_management",3,"binary"],["for","stock_management"],["class","field col-6",4,"ngIf"],["for","unit_price_usd"],["styleClass","w-full","formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["for","product_notes"],["type","text","pInputText","","formControlName","product_notes","spellcheck","false",1,"w-full"],["pTemplate","footer"],["header","Stock Correction","styleClass","p-fluid","position","top",3,"onHide","visible","modal"],["pTemplate","content"],[3,"onClose","visible","product_id"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mx-2 ",3,"click","loading"],["label","New","icon","pi pi-plus","severity","success","size","small",3,"click"],["label","Correct Stock","size","small","severity","info","icon","pi pi-wrench",3,"onClick","disabled"],["label","History","size","small","severity","contrast","icon","pi pi-history","styleClass","ml-2",3,"onClick","disabled","loading"],["pp-button","","pRipple","","label","Edit","icon","pi pi-file-edit","size","small","severity","warning",3,"click","disabled"],["pp-button","","pRipple","","label","Delete","icon","pi pi-trash","size","small","severity","danger",1,"ml-2",3,"click","disabled"],["width","10%"],["width","35%"],["width","15%"],["width","5%"],["width","10%",4,"ngIf"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","7"],[1,"p-error"],["for","qty"],["styleClass","w-full","formControlName","low_stock_threshold","placeholder","low stock qty",1,"p-inputtext-sm","w-full"],["styleClass","w-full","formControlName","quantity","placeholder","Initial Qty",1,"p-inputtext-sm","w-full"],["for","unit_cost_usd"],["styleClass","w-full","formControlName","unit_cost_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["type","submit","pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success","w-full","mb-3",3,"click","loading"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary","w-full",3,"click"],[1,"field","col-12","md:col-3"],["scrollHeight","400px","appendTo","body","formControlName","transaction_type","optionLabel","name","optionValue","value","placeholder","transaction type ...",3,"autoOptionFocus","options","ngClass"],["formControlName","quantity",3,"ngClass"],[1,"field","col-12","md:col-6"],["type","text","spellcheck","false","pInputText","","formControlName","transaction_notes",1,"w-full"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click"]],template:function(r,a){if(r&1){let y=b();n(0,"div",4)(1,"div",5)(2,"p-card")(3,"p-toolbar"),f(4,Rt,6,2,"ng-template",6)(5,Nt,2,3,"ng-template",7)(6,Mt,2,2,"ng-template",8),i(),n(7,"p-table",9,0),I("selectionChange",function(M){return d(y),k(a.selectedItem,M)||(a.selectedItem=M),_(M)}),f(9,Bt,14,1,"ng-template",10)(10,qt,15,10,"ng-template",11)(11,Lt,3,0,"ng-template",12),i()()()(),n(12,"p-sidebar",13),I("visibleChange",function(M){return d(y),k(a.itemSidebarVisible,M)||(a.itemSidebarVisible=M),_(M)}),u("onShow",function(){return d(y),_(a.focusInput())})("onHide",function(){return d(y),_(a.resetDialog())}),f(13,Ot,2,1,"ng-template",10),n(14,"form",14),u("ngSubmit",function(){return d(y),_(a.submitItem())}),n(15,"div",15)(16,"div",16)(17,"label",17),l(18,"Barcode"),i(),n(19,"p-inputGroup")(20,"p-inputGroupAddon"),g(21,"i",18),i(),n(22,"input",19,1),u("input",function(){return d(y),_(a.clearBarcodeError())}),i()(),f(24,Gt,2,0,"small",20),i(),n(25,"div",16)(26,"label",21),l(27,"Product Name"),n(28,"span",22),l(29,"*"),i()(),g(30,"input",23,2),f(32,Wt,2,0,"small",20),i(),n(33,"div",24)(34,"label",25),l(35,"Category"),i(),g(36,"p-dropdown",26),i(),n(37,"div",24)(38,"label"),l(39,"Stock Management"),i(),g(40,"br"),n(41,"div",27),g(42,"p-checkbox",28),n(43,"label",29),l(44,"Enable"),i()()(),f(45,jt,5,1),i(),n(46,"div",15),f(47,zt,7,4,"div",30),n(48,"div",24)(49,"label",31),l(50,"Unit price"),n(51,"span",22),l(52,"*"),i()(),g(53,"p-inputNumber",32),f(54,Ut,2,0,"small",20),i(),n(55,"div",16)(56,"label",33),l(57,"Notes"),i(),g(58,"input",34),i()()(),f(59,Kt,2,1,"ng-template",35),i(),n(60,"p-dialog",36),u("onHide",function(){return d(y),_(a.resetStockDialog())}),f(61,Xt,20,11,"ng-template",37)(62,Zt,2,0,"ng-template",35),i(),n(63,"stock-transactions",38),u("onClose",function(){return d(y),_(a.closeHistoryDialog())}),i()}r&2&&(m(7),c("value",a.products()),x("selection",a.selectedItem),c("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",C(32,Vt))("alwaysShowPaginator",!0)("globalFilterFields",C(33,Dt))("filterDelay",0)("loading",a.tableLoading())("scrollable",!0),m(5),x("visible",a.itemSidebarVisible),m(2),c("formGroup",a.itemForm),m(8),c("ngClass",T(34,A,a.barcodeError)),m(2),c("ngIf",a.barcodeError),m(6),c("ngClass",T(36,A,a.product_name.invalid&&(a.product_name.dirty||a.product_name.touched||a.submitted))),m(2),c("ngIf",a.product_name.invalid&&(a.product_name.dirty||a.product_name.touched||a.submitted)),m(4),c("autoOptionFocus",!1)("showClear",!0)("options",a.categories())("filter",!0),m(6),c("binary",!0),m(3),Ce(a.stock_management.value?45:-1),m(2),c("ngIf",a.userPermissions().show_cost),m(6),c("ngClass",T(38,A,a.unit_price_usd.invalid&&(a.unit_price_usd.dirty||a.unit_price_usd.touched||a.submitted))),m(),c("ngIf",a.unit_price_usd.invalid&&(a.unit_price_usd.dirty||a.unit_price_usd.touched||a.submitted)),m(6),E(C(40,Ft)),c("visible",a.stockDialogVisible())("modal",!0),m(3),c("visible",a.historyDialogVisible())("product_id",a.selectedItem==null?null:a.selectedItem.product_id))},dependencies:[ee,te,q,ne,B,H,L,O,Q,V,j,W,G,F,R,Le,le,se,Ne,je,Ze,et,pe,Ye,xe],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}[_nghost-%COMP%]  .p-toolbar{padding-top:.6rem!important;padding-bottom:.6rem!important}"]});let t=o;return t})();var st=(()=>{let o=class o{};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["app-stock-home"]],decls:1,vars:0,template:function(r,a){r&1&&g(0,"router-outlet")},dependencies:[Ie]});let t=o;return t})();var $t=()=>[10,15,50,100],ei=()=>({width:"35vw"}),ti=()=>({"1199px":"75vw","575px":"85vw"}),ii=(t,o)=>({" pi-check-circle text-green-600":t,"pi-times-circle text-red-600":o}),ni=t=>({"ng-invalid ng-dirty":t});function oi(t,o){if(t&1){let e=b();n(0,"p-button",11),u("click",function(){d(e);let r=p();return _(r.refreshCategories())}),i(),n(1,"p-button",12),u("click",function(){d(e);let r=p();return _(r.openCategoryDialog("add"))}),i()}if(t&2){let e=p();c("loading",e.categoriesLoading())}}function ri(t,o){if(t&1){let e=b();n(0,"button",13),u("click",function(){d(e);let r=p();return _(r.openCategoryDialog("edit"))}),i(),n(1,"button",14),u("click",function(){d(e);let r=p();return _(r.deleteSelectedCategory())}),i()}if(t&2){let e=p();c("disabled",!e.selectedCategory()),m(),c("disabled",!e.selectedCategory())}}function ai(t,o){t&1&&(n(0,"tr")(1,"th",15),l(2,"Sort"),i(),n(3,"th",16),l(4,"Name"),i(),n(5,"th",17),l(6,"Visible?"),i()())}function li(t,o){if(t&1&&(n(0,"tr",18)(1,"td"),g(2,"span",19),i(),n(3,"td"),l(4),i(),n(5,"td"),g(6,"i",20),i()()),t&2){let e=o.$implicit,s=o.rowIndex;c("pReorderableRow",s)("pSelectableRow",e),m(4),v(e.category_name),m(2),c("ngClass",Se(4,ii,e.show_on_sell,!e.show_on_sell))}}function si(t,o){t&1&&(n(0,"tr")(1,"td",21),l(2,"No Categories yet!"),i()())}function ci(t,o){t&1&&(n(0,"small",30),l(1,"Name is required."),i())}function mi(t,o){if(t&1){let e=b();n(0,"form",22),u("ngSubmit",function(){d(e);let r=p();return _(r.submitCategory())}),n(1,"div",23)(2,"label",24),l(3,"Category Name"),i(),g(4,"input",25),f(5,ci,2,0,"small",26),i(),n(6,"div",27),g(7,"p-inputSwitch",28),n(8,"label",29),l(9,"Show on sell page?"),i()()()}if(t&2){let e=p();c("formGroup",e.categoryForm),m(4),c("ngClass",T(3,ni,(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))),m(),c("ngIf",(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))}}function pi(t,o){if(t&1){let e=b();n(0,"button",31),u("click",function(){d(e);let r=p();return _(r.categoryDialogVisible.set(!1))}),i(),n(1,"button",32),u("click",function(){d(e);let r=p();return _(r.submitCategory())}),i()}}var ct=(()=>{let o=class o{constructor(){this.stockService=S(N),this.confirmationService=S(ie),this.notificationService=S(Te),this.categoryDialogVisible=this.stockService.categoryDialogVisible,this.categories=this.stockService.categories,this.categoriesLoading=this.stockService.categoriesLoading,this.selectedCategory=this.stockService.selectedCategory,this.categoryForm=new Ve({category_id:new oe,category_name:new oe(null,D.required),show_on_sell:new oe(!1)})}sortCategories(){this.stockService.sortCategories()}selectCategory(){}refreshCategories(){this.stockService.getCategories()}get category_name(){return this.categoryForm.get("category_name")}openCategoryDialog(s){this.dialogMode=s,this.dialogMode=="add"?this.stockService.categoryDialogVisible.set(!0):(this.categoryForm.patchValue({category_id:this.selectedCategory()?.category_id,category_name:this.selectedCategory()?.category_name,show_on_sell:this.selectedCategory()?.show_on_sell==1}),this.stockService.categoryDialogVisible.set(!0))}submitCategory(){this.dialogMode=="add"?this.categoryForm.valid&&(this.stockService.createCategory(this.categoryForm.value),this.stockService.categoryDialogVisible.set(!1)):this.dialogMode=="edit"&&this.categoryForm.valid&&(this.stockService.updateCategory(this.categoryForm.value),this.stockService.selectedCategory.set(null))}deleteSelectedCategory(){this.stockService.filteredItems().length!=0?this.notificationService.showError("Delete all category items before proceeding!","categories"):this.confirmationService.confirm({key:"home",message:`Are you sure that you want to delete "${this.selectedCategory()?.category_name}"?`,header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteCategory(this.selectedCategory().category_id)}})}resetDialog(){this.categoryForm.reset({category_name:null,show_on_sell:!1})}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["categories"]],decls:11,vars:17,consts:[["header","Categories"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["selectionMode","single","dataKey","category_id","styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","55vh",3,"selectionChange","onRowReorder","value","selection","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Category","styleClass","p-fluid",3,"onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mr-2 ",3,"click","loading"],["label","New Category","icon","pi pi-plus","severity","success","size","small",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],["width","10%"],["width","75%"],["width","15%"],[3,"pReorderableRow","pSelectableRow"],["pReorderableRowHandle","",1,"pi","pi-bars"],[1,"pi",3,"ngClass"],["colspan","3"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["type","text","pInputText","","formControlName","category_name","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],[1,"flex","align-items-center","justify-content-center","gap-2"],["id","showOnSell","formControlName","show_on_sell"],["for","showOnSell"],[1,"p-error"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click"]],template:function(r,a){r&1&&(n(0,"p-panel",0)(1,"p-toolbar",1),f(2,oi,2,1,"ng-template",2)(3,ri,2,2,"ng-template",3),i(),n(4,"p-table",4),I("selectionChange",function(h){return k(a.selectedCategory,h)||(a.selectedCategory=h),h}),u("onRowReorder",function(){return a.sortCategories()}),f(5,ai,7,0,"ng-template",5)(6,li,7,7,"ng-template",6)(7,si,3,0,"ng-template",7),i()(),n(8,"p-dialog",8),u("onHide",function(){return a.resetDialog()}),f(9,mi,10,5,"ng-template",9)(10,pi,2,0,"ng-template",10),i()),r&2&&(m(4),c("value",a.categories()),x("selection",a.selectedCategory),c("loading",a.categoriesLoading())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",C(14,$t))("alwaysShowPaginator",!0)("scrollable",!0),m(4),E(C(15,ei)),c("visible",a.categoryDialogVisible())("modal",!0)("breakpoints",C(16,ti)))},dependencies:[ee,te,q,ne,B,H,De,L,O,Q,V,j,We,Qe,W,G,F,R,le,Be,it]});let t=o;return t})();var di=()=>({width:"35vw"}),_i=()=>({"1199px":"85vw","575px":"95vw"});function gi(t,o){if(t&1){let e=b();n(0,"form",7),u("ngSubmit",function(){d(e);let r=p();return _(r.submit())}),n(1,"div",8)(2,"label",9),l(3,"Exchange Rate"),i(),g(4,"p-inputNumber",10),i()()}if(t&2){let e=p();c("formGroup",e.rateForm),m(4),c("min",1e3)}}function fi(t,o){if(t&1){let e=b();n(0,"button",11),u("click",function(){d(e);let r=p();return _(r.toggleDialog(!1))}),i(),n(1,"button",12),u("click",function(){d(e);let r=p();return _(r.submit())}),i()}}var mt=(()=>{let o=class o{constructor(){this.stockService=S(N),this.formBuilder=S(re),this.exchangeRate=this.stockService.exchangeRate,this.rateDialogVisible=this.stockService.rateDialogVisible,this.dialogVisible=!1,we(()=>{this.rateForm=this.formBuilder.group({rate_value:[this.exchangeRate().rate_value]})})}toggleDialog(s){this.stockService.rateDialogVisible.set(s)}submit(){this.rateForm.valid&&this.stockService.updateExchangeRate(this.rateForm.value)}resetDialog(){this.rateForm.reset({rate_value:this.exchangeRate().rate_value}),this.stockService.rateDialogVisible.set(!1)}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["exchange-rate"]],decls:12,vars:10,consts:[[1,"p-toolbar-group-start"],[1,"text-green-600"],[1,"p-toolbar-group-end"],["icon","pi pi-file-edit","styleClass","p-button-warning","label","Edit",3,"onClick"],["header","Exchange Rate","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["inputId","integeronly","formControlName","rate_value",3,"min"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click"]],template:function(r,a){r&1&&(n(0,"p-toolbar")(1,"div",0)(2,"h3"),l(3," Dollar Exchange: "),n(4,"i",1),l(5),z(6,"lira"),i()()(),n(7,"div",2)(8,"p-button",3),u("onClick",function(){return a.toggleDialog(!0)}),i()()(),n(9,"p-dialog",4),I("visibleChange",function(h){return k(a.rateDialogVisible,h)||(a.rateDialogVisible=h),h}),u("onHide",function(){return a.resetDialog()}),f(10,gi,5,2,"ng-template",5)(11,fi,2,0,"ng-template",6),i()),r&2&&(m(5),v(U(6,6,a.exchangeRate().rate_value)),m(4),E(C(8,di)),x("visible",a.rateDialogVisible),c("modal",!0)("breakpoints",C(9,_i)))},dependencies:[q,B,H,L,O,V,W,G,F,R,se,Xe]});let t=o;return t})();var pt=(()=>{let o=class o{};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=w({type:o,selectors:[["stock-settings"]],decls:6,vars:0,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"]],template:function(r,a){r&1&&(n(0,"div",0)(1,"div",1),g(2,"exchange-rate")(3,"br")(4,"categories"),i(),g(5,"div",1),i())},dependencies:[ct,mt]});let t=o;return t})();var hi=[{path:"",component:st,children:[{path:"items",data:{breadcrumb:"Inventory"},component:lt},{path:"settings",data:{breadcrumb:"Settings"},component:pt},{path:"**",redirectTo:"/stock/items"}]}],ut=(()=>{let o=class o{};o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=Y({type:o}),o.\u0275inj=K({imports:[de.forChild(hi),de]});let t=o;return t})();var Un=(()=>{let o=class o{};o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=Y({type:o}),o.\u0275inj=K({imports:[ke,Fe,Re,ut,ce,qe,ae,me,Oe,Pe,Ge,Me,ze,Ae,He,nt,$e,tt,pe,Je]});let t=o;return t})();export{Un as StockModule};
