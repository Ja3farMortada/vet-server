import{A as m,Bb as g,Sb as b,aa as r,l as a,lb as u,ub as d,w as l,z as n}from"./chunk-FYHOXPUP.js";var S=(()=>{let o=class o{constructor(t,e,s){this.http=t,this.router=e,this.notificationService=s,this.customers=r([]),this.customersTotalDebts$=new a({account_id:0,balance:"0"}),this.newOrder$=new a(null),this.customerDialogVisible$=new a(!1),this.customerBalance$=new a([]),this.signal_submitItemLoading=r(!1),this.signal_tableLoading=r(!1),this.signal_balanceLoading=r(!1),this.api=m(g),this.host=this.api.host,this.debts=r([]),this.debtsLoading=r(!1),this.getCustomers()}getDebts(){this.debtsLoading.set(!0),this.http.get(`${this.api.host}/customers/debts`).subscribe({next:t=>{this.debts.set(t),this.debtsLoading.set(!1)},error:t=>{this.notificationService.handleError(t.error,"home"),this.debtsLoading.set(!1)}})}getCustomers(){this.signal_tableLoading.set(!0),this.http.get(`${this.host}/customers`).subscribe({next:t=>{this.customers.set(t)},error:t=>{this.notificationService.handleError(t.error,"home"),this.signal_tableLoading.set(!1)},complete:()=>{this.signal_tableLoading.set(!1)}})}createCustomer(t){this.signal_submitItemLoading.set(!0),this.http.post(`${this.host}/customers`,t).subscribe({next:e=>{this.notificationService.showSuccess("Customer added successfully!","home"),this.customers.set([...this.customers(),e.customer])},error:e=>{this.notificationService.showError(e.error.message,"home"),this.signal_submitItemLoading.set(!1)},complete:()=>{this.customerDialogVisible$.next(!1),this.signal_submitItemLoading.set(!1)}})}updateCustomer(t){this.signal_submitItemLoading.set(!0),this.http.put(`${this.host}/customers/${t.account_id}`,t).subscribe({next:e=>{this.notificationService.showSuccess("Data updated successfully!","home");let s=this.customers().findIndex(h=>h.account_id==e.customer.account_id),i=this.customers();i[s]=e.customer,this.customers.set(i)},error:e=>{this.notificationService.showError(e,"home"),this.signal_submitItemLoading.set(!1)},complete:()=>{this.customerDialogVisible$.next(!1),this.signal_submitItemLoading.set(!1)}})}deleteCustomer(t){this.http.delete(`${this.host}/customers/${t.account_id}`).subscribe({next:e=>{this.notificationService.showSuccess(e.message,"home");let s=this.customers(),i=s.findIndex(h=>h.account_id==t.account_id);s.splice(i,1),this.customers.set(s)},error:e=>{this.notificationService.handleError(e.error,"home")}})}getCustomerBalance(t,e,s){this.signal_submitItemLoading.set(!0),this.http.get(`${this.host}/customers/transactions/${t}&${e}&${s}`).subscribe({next:i=>{this.customerBalance$.next(i)},error:i=>{this.notificationService.handleError(i.error,"home"),this.signal_submitItemLoading.set(!1)},complete:()=>{this.signal_submitItemLoading.set(!1)}})}getCustomerTotalBalance(t){this.signal_balanceLoading.set(!0),this.http.get(`${this.host}/customers/${t}/balance`).subscribe({next:e=>{this.customersTotalDebts$.next(e)},error:e=>{this.notificationService.handleError(e.error,"home"),this.signal_balanceLoading.set(!1)},complete:()=>{this.signal_balanceLoading.set(!1)}})}startNewOrder(t){this.newOrder$.next(t.account_id),this.router.navigate(["/sell"])}clearNewOrdr(){this.newOrder$.value&&this.newOrder$.next(null)}};o.\u0275fac=function(e){return new(e||o)(n(u),n(d),n(b))},o.\u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"});let c=o;return c})();export{S as a};
