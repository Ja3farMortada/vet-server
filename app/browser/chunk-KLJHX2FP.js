import{b as oe,c as ae}from"./chunk-IKQIMEKB.js";import{a as ue,b as pe}from"./chunk-HDKTY6DC.js";import{j as se,m as le,n as re}from"./chunk-AJCYT4AU.js";import{$a as N,Aa as l,Ab as Y,Cb as q,Fa as C,Ga as _,Ha as p,J as T,Jc as Z,Kc as $,Lc as ee,M as b,Mc as te,N as j,Na as O,O as P,Oa as F,Pa as A,Ra as m,Tb as z,U as V,V as c,Va as g,W as d,Wa as f,Xa as y,Yb as R,Za as W,_ as w,_a as E,bd as ie,cd as ne,fc as L,g as de,ha as u,i as M,ia as S,ic as Q,kc as U,l as I,oa as D,oc as G,ra as h,sc as J,ta as r,ub as B,wa as k,wb as H,wc as K,yc as X,za as a}from"./chunk-JZLEGW3Q.js";var ce=de(ue());var me=(()=>{let s=class s{constructor(t,e,o){this.http=t,this.api=e,this.notificationService=o,this.host=this.api.host,this.expensesAccounts=D([]),this.loading_table=D(!1),this.status_action$=new I({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(this.host+"/expense/accounts").subscribe({next:t=>{this.expensesAccounts.set(t)},error:t=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(t){this.loading_table.set(!0),this.http.post(this.host+"/expense",t).subscribe({next:e=>{this.notificationService.showSuccess("Payment added successfully","home"),this.status_action$.next({action:"ADD"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(t){this.loading_table.set(!0),this.http.put(this.host+"/expense",t).subscribe({next:e=>{this.notificationService.showSuccess("Payment updated successfully","home"),this.status_action$.next({action:"UPDATE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(t){this.loading_table.set(!0),this.http.delete(this.host+"/expense/"+t).subscribe({next:e=>{this.notificationService.showSuccess("Payment deleted successfully","home"),this.status_action$.next({action:"DELETE"})},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}};s.\u0275fac=function(e){return new(e||s)(b(q),b(z),b(Q))},s.\u0275prov=T({token:s,factory:s.\u0275fac,providedIn:"root"});let n=s;return n})();var ge=["amountInput"],fe=()=>({width:"75vw"}),ye=()=>({"1199px":"85vw","575px":"95vw"}),xe=n=>({"ng-invalid ng-dirty":n});function be(n,s){n&1&&(a(0,"small",15),m(1,"Date is required."),l())}function Ce(n,s){n&1&&(a(0,"small",15),m(1,"Ammount is required."),l())}function ve(n,s){if(n&1){let i=C();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"label",7),m(4,"Description"),a(5,"span",8),m(6," *"),l()(),a(7,"input",9),y("ngModelChange",function(e){c(i);let o=p();return f(o.journal_description,e)||(o.journal_description=e),d(e)}),l()()(),a(8,"div",5)(9,"label",10),m(10,"Payment Date"),a(11,"span",8),m(12," *"),l()(),a(13,"p-calendar",11),y("ngModelChange",function(e){c(i);let o=p();return f(o.payment_date,e)||(o.payment_date=e),d(e)}),l(),h(14,be,2,0,"small",12),l(),a(15,"div",5)(16,"div",6)(17,"label",13),m(18,"Amount"),a(19,"span",8),m(20," *"),l()(),a(21,"p-inputNumber",14,0),y("ngModelChange",function(e){c(i);let o=p();return f(o.amount,e)||(o.amount=e),d(e)}),_("onFocus",function(e){c(i);let o=p();return d(o.selectInput(e))}),l(),h(23,Ce,2,0,"small",12),l()()()}if(n&2){let i=p();u(7),g("ngModel",i.journal_description),u(6),g("ngModel",i.payment_date),r("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),u(),r("ngIf",i.submitted&&!i.payment_date),u(7),g("ngModel",i.amount),r("required",!0)("ngClass",N(11,xe,i.submitted&&!i.amount)),u(2),r("ngIf",i.submitted&&!i.amount)}}function we(n,s){if(n&1){let i=C();a(0,"p-button",19),_("onClick",function(){c(i);let e=p(2);return d(e.deletePayment())}),l()}if(n&2){let i=p(2);r("disabled",i.loading())}}function Se(n,s){if(n&1){let i=C();h(0,we,1,1,"p-button",16),a(1,"p-button",17),_("onClick",function(){c(i);let e=p();return d(e.closeDialog())}),l(),a(2,"p-button",18),_("onClick",function(){c(i);let e=p();return d(e.submitPayment())}),l()}if(n&2){let i=p();r("ngIf",i.dialog_mode==="edit"),u(),r("disabled",i.loading()),u(),r("loading",i.loading())}}var et=(()=>{let s=class s{constructor(t,e){this.expensesService=t,this.confirmationService=e,this.visible=!1,this.dialog_mode="add",this.OnClose=new w,this.OnSubmit=new w,this.dateService=j(pe),this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.submitted=!1,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null,this.subscriptions=new M}initDialog(){this.submitted=!1,this.amount=null,this.journal_description=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(t=>{t.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"YYYY-MM-DD HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}deletePayment(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.expensesService.deletePayment(this.selected_payment.journal_id)}})}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=(0,ce.default)(this.payment_date).format("YYYY-MM-DD HH:mm:ss"),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id}))}selectInput(t){t.target.select()}};s.\u0275fac=function(e){return new(e||s)(S(me),S(R))},s.\u0275cmp=P({type:s,selectors:[["expenses-dialog"]],viewQuery:function(e,o){if(e&1&&O(ge,5),e&2){let x;F(x=A())&&(o.amountInput=x.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[V,W],decls:3,vars:10,consts:[["amountInput",""],["position","top","header","Submit Expense","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],[1,"flex","flex-column","gap-2"],["for","Type"],[1,"text-red-500"],["type","text","pInputText","",3,"ngModelChange","ngModel"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["class","p-error",4,"ngIf"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","ngClass"],[1,"p-error"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["pRipple","","size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","disabled"],["pRipple","","size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","disabled"]],template:function(e,o){e&1&&(a(0,"p-dialog",1),y("visibleChange",function(v){return f(o.visible,v)||(o.visible=v),v}),_("onHide",function(){return o.closeDialog()}),h(1,ve,24,13,"ng-template",2)(2,Se,3,3,"ng-template",3),l()),e&2&&(k(E(8,fe)),r("modal",!0),g("visible",o.visible),r("breakpoints",E(9,ye))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[ne,ie,L,$,Z,se,re,le,ae,oe,X,U,G,K,J,Y,B,H,te,ee]});let n=s;return n})();export{et as a};
